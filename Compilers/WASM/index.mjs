var Ke=Object.create;var me=Object.defineProperty;var ze=Object.getOwnPropertyDescriptor;var Ve=Object.getOwnPropertyNames;var We=Object.getPrototypeOf,Ze=Object.prototype.hasOwnProperty;var Ee=(u,p)=>()=>(p||u((p={exports:{}}).exports,p),p.exports);var Qe=(u,p,_,b)=>{if(p&&typeof p=="object"||typeof p=="function")for(let E of Ve(p))!Ze.call(u,E)&&E!==_&&me(u,E,{get:()=>p[E],enumerable:!(b=ze(p,E))||b.enumerable});return u};var Je=(u,p,_)=>(_=u!=null?Ke(We(u)):{},Qe(p||!u||!u.__esModule?me(_,"default",{value:u,enumerable:!0}):_,u));var be=Ee((ve,de)=>{(function(u){var p=Object.hasOwnProperty,_=Array.isArray?Array.isArray:function(t){return Object.prototype.toString.call(t)==="[object Array]"},b=10,E=typeof process=="object"&&typeof process.nextTick=="function",L=typeof Symbol=="function",g=typeof Reflect=="object",O=typeof setImmediate=="function",S=O?setImmediate:setTimeout,P=L?g&&typeof Reflect.ownKeys=="function"?Reflect.ownKeys:function(e){var t=Object.getOwnPropertyNames(e);return t.push.apply(t,Object.getOwnPropertySymbols(e)),t}:Object.keys;function D(){this._events={},this._conf&&Y.call(this,this._conf)}function Y(e){e&&(this._conf=e,e.delimiter&&(this.delimiter=e.delimiter),e.maxListeners!==u&&(this._maxListeners=e.maxListeners),e.wildcard&&(this.wildcard=e.wildcard),e.newListener&&(this._newListener=e.newListener),e.removeListener&&(this._removeListener=e.removeListener),e.verboseMemoryLeak&&(this.verboseMemoryLeak=e.verboseMemoryLeak),e.ignoreErrors&&(this.ignoreErrors=e.ignoreErrors),this.wildcard&&(this.listenerTree={}))}function z(e,t){var n="(node) warning: possible EventEmitter memory leak detected. "+e+" listeners added. Use emitter.setMaxListeners() to increase limit.";if(this.verboseMemoryLeak&&(n+=" Event name: "+t+"."),typeof process<"u"&&process.emitWarning){var s=new Error(n);s.name="MaxListenersExceededWarning",s.emitter=this,s.count=e,process.emitWarning(s)}else console.error(n),console.trace&&console.trace()}var G=function(e,t,n){var s=arguments.length;switch(s){case 0:return[];case 1:return[e];case 2:return[e,t];case 3:return[e,t,n];default:for(var r=new Array(s);s--;)r[s]=arguments[s];return r}};function ne(e,t){for(var n={},s,r=e.length,o=t?t.length:0,i=0;i<r;i++)s=e[i],n[s]=i<o?t[i]:u;return n}function V(e,t,n){this._emitter=e,this._target=t,this._listeners={},this._listenersCount=0;var s,r;if((n.on||n.off)&&(s=n.on,r=n.off),t.addEventListener?(s=t.addEventListener,r=t.removeEventListener):t.addListener?(s=t.addListener,r=t.removeListener):t.on&&(s=t.on,r=t.off),!s&&!r)throw Error("target does not implement any known event API");if(typeof s!="function")throw TypeError("on method must be a function");if(typeof r!="function")throw TypeError("off method must be a function");this._on=s,this._off=r;var o=e._observers;o?o.push(this):e._observers=[this]}Object.assign(V.prototype,{subscribe:function(e,t,n){var s=this,r=this._target,o=this._emitter,i=this._listeners,a=function(){var c=G.apply(null,arguments),l={data:c,name:t,original:e};if(n){var h=n.call(r,l);h!==!1&&o.emit.apply(o,[l.name].concat(c));return}o.emit.apply(o,[t].concat(c))};if(i[e])throw Error("Event '"+e+"' is already listening");this._listenersCount++,o._newListener&&o._removeListener&&!s._onNewListener?(this._onNewListener=function(c){c===t&&i[e]===null&&(i[e]=a,s._on.call(r,e,a))},o.on("newListener",this._onNewListener),this._onRemoveListener=function(c){c===t&&!o.hasListeners(c)&&i[e]&&(i[e]=null,s._off.call(r,e,a))},i[e]=null,o.on("removeListener",this._onRemoveListener)):(i[e]=a,s._on.call(r,e,a))},unsubscribe:function(e){var t=this,n=this._listeners,s=this._emitter,r,o,i=this._off,a=this._target,c;if(e&&typeof e!="string")throw TypeError("event must be a string");function l(){t._onNewListener&&(s.off("newListener",t._onNewListener),s.off("removeListener",t._onRemoveListener),t._onNewListener=null,t._onRemoveListener=null);var h=oe.call(s,t);s._observers.splice(h,1)}if(e){if(r=n[e],!r)return;i.call(a,e,r),delete n[e],--this._listenersCount||l()}else{for(o=P(n),c=o.length;c-- >0;)e=o[c],i.call(a,e,n[e]);this._listeners={},this._listenersCount=0,l()}}});function W(e,t,n,s){var r=Object.assign({},t);if(!e)return r;if(typeof e!="object")throw TypeError("options must be an object");var o=Object.keys(e),i=o.length,a,c,l;function h(d){throw Error('Invalid "'+a+'" option value'+(d?". Reason: "+d:""))}for(var x=0;x<i;x++){if(a=o[x],!s&&!p.call(t,a))throw Error('Unknown "'+a+'" option');c=e[a],c!==u&&(l=n[a],r[a]=l?l(c,h):c)}return r}function Q(e,t){return(typeof e!="function"||!e.hasOwnProperty("prototype"))&&t("value must be a constructor"),e}function se(e){var t="value must be type of "+e.join("|"),n=e.length,s=e[0],r=e[1];return n===1?function(o,i){if(typeof o===s)return o;i(t)}:n===2?function(o,i){var a=typeof o;if(a===s||a===r)return o;i(t)}:function(o,i){for(var a=typeof o,c=n;c-- >0;)if(a===e[c])return o;i(t)}}var J=se(["function"]),q=se(["object","function"]);function re(e,t,n){var s,r,o=0,i,a=new e(function(c,l,h){n=W(n,{timeout:0,overload:!1},{timeout:function(w,I){return w*=1,(typeof w!="number"||w<0||!Number.isFinite(w))&&I("timeout must be a positive number"),w}}),s=!n.overload&&typeof e.prototype.cancel=="function"&&typeof h=="function";function x(){r&&(r=null),o&&(clearTimeout(o),o=0)}var d=function(w){x(),c(w)},T=function(w){x(),l(w)};s?t(d,T,h):(r=[function(w){T(w||Error("canceled"))}],t(d,T,function(w){if(i)throw Error("Unable to subscribe on cancel event asynchronously");if(typeof w!="function")throw TypeError("onCancel callback must be a function");r.push(w)}),i=!0),n.timeout>0&&(o=setTimeout(function(){var w=Error("timeout");w.code="ETIMEDOUT",o=0,a.cancel(w),l(w)},n.timeout))});return s||(a.cancel=function(c){if(!!r){for(var l=r.length,h=1;h<l;h++)r[h](c);r[0](c),r=null}}),a}function oe(e){var t=this._observers;if(!t)return-1;for(var n=t.length,s=0;s<n;s++)if(t[s]._target===e)return s;return-1}function C(e,t,n,s,r){if(!n)return null;if(s===0){var o=typeof t;if(o==="string"){var i,a,c=0,l=0,h=this.delimiter,x=h.length;if((a=t.indexOf(h))!==-1){i=new Array(5);do i[c++]=t.slice(l,a),l=a+x;while((a=t.indexOf(h,l))!==-1);i[c++]=t.slice(l),t=i,r=c}else t=[t],r=1}else o==="object"?r=t.length:(t=[t],r=1)}var d=null,T,w,I,H,j,B=t[s],X=t[s+1],U,k;if(s===r)n._listeners&&(typeof n._listeners=="function"?(e&&e.push(n._listeners),d=[n]):(e&&e.push.apply(e,n._listeners),d=[n]));else if(B==="*"){for(U=P(n),a=U.length;a-- >0;)T=U[a],T!=="_listeners"&&(k=C(e,t,n[T],s+1,r),k&&(d?d.push.apply(d,k):d=k));return d}else if(B==="**"){for(j=s+1===r||s+2===r&&X==="*",j&&n._listeners&&(d=C(e,t,n,r,r)),U=P(n),a=U.length;a-- >0;)T=U[a],T!=="_listeners"&&(T==="*"||T==="**"?(n[T]._listeners&&!j&&(k=C(e,t,n[T],r,r),k&&(d?d.push.apply(d,k):d=k)),k=C(e,t,n[T],s,r)):T===X?k=C(e,t,n[T],s+2,r):k=C(e,t,n[T],s,r),k&&(d?d.push.apply(d,k):d=k));return d}else n[B]&&(d=C(e,t,n[B],s+1,r));if(w=n["*"],w&&C(e,t,w,s+1,r),I=n["**"],I)if(s<r)for(I._listeners&&C(e,t,I,r,r),U=P(I),a=U.length;a-- >0;)T=U[a],T!=="_listeners"&&(T===X?C(e,t,I[T],s+2,r):T===B?C(e,t,I[T],s+1,r):(H={},H[T]=I[T],C(e,t,{"**":H},s+1,r)));else I._listeners?C(e,t,I,r,r):I["*"]&&I["*"]._listeners&&C(e,t,I["*"],r,r);return d}function le(e,t,n){var s=0,r=0,o,i=this.delimiter,a=i.length,c;if(typeof e=="string")if((o=e.indexOf(i))!==-1){c=new Array(5);do c[s++]=e.slice(r,o),r=o+a;while((o=e.indexOf(i,r))!==-1);c[s++]=e.slice(r)}else c=[e],s=1;else c=e,s=e.length;if(s>1){for(o=0;o+1<s;o++)if(c[o]==="**"&&c[o+1]==="**")return}var l=this.listenerTree,h;for(o=0;o<s;o++)if(h=c[o],l=l[h]||(l[h]={}),o===s-1)return l._listeners?(typeof l._listeners=="function"&&(l._listeners=[l._listeners]),n?l._listeners.unshift(t):l._listeners.push(t),!l._listeners.warned&&this._maxListeners>0&&l._listeners.length>this._maxListeners&&(l._listeners.warned=!0,z.call(this,l._listeners.length,h))):l._listeners=t,!0;return!0}function ie(e,t,n,s){for(var r=P(e),o=r.length,i,a,c,l=e._listeners,h;o-- >0;)a=r[o],i=e[a],a==="_listeners"?c=n:c=n?n.concat(a):[a],h=s||typeof a=="symbol",l&&t.push(h?c:c.join(this.delimiter)),typeof i=="object"&&ie.call(this,i,t,c,h);return t}function m(e){for(var t=P(e),n=t.length,s,r,o;n-- >0;)r=t[n],s=e[r],s&&(o=!0,r!=="_listeners"&&!m(s)&&delete e[r]);return o}function v(e,t,n){this.emitter=e,this.event=t,this.listener=n}v.prototype.off=function(){return this.emitter.off(this.event,this.listener),this};function N(e,t,n){if(n===!0)r=!0;else if(n===!1)s=!0;else{if(!n||typeof n!="object")throw TypeError("options should be an object or true");var s=n.async,r=n.promisify,o=n.nextTick,i=n.objectify}if(s||o||r){var a=t,c=t._origin||t;if(o&&!E)throw Error("process.nextTick is not supported");r===u&&(r=t.constructor.name==="AsyncFunction"),t=function(){var l=arguments,h=this,x=this.event;return r?o?Promise.resolve():new Promise(function(d){S(d)}).then(function(){return h.event=x,a.apply(h,l)}):(o?process.nextTick:S)(function(){h.event=x,a.apply(h,l)})},t._async=!0,t._origin=c}return[t,i?new v(this,e,t):this]}function f(e){this._events={},this._newListener=!1,this._removeListener=!1,this.verboseMemoryLeak=!1,Y.call(this,e)}f.EventEmitter2=f,f.prototype.listenTo=function(e,t,n){if(typeof e!="object")throw TypeError("target musts be an object");var s=this;n=W(n,{on:u,off:u,reducers:u},{on:J,off:J,reducers:q});function r(o){if(typeof o!="object")throw TypeError("events must be an object");var i=n.reducers,a=oe.call(s,e),c;a===-1?c=new V(s,e,n):c=s._observers[a];for(var l=P(o),h=l.length,x,d=typeof i=="function",T=0;T<h;T++)x=l[T],c.subscribe(x,o[x]||x,d?i:i&&i[x])}return _(t)?r(ne(t)):r(typeof t=="string"?ne(t.split(/\s+/)):t),this},f.prototype.stopListeningTo=function(e,t){var n=this._observers;if(!n)return!1;var s=n.length,r,o=!1;if(e&&typeof e!="object")throw TypeError("target should be an object");for(;s-- >0;)r=n[s],(!e||r._target===e)&&(r.unsubscribe(t),o=!0);return o},f.prototype.delimiter=".",f.prototype.setMaxListeners=function(e){e!==u&&(this._maxListeners=e,this._conf||(this._conf={}),this._conf.maxListeners=e)},f.prototype.getMaxListeners=function(){return this._maxListeners},f.prototype.event="",f.prototype.once=function(e,t,n){return this._once(e,t,!1,n)},f.prototype.prependOnceListener=function(e,t,n){return this._once(e,t,!0,n)},f.prototype._once=function(e,t,n,s){return this._many(e,1,t,n,s)},f.prototype.many=function(e,t,n,s){return this._many(e,t,n,!1,s)},f.prototype.prependMany=function(e,t,n,s){return this._many(e,t,n,!0,s)},f.prototype._many=function(e,t,n,s,r){var o=this;if(typeof n!="function")throw new Error("many only accepts instances of Function");function i(){return--t===0&&o.off(e,i),n.apply(this,arguments)}return i._origin=n,this._on(e,i,s,r)},f.prototype.emit=function(){if(!this._events&&!this._all)return!1;this._events||D.call(this);var e=arguments[0],t,n=this.wildcard,s,r,o,i,a;if(e==="newListener"&&!this._newListener&&!this._events.newListener)return!1;if(n&&(t=e,e!=="newListener"&&e!=="removeListener"&&typeof e=="object")){if(r=e.length,L){for(o=0;o<r;o++)if(typeof e[o]=="symbol"){a=!0;break}}a||(e=e.join(this.delimiter))}var c=arguments.length,l;if(this._all&&this._all.length)for(l=this._all.slice(),o=0,r=l.length;o<r;o++)switch(this.event=e,c){case 1:l[o].call(this,e);break;case 2:l[o].call(this,e,arguments[1]);break;case 3:l[o].call(this,e,arguments[1],arguments[2]);break;default:l[o].apply(this,arguments)}if(n)l=[],C.call(this,l,t,this.listenerTree,0,r);else if(l=this._events[e],typeof l=="function"){switch(this.event=e,c){case 1:l.call(this);break;case 2:l.call(this,arguments[1]);break;case 3:l.call(this,arguments[1],arguments[2]);break;default:for(s=new Array(c-1),i=1;i<c;i++)s[i-1]=arguments[i];l.apply(this,s)}return!0}else l&&(l=l.slice());if(l&&l.length){if(c>3)for(s=new Array(c-1),i=1;i<c;i++)s[i-1]=arguments[i];for(o=0,r=l.length;o<r;o++)switch(this.event=e,c){case 1:l[o].call(this);break;case 2:l[o].call(this,arguments[1]);break;case 3:l[o].call(this,arguments[1],arguments[2]);break;default:l[o].apply(this,s)}return!0}else if(!this.ignoreErrors&&!this._all&&e==="error")throw arguments[1]instanceof Error?arguments[1]:new Error("Uncaught, unspecified 'error' event.");return!!this._all},f.prototype.emitAsync=function(){if(!this._events&&!this._all)return!1;this._events||D.call(this);var e=arguments[0],t=this.wildcard,n,s,r,o,i,a;if(e==="newListener"&&!this._newListener&&!this._events.newListener)return Promise.resolve([!1]);if(t&&(n=e,e!=="newListener"&&e!=="removeListener"&&typeof e=="object")){if(o=e.length,L){for(i=0;i<o;i++)if(typeof e[i]=="symbol"){s=!0;break}}s||(e=e.join(this.delimiter))}var c=[],l=arguments.length,h;if(this._all)for(i=0,o=this._all.length;i<o;i++)switch(this.event=e,l){case 1:c.push(this._all[i].call(this,e));break;case 2:c.push(this._all[i].call(this,e,arguments[1]));break;case 3:c.push(this._all[i].call(this,e,arguments[1],arguments[2]));break;default:c.push(this._all[i].apply(this,arguments))}if(t?(h=[],C.call(this,h,n,this.listenerTree,0)):h=this._events[e],typeof h=="function")switch(this.event=e,l){case 1:c.push(h.call(this));break;case 2:c.push(h.call(this,arguments[1]));break;case 3:c.push(h.call(this,arguments[1],arguments[2]));break;default:for(r=new Array(l-1),a=1;a<l;a++)r[a-1]=arguments[a];c.push(h.apply(this,r))}else if(h&&h.length){if(h=h.slice(),l>3)for(r=new Array(l-1),a=1;a<l;a++)r[a-1]=arguments[a];for(i=0,o=h.length;i<o;i++)switch(this.event=e,l){case 1:c.push(h[i].call(this));break;case 2:c.push(h[i].call(this,arguments[1]));break;case 3:c.push(h[i].call(this,arguments[1],arguments[2]));break;default:c.push(h[i].apply(this,r))}}else if(!this.ignoreErrors&&!this._all&&e==="error")return arguments[1]instanceof Error?Promise.reject(arguments[1]):Promise.reject("Uncaught, unspecified 'error' event.");return Promise.all(c)},f.prototype.on=function(e,t,n){return this._on(e,t,!1,n)},f.prototype.prependListener=function(e,t,n){return this._on(e,t,!0,n)},f.prototype.onAny=function(e){return this._onAny(e,!1)},f.prototype.prependAny=function(e){return this._onAny(e,!0)},f.prototype.addListener=f.prototype.on,f.prototype._onAny=function(e,t){if(typeof e!="function")throw new Error("onAny only accepts instances of Function");return this._all||(this._all=[]),t?this._all.unshift(e):this._all.push(e),this},f.prototype._on=function(e,t,n,s){if(typeof e=="function")return this._onAny(e,t),this;if(typeof t!="function")throw new Error("on only accepts instances of Function");this._events||D.call(this);var r=this,o;return s!==u&&(o=N.call(this,e,t,s),t=o[0],r=o[1]),this._newListener&&this.emit("newListener",e,t),this.wildcard?(le.call(this,e,t,n),r):(this._events[e]?(typeof this._events[e]=="function"&&(this._events[e]=[this._events[e]]),n?this._events[e].unshift(t):this._events[e].push(t),!this._events[e].warned&&this._maxListeners>0&&this._events[e].length>this._maxListeners&&(this._events[e].warned=!0,z.call(this,this._events[e].length,e))):this._events[e]=t,r)},f.prototype.off=function(e,t){if(typeof t!="function")throw new Error("removeListener only takes instances of Function");var n,s=[];if(this.wildcard){var r=typeof e=="string"?e.split(this.delimiter):e.slice();if(s=C.call(this,null,r,this.listenerTree,0),!s)return this}else{if(!this._events[e])return this;n=this._events[e],s.push({_listeners:n})}for(var o=0;o<s.length;o++){var i=s[o];if(n=i._listeners,_(n)){for(var a=-1,c=0,l=n.length;c<l;c++)if(n[c]===t||n[c].listener&&n[c].listener===t||n[c]._origin&&n[c]._origin===t){a=c;break}if(a<0)continue;return this.wildcard?i._listeners.splice(a,1):this._events[e].splice(a,1),n.length===0&&(this.wildcard?delete i._listeners:delete this._events[e]),this._removeListener&&this.emit("removeListener",e,t),this}else(n===t||n.listener&&n.listener===t||n._origin&&n._origin===t)&&(this.wildcard?delete i._listeners:delete this._events[e],this._removeListener&&this.emit("removeListener",e,t))}return this.listenerTree&&m(this.listenerTree),this},f.prototype.offAny=function(e){var t=0,n=0,s;if(e&&this._all&&this._all.length>0){for(s=this._all,t=0,n=s.length;t<n;t++)if(e===s[t])return s.splice(t,1),this._removeListener&&this.emit("removeListenerAny",e),this}else{if(s=this._all,this._removeListener)for(t=0,n=s.length;t<n;t++)this.emit("removeListenerAny",s[t]);this._all=[]}return this},f.prototype.removeListener=f.prototype.off,f.prototype.removeAllListeners=function(e){if(e===u)return!this._events||D.call(this),this;if(this.wildcard){var t=C.call(this,null,e,this.listenerTree,0),n,s;if(!t)return this;for(s=0;s<t.length;s++)n=t[s],n._listeners=null;this.listenerTree&&m(this.listenerTree)}else this._events&&(this._events[e]=null);return this},f.prototype.listeners=function(e){var t=this._events,n,s,r,o,i;if(e===u){if(this.wildcard)throw Error("event name required for wildcard emitter");if(!t)return[];for(n=P(t),o=n.length,r=[];o-- >0;)s=t[n[o]],typeof s=="function"?r.push(s):r.push.apply(r,s);return r}else{if(this.wildcard){if(i=this.listenerTree,!i)return[];var a=[],c=typeof e=="string"?e.split(this.delimiter):e.slice();return C.call(this,a,c,i,0),a}return t?(s=t[e],s?typeof s=="function"?[s]:s:[]):[]}},f.prototype.eventNames=function(e){var t=this._events;return this.wildcard?ie.call(this,this.listenerTree,[],null,e):t?P(t):[]},f.prototype.listenerCount=function(e){return this.listeners(e).length},f.prototype.hasListeners=function(e){if(this.wildcard){var t=[],n=typeof e=="string"?e.split(this.delimiter):e.slice();return C.call(this,t,n,this.listenerTree,0),t.length>0}var s=this._events,r=this._all;return!!(r&&r.length||s&&(e===u?P(s).length:s[e]))},f.prototype.listenersAny=function(){return this._all?this._all:[]},f.prototype.waitFor=function(e,t){var n=this,s=typeof t;return s==="number"?t={timeout:t}:s==="function"&&(t={filter:t}),t=W(t,{timeout:0,filter:u,handleError:!1,Promise,overload:!1},{filter:J,Promise:Q}),re(t.Promise,function(r,o,i){function a(){var c=t.filter;if(!(c&&!c.apply(n,arguments)))if(n.off(e,a),t.handleError){var l=arguments[0];l?o(l):r(G.apply(null,arguments).slice(1))}else r(G.apply(null,arguments))}i(function(){n.off(e,a)}),n._on(e,a,!1)},{timeout:t.timeout,overload:t.overload})};function A(e,t,n){n=W(n,{Promise,timeout:0,overload:!1},{Promise:Q});var s=n.Promise;return re(s,function(r,o,i){var a;if(typeof e.addEventListener=="function"){a=function(){r(G.apply(null,arguments))},i(function(){e.removeEventListener(t,a)}),e.addEventListener(t,a,{once:!0});return}var c=function(){l&&e.removeListener("error",l),r(G.apply(null,arguments))},l;t!=="error"&&(l=function(h){e.removeListener(t,c),o(h)},e.once("error",l)),i(function(){l&&e.removeListener("error",l),e.removeListener(t,c)}),e.once(t,c)},{timeout:n.timeout,overload:n.overload})}var y=f.prototype;if(Object.defineProperties(f,{defaultMaxListeners:{get:function(){return y._maxListeners},set:function(e){if(typeof e!="number"||e<0||Number.isNaN(e))throw TypeError("n must be a non-negative number");y._maxListeners=e},enumerable:!0},once:{value:A,writable:!0,configurable:!0}}),Object.defineProperties(y,{_maxListeners:{value:b,writable:!0,configurable:!0},_observers:{value:null,writable:!0,configurable:!0}}),typeof define=="function"&&define.amd)define(function(){return f});else if(typeof ve=="object")de.exports=f;else{var R=new Function("","return this")();R.EventEmitter2=f}})()});var xe=Ee((Gn,Te)=>{Te.exports=be()});var Fe=Je(xe(),1);var qe="as",$e="=",et="break",tt="else",nt="enum",st="export",rt="if",ot="import",it="->",ct="is",lt="loop",at="mut",ut="native",ft="object",ht="fn",pt="return",_t="self",mt="template",Et=Object.freeze({ALIAS:qe,ASSIGN:$e,BREAK:et,ELSE:tt,ENUMERATION:nt,EXPORT:st,IF:rt,IMPORT:ot,INTO:it,IS:ct,LOOP:lt,MUTABLE:at,NATIVE:ut,OBJECT:ft,PROCEDURE:ht,RETURN:pt,SELF:_t,TEMPLATE:mt}),ge=Et;var vt="array",dt="assignment",bt="branch-default",Tt="branch-value",xt="break",gt="condition",Ot="declaration",Lt="enumeration",wt="export",At="expression",yt="import",Nt="label",It="literal",Rt="loop",Pt="module",Ct="mutable",Dt="name-list",kt="native",Mt="object",St="procedure",Ut="return",Bt="self",jt="submodule",Ft="template",Ht="type-pair",Xt=Object.freeze({ARRAY:vt,ASSIGNMENT:dt,BRANCH_DEFAULT:bt,BRANCH_VALUE:Tt,BREAK:xt,CONDITION:gt,DECLARATION:Ot,ENUMERATION:Lt,EXPORT:wt,EXPRESSION:At,IMPORT:yt,LABEL:Nt,LITERAL:It,LOOP:Rt,MODULE:Pt,MUTABLE:Ct,NAME_LIST:Dt,NATIVE:kt,OBJECT:Mt,PROCEDURE:St,RETURN:Ut,SELF:Bt,SUBMODULE:jt,TEMPLATE:Ft,TYPE_PAIR:Ht}),Oe=Xt;var Yt=Object.freeze({COLON:58,COMMA:44,DIGIT_ZERO:48,DIGIT_NINE:57,DOT:46,HASHTAG:35,HORIZONTAL_TAB:9,HYPHEN_MINUS:45,LEFT_CURLY_BRACKET:123,LEFT_PARENTHESIS:40,LEFT_SQUARE_BRACKET:91,LINE_BREAK:10,NULL:0,PLUS_SIGN:43,RIGHT_CURLY_BRACKET:125,RIGHT_PARENTHESIS:41,RIGHT_SQUARE_BRACKET:93,SEMICOLON:59,SPACE:32}),Le=Yt;var Gt=Object.freeze([]),Kt=Object.freeze({}),zt="",Vt="	",Wt=`
`,Zt="UTF-8",Qt=Object.freeze({EMPTY_ARRAY:Gt,EMPTY_OBJECT:Kt,EMPTY_STRING:zt,HORIZONTAL_TAB:Vt,LINE_BREAK:Wt,UNICODE_TEXT:Zt,Codes:Le,Keys:ge,Types:Oe}),$=Qt;var{EMPTY_STRING:Jt,UNICODE_TEXT:pe}=$,qt=-1,$t=1,en=new TextDecoder(pe),tn=new TextEncoder,nn=(u,p,_=0,b=u.length|0,E=0,L=p.length|0)=>{for(E=E|0,_=_|0,L=L|0,b=b|0;;){let g=_>=b,O=E>=L;if(g||O)break;let P=u[_],D=p[E];if(_=_+1|0,E=E+1|0,P<D)return qt;if(P>D)return $t}return 0},sn=(u,p,_=0,b=u.length|0,E=0,L=p.length|0)=>{for(E=E|0,_=_|0,L=L|0,b=b|0;;){let g=E>=L,O=_>=b;if(g||O)break;p[E]=u[_],E=E+1|0,_=_+1|0}},rn=(u,p,_=0,b=u.length|0,E=0,L=p.length|0)=>{for(_=_|0,E=E|0,b=b|0,L=L|0;;){let g=_>=b,O=E>=L;if(g||O)break;let P=u[_],D=p[E];if(_=_+1|0,E=E+1|0,P!==D)return!1}return!0},on=u=>{u=u>>>0;let p=0,_=0;for(;_=(_<<1|1)>>>0,!(_>u);)p=p+1|0;return p},ye=Object.freeze([48,49,50,51,52,53,54,55,56,57,97,98,99,100,101,102]),fe=(u,p,_,b)=>{for(u=u>>>0,b=b??p.length|0,_=_|0,b=b|0;u>0&&b>_;)b=b-1|0,p[b]=ye[u&15],u=u>>>4},Ne=128,Ie=127,cn=-1,he=64,_e=u=>{u=u|0;let p=[];for(;;){let _=u&Ie;u=u>>7;let b=u===0,E=(_&he)===0,L=b&&E,g=u===-1,O=(_&he)!==0;if(L||g&&O){p.push(_);break}_=_|Ne,p.push(_)}return p},Re=(u,p)=>{p=p|0;let _=0,b=0;for(;;){let E=u[p]|0;p=p+1|0;let L=(E&Ie)<<b;if(b=b+7|0,_=_|L,(E&Ne)===0){let O=(E&he)!==0,S=b<32;if(O&&S){let D=cn<<b;_=_|D}break}}return _},ln=u=>en.decode(u),an=u=>tn.encode(u),un=(u=Jt)=>{let p=u.length|0,_=_e(p),b=Buffer.from(u,pe);return Object.freeze([..._,...b])},fn=(u,p)=>{p=p|0;let _=Re(u,p),b=_e(_).length;return p=p+b|0,u.subarray(p,p+_|0).toString(pe)},hn=58,pn=46,ee=32,ae=48,_n=67,K=new Uint8Array(_n),we=K.subarray(0,8),ce=K.subarray(10,49),Ae=K.subarray(51,68),ue=16,mn=2;K[8]=hn;K[9]=ee;K[49]=ee;K[50]=ee;var En=(u,p)=>{p=p??console.log;let _=32,b=126,E=u.length|0,L=0;for(;E>0;){we.fill(ae),fe(L,we),ce.fill(ee),Ae.fill(ee);let g=E>=ue?ue:E;E=E-ue|0;let O=0,S=0;for(let D=1;D<=g;D=D+1|0){let Y=u[L]&255;ce[O+0|0]=ae,ce[O+1|0]=ae,fe(Y,ce,O,O+2|0);let z=pn;_<=Y&&Y<=b&&(z=Y),Ae[S]=z,L=L+1|0,O=O+2|0,S=S+1|0,D%mn===0&&(O=O+1|0)}let P=String.fromCodePoint(...K);p(P)}},vn=function*(u,p){let _=u.length|0,b=p.length|0,E=0;for(;E<_&&E<b;){let L=u[E],g=p[E];yield[L,g],E=E+1|0}},dn=function*(u,p,_){let b=u.length|0,E=p.length|0,L=_.length|0,g=0;for(;g<b&&g<E&&g<L;){let O=u[g],S=p[g],P=_[g];yield[O,S,P],g=g+1|0}},bn=Object.freeze({ARRAY_COMPARE:nn,ARRAY_COPY:sn,ARRAY_EQUAL:rn,BIT_DEPTH:on,HEX_DIGITS:ye,HEX_ENCODE:fe,LEB128_DECODE:Re,LEB128_ENCODE:_e,UTF8_DECODE:ln,UTF8_ENCODE:an,WASM_STRING_ENCODE:un,WASM_STRING_DECODE:fn,XXD_DUMP_HEX:En,ZIP2:vn,ZIP3:dn}),Pe=bn;var{EMPTY_ARRAY:Tn,EMPTY_OBJECT:ns,EMPTY_STRING:ss,UNICODE_TEXT:rs}=$,{BIT_DEPTH:xn,HEX_ENCODE:gn,LEB128_ENCODE:M,ZIP2:Ce}=Pe,{Types:F}=$,On=Object.freeze({number:!1}),De=Object.freeze({[F.BRANCH_VALUE]:1,[F.BRANCH_DEFAULT]:2}),Ln=new Set(["done","error"]),wn=Object.freeze([0,97,115,109]),An=Object.freeze([1,0,0,0]),yn=48,Nn=10,In=7,Rn=3,Pn=1,ke=64,Cn=96,Me=127,Dn=0,Se=2,kn=12,Mn=13,Ue=65,Sn=71,Un=32,Bn=15,Be=11;var Z=1,te=2,je=u=>u.join("."),jn=(u,p)=>{let _=De[u.type]|0,b=De[p.type]|0;return _-b|0},Fn=()=>{let u=new Map,p=new Fe.default;return p.on("done",(E,L)=>{(u.get("done")||Tn).forEach(O=>{O(E,L)})}),Object.freeze({compile:(E,L=On)=>{let g=new Map,O=new Map,S=m=>{let v=[],{inputs:N,locals:f,outputs:A,statements:y}=m,R=x=>d=>({type:"branch",branch:d,values:x}),e=x=>({type:"statement",statement:x}),t=x=>{let d=new Map;return Object.keys(x).forEach(T=>{let w=x[T],{path:I,type:H}=w,j=g.get(I);d.set(T,j)}),d},n=t(N),s=t(A),r=y.map(e);r.push({type:"block-end"});let o=x=>{let{branch:d,values:T}=x;switch(d.type){case F.BRANCH_VALUE:{let{statements:w}=d;v.push(Se,ke);let I=Ce(T,d.values);for(let[j,B]of I)switch(j.type){case"local":{let{label:X}=j,U=f.get(X),{index:k,path:He}=U,Xe=g.get(He).parse(B),Ye=M(k);v.push(Un),v.push(...Ye);let Ge=M(Xe);v.push(Ue),v.push(...Ge),v.push(Sn),v.push(Mn,0);break}}r.unshift({type:"branch-close"});let H=w.map(e);r.unshift(...H);break}}},i=x=>{v.push(kn,1),v.push(Be)},a=x=>{let{statement:d}=x;switch(d.type){case F.CONDITION:{v.push(Se,ke),r.unshift({type:"block-end"});let{values:T,branches:w}=d;w.sort(jn);let I=T.map(B=>({type:"local",label:B})),H=R(I),j=w.map(H);r.unshift(...j);break}case F.RETURN:{let{keys:T,map:w}=A,I=T.map(B=>{let X=w.get(B),{path:U}=X;return g.get(U)}),{values:H}=d,j=Ce(H,I);for(let[B,X]of j){let U=X.parse(B),k=M(U);v.push(Ue),v.push(...k)}v.push(Bn);break}}},c=x=>{v.push(Be)};for(;r.length>0;){let x=r.shift();switch(x.type){case"block-end":{c(x);break}case"branch":{o(x);break}case"branch-close":{i(x);break}case"statement":{a(x);break}}}let l=f.size-N.keys.length|0;return v=[...M(l),...v],v},P=()=>{let m=[];for(let[y,R]of O){let e=S(R),t=e.length|0,n=M(t);m=[...m,...n,...e]}let v=O.size|0;m=[...M(v),...m];let f=m.length|0,A=M(f);return m=[Nn,...A,...m],m},D=()=>{let m=[];for(let[f,A]of O){let{inputs:y,outputs:R}=A,{keys:e}=y,{keys:t}=R,n=e.length,s=t.length,r=Array(n).fill(Me),o=Array(s).fill(Me),i=[Cn,n,...r,s,...o];m=[...m,...i]}m=[...M(O.size|0),...m];let N=M(m.length);return m=[Pn,...N,...m],m},Y=()=>{let m=[],v=new Uint8Array(8),N=M(8),f=M(Dn);for(let[R,e]of O){let{index:t}=e,n=M(t);v.fill(yn),gn(t,v),m=[...m,...N,...v,...f,...n]}m=[...M(O.size),...m];let y=M(m.length);return m=[In,...y,...m],m},z=()=>{let m=[];for(let f=0;f<O.size;f=f+1|0){let A=M(f);m=[...m,...A]}m=[...M(O.size),...m];let N=M(m.length);return m=[Rn,...N,...m],m},G=(m,v)=>{let N=new Map,f=v.map(A=>A.key);v.forEach(A=>{let{key:y,value:R}=A,e=R.join("."),t=[];for(let[n,s]of g)if(n.endsWith(e)){let r={type:"enumeration",path:n};t.push(r)}t.length===1&&N.set(y,t[0])}),m.map=N,m.keys=f},ne=(m,v,N)=>{let{items:f,name:A}=N;v.push(A);let y={type:te};m.push(y);let R=h=>h.type===F.LABEL,e=h=>h.name,t=f.filter(R).map(e),n=xn(t.length),s=new Map;t.forEach((h,x)=>{s.set(h,x)});let o={type:"list",bitDepth:n,labels:t,parse:h=>s.get(h)},i=je(v);g.set(i,o);let a=h=>h.type!==F.LABEL,c=h=>({type:Z,node:h}),l=f.filter(a).map(c);m.push(...l)},V=0,W=(m,v,N)=>{let{head:f,body:A}=N,{name:y,inputs:R,outputs:e}=f,t=new Map;R.forEach((a,c)=>{let{key:l,value:h}=a,x=h.join("."),d=[];for(let[T,w]of g)if(T.endsWith(x)){let I={type:"enumeration",path:T};d.push(I)}if(d.length===1){let w={...d[0],index:c};t.set(l,w)}}),v.push(y);let n={type:te};m.push(n);let s=je(v),r={};G(r,R);let o={};G(o,e);let i={index:V,locals:t,inputs:r,outputs:o,statements:A};O.set(s,i),V=V+1|0},Q=(m,v,N)=>{let{items:f,name:A}=N;v.push(A);let y={type:te};m.push(y);let R=f.map(e=>({type:Z,node:e}));m.push(...R)},se=m=>{let v=[],f=[{type:Z,node:m}];for(;f.length>0;){let A=f.pop();switch(A.type){case Z:{let{node:y}=A;switch(y.type){case F.ENUMERATION:{ne(f,v,y);break}case F.MODULE:{Q(f,v,y);break}}break}case te:{v.pop();break}}}},J=m=>{let v=[],f=[{type:Z,node:m}];for(;f.length>0;){let A=f.pop();switch(A.type){case Z:{let{node:y}=A;switch(y.type){case F.MODULE:{Q(f,v,y);break}case F.PROCEDURE:{W(f,v,y);break}}break}case te:{v.pop();break}}}};se(E),J(E);let q={};if(g.size>0){let m={};q.enum=m;for(let[v,N]of g){let{type:f,labels:A,bitDepth:y}=N,R={type:f,labels:A,bitDepth:y};m[v]=R}}if(O.size>0){let m={};q.fn=m;let v=N=>{let f={},{map:A,keys:y}=N;return y.forEach(R=>{let e=A.get(R);f[R]=e}),f};for(let[N,f]of O){let{inputs:A,outputs:y}=f,R=v(A),e=v(y),t={inputs:R,outputs:e};if(L.index){let{index:n}=f;t.index=n}m[N]=t}}let re=D(),oe=z(),C=Y(),le=P(),ie=new Uint8Array([...wn,...An,...re,...oe,...C,...le]);p.emit("done",q,ie)},on:(E,L)=>{if(Ln.has(E)){let g=u.get(E)||[];g.push(L),u.set(E,g)}}})},Hn=Object.freeze({create:Fn}),os=Hn;export{os as default};
