var Qn="as",eo="=",to="break",so="else",no="enum",oo="export",co="if",ao="import",ro="->",io="is",po="loop",lo="mut",uo="native",fo="object",Eo="fn",ho="return",bo="self",Oo="template",_o=Object.freeze({ALIAS:Qn,ASSIGN:eo,BREAK:to,ELSE:so,ENUMERATION:no,EXPORT:oo,IF:co,IMPORT:ao,INTO:ro,IS:io,LOOP:po,MUTABLE:lo,NATIVE:uo,OBJECT:fo,PROCEDURE:Eo,RETURN:ho,SELF:bo,TEMPLATE:Oo}),ln=_o;var mo="assign",go="array_assignment",xo="branch-match",To="branch-default",yo="condition",Io="loop",zo="data",No="generics",jo="enumeration",Ao="expression",Po="instance",Ro="Link",Co="local",So="object",Do="procedure",Fo="return",ko="select",Uo="member",Lo="store",vo="break",Vo="literal",Yo="array_access",wo="valueLink",Bo="linkValue",Mo="self",Ko="procedure-call",Go="Maybe",Ho="native",Xo="move",$o="String",Jo="Array",Wo="import",Zo="library",qo="constructor",Qo="destructor",ec="free",tc="block-end",sc="default-block",nc="continue",oc="branch",cc="statement",ac="draw",rc="size",ic="concatenation",pc="foreach",lc="while",uc="while-condition",fc="foreach-condition",Ec="foreach-end",hc=Object.freeze({TYPES_ASSIGN:mo,TYPES_ARRAY:Jo,TYPES_ARRAY_ASSIGNMENT:go,TYPES_BRANCH_MATCH:xo,TYPES_BRANCH_DEFAULT:To,TYPES_CONDITION:yo,TYPES_LOOP:Io,TYPES_FOREACH_END:Ec,TYPES_WHILE_CONDITION:uc,TYPES_FOREACH_CONDITION:fc,TYPES_DATA:zo,TYPES_GENERICS:No,TYPES_ENUMERATION:jo,TYPES_EXPRESSION:Ao,TYPES_INSTANCE:Po,TYPES_LINK:Ro,TYPES_IMPORT:Wo,TYPES_LOCAL:Co,TYPES_OBJECT:So,TYPES_PROCEDURE:Do,TYPES_RETURN:Fo,TYPES_SELECT:ko,TYPES_MEMBER:Uo,TYPES_STORE:Lo,TYPES_BREAK:vo,TYPES_LITERAL:Vo,TYPES_ARRAY_ACCESS:Yo,TYPES_LINK_TO:wo,TYPES_VALUE_AT:Bo,TYPES_SELF:Mo,TYPES_LIBRARY:Zo,TYPES_DROP:Ko,TYPES_MAYBE:Go,TYPES_NATIVE:Ho,TYPES_MOVE:Xo,TYPES_STRING:$o,TYPES_CONSTRUCTOR:qo,TYPES_FREE:ec,TYPES_DEFAULT_BLOCK:sc,TYPES_BLOCK_END:tc,TYPES_CONTINUE:nc,TYPES_BRANCH:oc,TYPES_STATEMENT:cc,TYPES_DESTRUCTOR:Qo,TYPES_DRAW:ac,TYPES_SIZE:rc,TYPES_CONCAT:ic,TYPES_FOREACH:pc,TYPES_WHILE:lc}),ds=hc;var bc=Object.freeze({COLON:58,COMMA:44,DIGIT_ZERO:48,DIGIT_NINE:57,DOT:46,HASHTAG:35,HORIZONTAL_TAB:9,HYPHEN_MINUS:45,LEFT_CURLY_BRACKET:123,LEFT_PARENTHESIS:40,LEFT_SQUARE_BRACKET:91,LINE_BREAK:10,NULL:0,PLUS_SIGN:43,RIGHT_CURLY_BRACKET:125,RIGHT_PARENTHESIS:41,RIGHT_SQUARE_BRACKET:93,SEMICOLON:59,SPACE:32}),un=bc;var Oc=Object.freeze([]),_c=Object.freeze({}),dc="",mc="	",gc=`
`,xc="UTF-8",Mt=ds,Tc=Object.freeze({EMPTY_ARRAY:Oc,EMPTY_OBJECT:_c,EMPTY_STRING:dc,HORIZONTAL_TAB:mc,LINE_BREAK:gc,UNICODE_TEXT:xc,Codes:un,Keys:ln,Types:ds}),fn=Tc;var{EMPTY_STRING:yc,UNICODE_TEXT:Ts}=fn,Ic=44,zc=48,Nc=57,jc=46,Ac=45,Pc=43,Rc=65,Cc=90,Sc=-1,Dc=1,Fc=new TextDecoder(Ts),kc=new TextEncoder,Uc=(s,t,c=0,E=s.length|0,N=0,e=t.length|0)=>{for(N=N|0,c=c|0,e=e|0,E=E|0;;){let v=c>=E,G=N>=e;if(v||G)break;let Re=s[c],me=t[N];if(c=c+1|0,N=N+1|0,Re<me)return Sc;if(Re>me)return Dc}return 0},Lc=(s,t,c=0,E=s.length|0,N=0,e=t.length|0)=>{for(N=N|0,c=c|0,e=e|0,E=E|0;;){let v=N>=e,G=c>=E;if(v||G)break;t[N]=s[c],N=N+1|0,c=c+1|0}},vc=(s,t,c=0,E=s.length|0,N=0,e=t.length|0)=>{c=c|0,N=N|0,E=E|0,e=e|0;let v=E-c|0,G=e-N|0;if(v!==G)return!1;for(;;){let de=c>=E,Re=N>=e;if(de||Re)break;let Qe=s[c],$e=t[N];if(c=c+1|0,N=N+1|0,Qe!==$e)return!1}return!0},Vc=s=>{s=s>>>0;let t=0,c=0;for(;c=(c<<1|1)>>>0,!(c>s);)t=t+1|0;return t},bn=Object.freeze([48,49,50,51,52,53,54,55,56,57,97,98,99,100,101,102]),xs=(s,t,c,E)=>{for(s=s>>>0,E=E??t.length|0,c=c|0,E=E|0;s>0&&E>c;)E=E-1|0,t[E]=bn[s&15],s=s>>>4},Yc=(s,t,c,E)=>{let N=c|0,e=c+E|0;if(E===0)return!1;let v=t[N];for((v===Pc||v===Ac)&&(N=N+1|0);N<e;){let G=t[N];if(N=N+1|0,!(zc<=G&&G<=Nc||(jc===G||Ic===G)))return!1}return!0},wc=s=>{let t=s>=Rc,c=s<=Cc;return t&&c},Gt=128,Ht=127,On=-1,Ot=64,ys=s=>{s=s|0;let t=[];for(;;){let c=s&Ht;s=s>>7;let E=s===0,N=(c&Ot)===0,e=E&&N,v=s===-1,G=(c&Ot)!==0;if(e||v&&G){t.push(c);break}c=c|Gt,t.push(c)}return t},Bc=s=>{let t=[],c=!0;for(;c;){let E=s&Ht;s>>=7,s===0&&!(E&Ot)||s===-1&&E&Ot?c=!1:E|=Gt,t.push(E)}return t},_n=(s,t)=>{t=t|0;let c=0,E=0;for(;;){let N=s[t]|0;t=t+1|0;let e=(N&Ht)<<E;if(E=E+7|0,c=c|e,(N&Gt)===0){let G=(N&Ot)!==0,de=E<32;if(G&&de){let me=On<<E;c=c|me}break}}return c},Mc=(s,t)=>{t=t|0;let c=0,E=0;for(;;){let N=s[t]|0;t=t+1|0;let e=(N&Ht)<<E;if(E=E+7|0,c=c|e,!(N&Gt)){if(N&Ot){let v=On<<E;c=c|v}break}}return c},Kc=s=>Fc.decode(s),Gc=s=>kc.encode(s),Hc=(s=yc)=>{let t=s.length|0,c=ys(t),E=Buffer.from(s,Ts);return Object.freeze([...c,...E])},Xc=(s,t)=>{t=t|0;let c=_n(s,t),E=ys(c).length;return t=t+E|0,s.subarray(t,t+c|0).toString(Ts)},$c=58,Jc=46,At=32,ms=48,Wc=67,it=new Uint8Array(Wc),En=it.subarray(0,8),Kt=it.subarray(10,49),hn=it.subarray(51,68),gs=16,Zc=2;it[8]=$c;it[9]=At;it[49]=At;it[50]=At;var qc=(s,t)=>{t=t??console.log;let c=32,E=126,N=s.length|0,e=0;for(;N>0;){En.fill(ms),xs(e,En),Kt.fill(At),hn.fill(At);let v=N>=gs?gs:N;N=N-gs|0;let G=0,de=0;for(let me=1;me<=v;me=me+1|0){let Qe=s[e]&255;Kt[G+0|0]=ms,Kt[G+1|0]=ms,xs(Qe,Kt,G,G+2|0);let $e=Jc;c<=Qe&&Qe<=E&&($e=Qe),hn[de]=$e,e=e+1|0,G=G+2|0,de=de+1|0,me%Zc===0&&(G=G+1|0)}let Re=String.fromCodePoint(...it);t(Re)}},Qc=function*(s,t){let c=s.length|0,E=t.length|0,N=0;for(;N<c&&N<E;){let e=s[N],v=t[N];yield[e,v],N=N+1|0}},ea=function*(s,t,c){let E=s.length|0,N=t.length|0,e=c.length|0,v=0;for(;v<E&&v<N&&v<e;){let G=s[v],de=t[v],Re=c[v];yield[G,de,Re],v=v+1|0}},ta=Object.freeze({ARRAY_COMPARE:Uc,ARRAY_COPY:Lc,ARRAY_EQUAL:vc,BIT_DEPTH:Vc,HEX_DIGITS:bn,HEX_ENCODE:xs,IS_NUMBER:Yc,IS_UPPERCASE:wc,LEB128_DECODE:_n,LEB128_DECODE_SIGNED:Mc,LEB128_ENCODE:ys,LEB128_ENCODE_SIGNED:Bc,UTF8_DECODE:Kc,UTF8_ENCODE:Gc,WASM_STRING_ENCODE:Hc,WASM_STRING_DECODE:Xc,XXD_DUMP_HEX:qc,ZIP2:Qc,ZIP3:ea}),_t=ta;var Me=(s,t=2)=>{let c="";switch(s){case"+":c="add";break;case"-":c=t===2?"sub":"neg";break;case"*":c="mul";break;case"/":c="div";break;case"%":c="rem";break;case"==":c="eq";break;case">":c="gt";break;case"<":c="lt";break;case">=":c="ge";break;case"<=":c="le";break;case"!=":c="ne";break;case"&":c="and";break;case"|":c="or";break;case"^":c="xor";break;case"not":c="not";break;case"I32":c="toi32";break;case"U32":c="tou32";break;case"I64":c="toi64";break;case"U64":c="tou64";break;case"FP64":c="tofp64";break;case"FP32":c="tofp32";break}return c};var sa=Object.freeze({type:"native",body:Object.freeze([160]),lengths:Object.freeze({inputs:2,outputs:1})}),na=Object.freeze({type:"native",body:Object.freeze([163]),lengths:Object.freeze({inputs:2,outputs:1})}),oa=Object.freeze({type:"native",body:Object.freeze([162]),lengths:Object.freeze({inputs:2,outputs:1})}),ca=Object.freeze({type:"native",body:Object.freeze([68,0,0,0,0,0,0,240,191,162]),lengths:Object.freeze({inputs:1,outputs:1})}),aa=Object.freeze({type:"native",body:Object.freeze([161]),lengths:Object.freeze({inputs:2,outputs:1})}),ra=Object.freeze({type:"native",body:Object.freeze([124]),lengths:Object.freeze({inputs:2,outputs:1})}),ia=Object.freeze({type:"native",body:Object.freeze([128]),lengths:Object.freeze({inputs:2,outputs:1})}),pa=Object.freeze({type:"native",body:Object.freeze([126]),lengths:Object.freeze({inputs:2,outputs:1})}),la=Object.freeze({type:"native",body:Object.freeze([66,255,255,255,255,255,255,255,255,126]),lengths:Object.freeze({inputs:1,outputs:1})}),ua=Object.freeze({type:"native",body:Object.freeze([125]),lengths:Object.freeze({inputs:2,outputs:1})}),fa=Object.freeze({type:"native",body:Object.freeze([124]),lengths:Object.freeze({inputs:2,outputs:1})}),Ea=Object.freeze({type:"native",body:Object.freeze([127]),lengths:Object.freeze({inputs:2,outputs:1})}),ha=Object.freeze({type:"native",body:Object.freeze([126]),lengths:Object.freeze({inputs:2,outputs:1})}),Gi=Object.freeze({type:"native",body:Object.freeze([66,255,255,255,255,255,255,255,255,126]),lengths:Object.freeze({inputs:2,outputs:1})}),ba=Object.freeze({type:"native",body:Object.freeze([125]),lengths:Object.freeze({inputs:2,outputs:1})}),dn=Object.freeze({type:"native",body:Object.freeze([146]),lengths:Object.freeze({inputs:2,outputs:1})}),mn=Object.freeze({type:"native",body:Object.freeze([149]),lengths:Object.freeze({inputs:2,outputs:1})}),gn=Object.freeze({type:"native",body:Object.freeze([148]),lengths:Object.freeze({inputs:2,outputs:1})}),Oa=Object.freeze({type:"native",body:Object.freeze([67,0,0,128,191,148]),lengths:Object.freeze({inputs:2,outputs:1})}),xn=Object.freeze({type:"native",body:Object.freeze([140]),lengths:Object.freeze({inputs:2,outputs:1})}),Is=Object.freeze({type:"native",body:Object.freeze([106]),lengths:Object.freeze({inputs:2,outputs:1})}),zs=Object.freeze({type:"native",body:Object.freeze([110]),lengths:Object.freeze({inputs:2,outputs:1})}),Ns=Object.freeze({type:"native",body:Object.freeze([108]),lengths:Object.freeze({inputs:2,outputs:1})}),js=Object.freeze({type:"native",body:Object.freeze([107]),lengths:Object.freeze({inputs:2,outputs:1})}),As=Object.freeze({type:"native",body:Object.freeze([106]),lengths:Object.freeze({inputs:2,outputs:1})}),Ps=Object.freeze({type:"native",body:Object.freeze([109]),lengths:Object.freeze({inputs:2,outputs:1})}),Rs=Object.freeze({type:"native",body:Object.freeze([108]),lengths:Object.freeze({inputs:2,outputs:1})}),Cs=Object.freeze({type:"native",body:Object.freeze([65,1,0,0,0,108]),lengths:Object.freeze({inputs:1,outputs:1})}),Ss=Object.freeze({type:"native",body:Object.freeze([107]),lengths:Object.freeze({inputs:2,outputs:1})}),_a=Object.freeze({type:"native",body:Object.freeze([130]),lengths:Object.freeze({inputs:2,outputs:1})}),da=Object.freeze({type:"native",body:Object.freeze([129]),lengths:Object.freeze({inputs:2,outputs:1})}),Ds=Object.freeze({type:"native",body:Object.freeze([112]),lengths:Object.freeze({inputs:2,outputs:1})}),Fs=Object.freeze({type:"native",body:Object.freeze([111]),lengths:Object.freeze({inputs:2,outputs:1})}),ma=Object.freeze({type:"native",body:Object.freeze([86]),lengths:Object.freeze({inputs:2,outputs:1})}),ga=Object.freeze({type:"native",body:Object.freeze([85]),lengths:Object.freeze({inputs:2,outputs:1})}),xa=Object.freeze({type:"native",body:Object.freeze([100]),lengths:Object.freeze({inputs:2,outputs:1})}),ks=Object.freeze({type:"native",body:Object.freeze([75]),lengths:Object.freeze({inputs:2,outputs:1})}),Us=Object.freeze({type:"native",body:Object.freeze([74]),lengths:Object.freeze({inputs:2,outputs:1})}),Ta=Object.freeze({type:"native",body:Object.freeze([94]),lengths:Object.freeze({inputs:2,outputs:1})}),ya=Object.freeze({type:"native",body:Object.freeze([84]),lengths:Object.freeze({inputs:2,outputs:1})}),Ia=Object.freeze({type:"native",body:Object.freeze([83]),lengths:Object.freeze({inputs:2,outputs:1})}),za=Object.freeze({type:"native",body:Object.freeze([99]),lengths:Object.freeze({inputs:2,outputs:1})}),Ls=Object.freeze({type:"native",body:Object.freeze([73]),lengths:Object.freeze({inputs:2,outputs:1})}),vs=Object.freeze({type:"native",body:Object.freeze([72]),lengths:Object.freeze({inputs:2,outputs:1})}),Na=Object.freeze({type:"native",body:Object.freeze([93]),lengths:Object.freeze({inputs:2,outputs:1})}),ja=Object.freeze({type:"native",body:Object.freeze([87]),lengths:Object.freeze({inputs:2,outputs:1})}),Aa=Object.freeze({type:"native",body:Object.freeze([88]),lengths:Object.freeze({inputs:2,outputs:1})}),Pa=Object.freeze({type:"native",body:Object.freeze([101]),lengths:Object.freeze({inputs:2,outputs:1})}),Vs=Object.freeze({type:"native",body:Object.freeze([76]),lengths:Object.freeze({inputs:2,outputs:1})}),Ys=Object.freeze({type:"native",body:Object.freeze([77]),lengths:Object.freeze({inputs:2,outputs:1})}),Ra=Object.freeze({type:"native",body:Object.freeze([95]),lengths:Object.freeze({inputs:2,outputs:1})}),Ca=Object.freeze({type:"native",body:Object.freeze([89]),lengths:Object.freeze({inputs:2,outputs:1})}),Sa=Object.freeze({type:"native",body:Object.freeze([90]),lengths:Object.freeze({inputs:2,outputs:1})}),Da=Object.freeze({type:"native",body:Object.freeze([102]),lengths:Object.freeze({inputs:2,outputs:1})}),ws=Object.freeze({type:"native",body:Object.freeze([78]),lengths:Object.freeze({inputs:2,outputs:1})}),Bs=Object.freeze({type:"native",body:Object.freeze([79]),lengths:Object.freeze({inputs:2,outputs:1})}),Fa=Object.freeze({type:"native",body:Object.freeze([96]),lengths:Object.freeze({inputs:2,outputs:1})}),ka=Object.freeze({type:"native",body:Object.freeze([81]),lengths:Object.freeze({inputs:2,outputs:1})}),Ua=Object.freeze({type:"native",body:Object.freeze([81]),lengths:Object.freeze({inputs:2,outputs:1})}),La=Object.freeze({type:"native",body:Object.freeze([97]),lengths:Object.freeze({inputs:2,outputs:1})}),Ms=Object.freeze({type:"native",body:Object.freeze([70]),lengths:Object.freeze({inputs:2,outputs:1})}),Ks=Object.freeze({type:"native",body:Object.freeze([70]),lengths:Object.freeze({inputs:2,outputs:1})}),va=Object.freeze({type:"native",body:Object.freeze([91]),lengths:Object.freeze({inputs:2,outputs:1})}),Va=Object.freeze({type:"native",body:Object.freeze([82]),lengths:Object.freeze({inputs:2,outputs:1})}),Ya=Object.freeze({type:"native",body:Object.freeze([82]),lengths:Object.freeze({inputs:2,outputs:1})}),wa=Object.freeze({type:"native",body:Object.freeze([98]),lengths:Object.freeze({inputs:2,outputs:1})}),Gs=Object.freeze({type:"native",body:Object.freeze([71]),lengths:Object.freeze({inputs:2,outputs:1})}),Hs=Object.freeze({type:"native",body:Object.freeze([71]),lengths:Object.freeze({inputs:2,outputs:1})}),Ba=Object.freeze({type:"native",body:Object.freeze([92]),lengths:Object.freeze({inputs:2,outputs:1})}),Ma=Object.freeze({type:"native",body:Object.freeze([113]),lengths:Object.freeze({inputs:2,outputs:1})}),Ka=Object.freeze({type:"native",body:Object.freeze([114]),lengths:Object.freeze({inputs:2,outputs:1})}),Ga=Object.freeze({type:"native",body:Object.freeze([115]),lengths:Object.freeze({inputs:2,outputs:1})}),Ha=Object.freeze({type:"native",body:Object.freeze([69]),lengths:Object.freeze({inputs:1,outputs:1})}),Tn=Object.freeze({type:"native",body:Object.freeze([167]),lengths:Object.freeze({inputs:1,outputs:1})}),yn=Object.freeze({type:"native",body:Object.freeze([167]),lengths:Object.freeze({inputs:1,outputs:1})}),Xa=Object.freeze({type:"native",body:Object.freeze([170]),lengths:Object.freeze({inputs:1,outputs:1})}),$a=Object.freeze({type:"native",body:Object.freeze([171]),lengths:Object.freeze({inputs:1,outputs:1})}),Ja=Object.freeze({type:"native",body:Object.freeze([168]),lengths:Object.freeze({inputs:1,outputs:1})}),Wa=Object.freeze({type:"native",body:Object.freeze([169]),lengths:Object.freeze({inputs:1,outputs:1})}),In=Object.freeze({type:"native",body:Object.freeze([]),lengths:Object.freeze({inputs:1,outputs:1})}),Xt=Object.freeze({type:"native",body:Object.freeze([193]),lengths:Object.freeze({inputs:1,outputs:1})}),$t=Object.freeze({type:"native",body:Object.freeze([192]),lengths:Object.freeze({inputs:1,outputs:1})}),Za=Object.freeze({type:"native",body:Object.freeze([]),lengths:Object.freeze({inputs:1,outputs:1})}),qa=Object.freeze({type:"native",body:Object.freeze([]),lengths:Object.freeze({inputs:1,outputs:1})}),Qa=Object.freeze({type:"native",body:Object.freeze([176]),lengths:Object.freeze({inputs:1,outputs:1})}),er=Object.freeze({type:"native",body:Object.freeze([177]),lengths:Object.freeze({inputs:1,outputs:1})}),tr=Object.freeze({type:"native",body:Object.freeze([175]),lengths:Object.freeze({inputs:1,outputs:1})}),sr=Object.freeze({type:"native",body:Object.freeze([174]),lengths:Object.freeze({inputs:1,outputs:1})}),nr=Object.freeze({type:"native",body:Object.freeze([196]),lengths:Object.freeze({inputs:1,outputs:1})}),or=Object.freeze({type:"native",body:Object.freeze([196]),lengths:Object.freeze({inputs:1,outputs:1})}),cr=Object.freeze({type:"native",body:Object.freeze([196]),lengths:Object.freeze({inputs:1,outputs:1})}),ar=Object.freeze({type:"native",body:Object.freeze([196]),lengths:Object.freeze({inputs:1,outputs:1})}),zn=Object.freeze({type:"native",body:Object.freeze([195]),lengths:Object.freeze({inputs:1,outputs:1})}),Nn=Object.freeze({type:"native",body:Object.freeze([195]),lengths:Object.freeze({inputs:1,outputs:1})}),jn=Object.freeze({type:"native",body:Object.freeze([194]),lengths:Object.freeze({inputs:1,outputs:1})}),An=Object.freeze({type:"native",body:Object.freeze([194]),lengths:Object.freeze({inputs:1,outputs:1})}),rr=Object.freeze({type:"native",body:Object.freeze([185]),lengths:Object.freeze({inputs:1,outputs:1})}),ir=Object.freeze({type:"native",body:Object.freeze([186]),lengths:Object.freeze({inputs:1,outputs:1})}),Xs=Object.freeze({type:"native",body:Object.freeze([183]),lengths:Object.freeze({inputs:1,outputs:1})}),$s=Object.freeze({type:"native",body:Object.freeze([184]),lengths:Object.freeze({inputs:1,outputs:1})}),pr=Object.freeze({type:"native",body:Object.freeze([187]),lengths:Object.freeze({inputs:1,outputs:1})}),lr=Object.freeze({type:"native",body:Object.freeze([180]),lengths:Object.freeze({inputs:1,outputs:1})}),ur=Object.freeze({type:"native",body:Object.freeze([181]),lengths:Object.freeze({inputs:1,outputs:1})}),Js=Object.freeze({type:"native",body:Object.freeze([178]),lengths:Object.freeze({inputs:1,outputs:1})}),Ws=Object.freeze({type:"native",body:Object.freeze([179]),lengths:Object.freeze({inputs:1,outputs:1})}),fr=Object.freeze({type:"native",body:Object.freeze([182]),lengths:Object.freeze({inputs:1,outputs:1})}),Pt=Object.freeze(Object.assign({"Flogram./":mn,"Flogram.*":gn,"Flogram.+":dn,"Flogram.-":xn},{"Flogram.fp64.div":na,"Flogram.fp64.mul":oa,"Flogram.fp64.add":sa,"Flogram.fp64.sub":aa,"Flogram.fp64.neg":ca,"Flogram.fp64.gt":xa,"Flogram.fp64.lt":za,"Flogram.fp64.le":Pa,"Flogram.fp64.ge":Da,"Flogram.fp64.ne":wa,"Flogram.fp64.eq":La,"Flogram.fp64.toi32":Xa,"Flogram.fp64.tou32":$a,"Flogram.fp64.tou64":er,"Flogram.fp64.toi64":Qa,"Flogram.fp64.tofp32":fr},{"Flogram.u64.add":ra,"Flogram.u64.sub":ua,"Flogram.u64.mul":pa,"Flogram.u64.div":ia,"Flogram.u64.rem":_a,"Flogram.u64.gt":ma,"Flogram.u64.lt":ya,"Flogram.u64.le":Aa,"Flogram.u64.ge":Sa,"Flogram.u64.ne":Ya,"Flogram.u64.eq":Ua,"Flogram.u64.toi32":yn,"Flogram.u64.tou32":yn,"Flogram.u64.toi64":Za,"Flogram.u64.tofp32":ur,"Flogram.u64.tofp64":ir},{"Flogram.i64.add":fa,"Flogram.i64.sub":ba,"Flogram.i64.neg":la,"Flogram.i64.mul":ha,"Flogram.i64.div":Ea,"Flogram.i64.rem":da,"Flogram.i64.gt":ga,"Flogram.i64.lt":Ia,"Flogram.i64.le":ja,"Flogram.i64.ge":Ca,"Flogram.i64.ne":Va,"Flogram.i64.eq":ka,"Flogram.i64.toi32":Tn,"Flogram.i64.tou32":Tn,"Flogram.i64.tou64":qa,"Flogram.i64.tofp32":lr,"Flogram.i64.tofp64":rr},{"Flogram.fp32.div":mn,"Flogram.fp32.mul":gn,"Flogram.fp32.add":dn,"Flogram.fp32.sub":xn,"Flogram.fp32.neg":Oa,"Flogram.fp32.gt":Ta,"Flogram.fp32.lt":Na,"Flogram.fp32.le":Ra,"Flogram.fp32.ge":Fa,"Flogram.fp32.ne":Ba,"Flogram.fp32.eq":va,"Flogram.fp32.toi32":Ja,"Flogram.fp32.tou32":Wa,"Flogram.fp32.tou64":tr,"Flogram.fp32.toi64":sr,"Flogram.fp32.tofp64":pr},{"Flogram.u32.add":Is,"Flogram.u32.sub":js,"Flogram.u32.mul":Ns,"Flogram.u32.div":zs,"Flogram.u32.rem":Ds,"Flogram.u32.gt":ks,"Flogram.u32.lt":Ls,"Flogram.u32.le":Ys,"Flogram.u32.ge":Bs,"Flogram.u32.ne":Hs,"Flogram.u32.eq":Ks,"Flogram.u32.toi32":In,"Flogram.u32.toi64":cr,"Flogram.u32.tou64":ar,"Flogram.u32.tofp32":Ws,"Flogram.u32.tofp64":$s},{"Flogram.i32.add":As,"Flogram.i32.sub":Ss,"Flogram.i32.neg":Cs,"Flogram.i32.mul":Rs,"Flogram.i32.div":Ps,"Flogram.i32.rem":Fs,"Flogram.i32.gt":Us,"Flogram.i32.lt":vs,"Flogram.i32.le":Vs,"Flogram.i32.ge":ws,"Flogram.i32.ne":Gs,"Flogram.i32.eq":Ms,"Flogram.i32.toi64":nr,"Flogram.i32.tou64":or,"Flogram.i32.tou32":In,"Flogram.i32.tofp32":Js,"Flogram.i32.tofp64":Xs},{"Flogram.i16.add":As,"Flogram.i16.sub":Ss,"Flogram.i16.neg":Cs,"Flogram.i16.mul":Rs,"Flogram.i16.div":Ps,"Flogram.i16.rem":Fs,"Flogram.i16.gt":Us,"Flogram.i16.lt":vs,"Flogram.i16.le":Vs,"Flogram.i16.ge":ws,"Flogram.i16.ne":Gs,"Flogram.i16.eq":Ms,"Flogram.i16.toi32":Xt,"Flogram.i16.tou32":Xt,"Flogram.i16.toi64":zn,"Flogram.i16.tou64":Nn,"Flogram.i16.tofp32":Js,"Flogram.i16.tofp64":Xs},{"Flogram.u16.add":Is,"Flogram.u16.sub":js,"Flogram.u16.mul":Ns,"Flogram.u16.div":zs,"Flogram.u16.rem":Ds,"Flogram.u16.gt":ks,"Flogram.u16.lt":Ls,"Flogram.u16.le":Ys,"Flogram.u16.ge":Bs,"Flogram.u16.ne":Hs,"Flogram.u16.eq":Ks,"Flogram.u16.toi32":Xt,"Flogram.u16.tou32":Xt,"Flogram.u16.toi64":zn,"Flogram.u16.tou64":Nn,"Flogram.u16.tofp32":Ws,"Flogram.u16.tofp64":$s},{"Flogram.i8.add":As,"Flogram.i8.sub":Ss,"Flogram.i16.neg":Cs,"Flogram.i8.mul":Rs,"Flogram.i8.div":Ps,"Flogram.i8.rem":Fs,"Flogram.i8.gt":Us,"Flogram.i8.lt":vs,"Flogram.i8.le":Vs,"Flogram.i8.ge":ws,"Flogram.i8.ne":Gs,"Flogram.i8.eq":Ms,"Flogram.i8.toi32":$t,"Flogram.i8.tou32":$t,"Flogram.i8.toi64":jn,"Flogram.i8.tou64":An,"Flogram.i8.tofp32":Js,"Flogram.i8.tofp64":Xs},{"Flogram.u8.add":Is,"Flogram.u8.sub":js,"Flogram.u8.mul":Ns,"Flogram.u8.div":zs,"Flogram.u8.rem":Ds,"Flogram.u8.gt":ks,"Flogram.u8.lt":Ls,"Flogram.u8.le":Ys,"Flogram.u8.ge":Bs,"Flogram.u8.ne":Hs,"Flogram.u8.eq":Ks,"Flogram.u8.toi32":$t,"Flogram.u8.tou32":$t,"Flogram.u8.toi64":jn,"Flogram.u8.tou64":An,"Flogram.u8.tofp32":Ws,"Flogram.u8.tofp64":$s},{"Flogram.bool.and":Ma,"Flogram.bool.or":Ka,"Flogram.bool.xor":Ga,"Flogram.bool.not":Ha}));var{LEB128_ENCODE:Ke}=_t,$i=new Int8Array(1),Ji=new Uint8Array(1),Er=s=>{let t=[],c=!0;for(;c;){let E=s&127;s>>=7,s===0&&!(E&64)||s===-1&&E&64?c=!1:E|=128,t.push(E)}return new Uint8Array(t)},hr=s=>{let t=[],c=!0;for(;c;){let E=s&127;s>>=7,s===0?c=!1:E|=128,t.push(E)}return new Uint8Array(t)},br=s=>{let t=[];for(;s>=128;)t.push(s&127|128),s>>>=7;return t.push(s),new Uint8Array(t)},Or=128,_r=127,Pn=64,dr=s=>{s=s<<16>>16;let t=[];for(;;){let c=s&_r;s=s>>7;let E=s===0,N=(c&Pn)===0,e=E&&N,v=s===-1,G=(c&Pn)!==0;if(e||v&&G){t.push(c);break}c=c|Or,t.push(c)}return t};var mr=s=>{let t=new Float32Array(1);return t[0]=parseFloat(s),new Uint8Array(t.buffer)},Rn=s=>{let t=[],c=!0;for(;c;){let E=s&127;s>>=7,s===0&&!(E&64)||s===-1&&E&64?c=!1:E|=128,t.push(E)}return new Uint8Array(t)},gr=s=>Ke(s),xr=s=>{let t=new Float64Array(1);return t[0]=s,new Uint8Array(t.buffer)},Tr=s=>{let t=[];for(;s>=128;)t.push(s&127|128),s>>>=7;return t.push(s),new Uint8Array(t)},yr=s=>{let t=[],c=!0;for(;c;){let E=s&127;s>>=7,s===0&&!(E&64)||s===-1&&E&64?c=!1:E|=128,t.push(E)}return new Uint8Array(t)},Ir=s=>{let t=new Uint8Array(1);return t[0]=s==="TRUE"?1:s==="FALSE"?0:s,t},zr=s=>{let t=s.charCodeAt(0);return Ke(t)},Cn=()=>{let s=new ArrayBuffer(4);return new Float32Array(s)[0]=-0,[...new Uint8Array(s)]},Nr=Object.freeze({type:"native",identity:127,opcode:65,encode:Rn,link:Object.freeze({load:Object.freeze({opcode:40,align:2,offset:0,size:4}),store:Object.freeze({opcode:54,align:2,offset:0,size:4})})}),jr=Object.freeze({type:"native",identity:127,opcode:65,none:Ke(-1),encode:zr,link:Object.freeze({load:Object.freeze({opcode:44,align:2,offset:0,size:4}),store:Object.freeze({opcode:54,align:2,offset:0,size:4})})}),Ar=Object.freeze({type:"native",identity:127,opcode:65,none:Ke(-1),encode:Ir,link:Object.freeze({load:Object.freeze({opcode:40,align:2,offset:0,size:4}),store:Object.freeze({opcode:54,align:2,offset:0,size:4}),values:{TRUE:1,FALSE:0}})}),Pr=Object.freeze({type:"native",identity:124,opcode:68,none:Cn(),encode:xr,link:Object.freeze({load:Object.freeze({opcode:43,align:3,offset:0,size:8}),store:Object.freeze({opcode:57,align:3,offset:0,size:8})})}),Rr=Object.freeze({type:"native",identity:126,opcode:66,none:Ke(-1),encode:Tr,link:Object.freeze({load:Object.freeze({opcode:43,align:3,offset:0,size:8}),store:Object.freeze({opcode:57,align:3,offset:0,size:8})})}),Cr=Object.freeze({type:"native",identity:126,opcode:66,none:Ke(-9223372036854776e3),encode:yr,link:Object.freeze({load:Object.freeze({opcode:43,align:3,offset:0,size:8}),store:Object.freeze({opcode:57,align:3,offset:0,size:8})})}),Sr=Object.freeze({type:"native",identity:125,opcode:67,none:Cn(),encode:mr,link:Object.freeze({load:Object.freeze({opcode:42,align:2,offset:0,size:4}),store:Object.freeze({opcode:56,align:2,offset:0,size:4})})}),Dr=Object.freeze({type:"native",identity:127,opcode:65,none:Ke(-1),encode:gr,link:Object.freeze({load:Object.freeze({opcode:40,align:2,offset:0,size:4}),store:Object.freeze({opcode:54,align:2,offset:0,size:4})})}),Fr=Object.freeze({type:"native",identity:127,opcode:65,none:Ke(-2147483648),encode:Rn,link:Object.freeze({load:Object.freeze({opcode:40,align:2,offset:0,size:4}),store:Object.freeze({opcode:54,align:2,offset:0,size:4})})}),kr=Object.freeze({type:"native",identity:127,opcode:65,none:Ke(-32768),encode:dr,link:Object.freeze({load:Object.freeze({opcode:40,align:2,offset:0,size:4}),store:Object.freeze({opcode:54,align:2,offset:0,size:4})})}),Ur=Object.freeze({type:"native",identity:127,opcode:65,encode:br,none:Ke(-1),link:Object.freeze({load:Object.freeze({opcode:40,align:2,offset:0,size:4}),store:Object.freeze({opcode:54,align:2,offset:0,size:4})})}),Lr=Object.freeze({type:"native",identity:127,opcode:65,none:Ke(-128),encode:Er,decode:s=>new Int8Array([s])[0],link:Object.freeze({load:Object.freeze({opcode:44,align:0,offset:0,size:4}),store:Object.freeze({opcode:58,align:0,offset:0,size:4})})}),vr=Object.freeze({type:"native",identity:127,opcode:65,none:Ke(-1),encode:hr,link:Object.freeze({load:Object.freeze({opcode:43,align:0,offset:0,size:4}),store:Object.freeze({opcode:58,align:0,offset:0,size:4})})}),pt=Object.freeze({"Flogram.String":Nr,"Flogram.Char":jr,"Flogram.Bool":Ar,"Flogram.FP64":Pr,"Flogram.U64":Rr,"Flogram.I64":Cr,"Flogram.FP32":Sr,"Flogram.U32":Dr,"Flogram.I32":Fr,"Flogram.I16":kr,"Flogram.U16":Ur,"Flogram.I8":Lr,"Flogram.U8":vr});var Vr=Object.freeze(["FP64","U64","I64","FP32","U32","I32","U16","I16","U8","I8","Bool","Char","Array","String","Link","Maybe"]),Rt=Vr;var{TYPES_ASSIGN:Yr,TYPES_DRAW:wr,TYPES_ARRAY:W,TYPES_ARRAY_ASSIGNMENT:Br,TYPES_BRANCH_MATCH:Mr,TYPES_BRANCH_DEFAULT:Kr,TYPES_CONDITION:Zs,TYPES_LOOP:Jt,TYPES_WHILE:Gr,TYPES_FOREACH:Hr,TYPES_DATA:Wt,TYPES_GENERICS:ap,TYPES_ENUMERATION:et,TYPES_EXPRESSION:dt,TYPES_INSTANCE:rp,TYPES_LINK:ct,TYPES_LOCAL:je,TYPES_CONCAT:Xr,TYPES_OBJECT:he,TYPES_PROCEDURE:ip,TYPES_RETURN:qs,TYPES_SELECT:at,TYPES_MEMBER:Ct,TYPES_STORE:$r,TYPES_BREAK:Jr,TYPES_LITERAL:rt,TYPES_ARRAY_ACCESS:Zt,TYPES_LINK_TO:qt,TYPES_VALUE_AT:St,TYPES_SELF:pp,TYPES_DROP:Sn,TYPES_MAYBE:Dt,TYPES_MOVE:Wr,TYPES_NATIVE:Te,TYPES_STRING:fe,TYPES_FREE:Zr,TYPES_BRANCH:Dn,TYPES_CONTINUE:Fn,TYPES_DEFAULT_BLOCK:kn,TYPES_BLOCK_END:ft,TYPES_STATEMENT:Un,TYPES_DESTRUCTOR:Ln,TYPES_SIZE:vn,TYPES_WHILE_CONDITION:Vn,TYPES_FOREACH_CONDITION:Yn,TYPES_FOREACH_END:wn}=Mt,Ft=2,Qt=3,es=12,kt=13,te=16,qe=26,O=65,Bn=71,qr=113,Qr=114,Qs=70,Pe=32,Ut=33,H=35,Ae=36,ei=15,en=11,Mn=4,ti=5,tt=64,mt=127,Ge=108,si=109,ee=106,ni=107,Ye=54,gt=40,Ie=0,ze=2,Ue=0,oi=1,Kn=2,Gn=3,ci=4,ai=5,He=6,ri=999999,Hn=888888,ii=777777,U=0,we=1,pi=4,Lt=8,Xn=8,$n="Flogram.draw",ts=new Set(["==","!=",">",">=","<","<=","!","&","|"]),{LEB128_ENCODE:g}=_t,tn,R=(s,t)=>`${t}.${s}`,Jn=(s,t,c)=>{let E=c.get(s);if(E&&E.length===1)return E[0];if(E&&E.length>1)return E[0];throw console.log(s),console.log(c),Error("No Callees were found")};function ss(s,t,c,E){s?.description?.inputs.length>0?tn=s.description.inputs[0].data.name:s?.description?.outputs.length>0&&(tn=s.description.outputs[0].data.name);let N=o=>{let a=nt(o.collection);a.length,console.log(o),console.log(a)},e=[],v=(o=U)=>{e.push(O,0),e.push(te,Ue),e.push(Ae,o)},G=()=>{e.push(H,U),e.push(H,we),e.push(te,Gn),e.push(H,we),e.push(H,U),e.push(te,Gn)},de=()=>{e.push(te,ci),e.push(Ae,we),e.push(Ae,U)},Re=()=>{e.push(te,ai),e.push(Ae,we),e.push(Ae,U)},me=()=>{e.push(te,Kn)},{description:Qe}=s,{inputs:$e,locals:Et,statements:Vt}=Qe,be=new Map,Z=new Map;{let o=0,a=r=>{for(let p of r){let{name:_,data:n}=p;switch(be.set(_,o),Z.set(_,p),n.type){case Dt:case Wt:{let{name:i,path:f}=n,m=R(i,f);switch(i){case fe:{o=o+2|0;break}default:{let x=t.get(m);switch(x.type){case Te:{o=o+1|0;break}case et:{o=o+1|0;break}case he:{let{length:Q}=x;o=o+2|0;break}}break}}break}case W:{o=o+2|0;break}case ct:{n.name===fe||n.name===W?o=o+2|0:o=o+1|0;break}}}};a($e),a(Et)}let Ce=0,Se=[];for(let o of Et){let{data:a}=o,r=()=>{Se.push(1,mt),Ce=Ce+1|0},p=()=>{Se.push(1,mt),Ce=Ce+1|0,Se.push(1,mt),Ce=Ce+1|0},_=()=>{Se.push(1,mt),Ce=Ce+1|0},n=f=>{let{identity:m}=f;Se.push(1,m),Ce=Ce+1|0},i=f=>{let{indivisibles:m}=f,{mapTrail:x}=m;for(let Q of x.values()){let{data:pe}=Q;if(pe.type===ct){pe.name===W||pe.name===fe?p():r();continue}if(pe.type===W){p();continue}let{name:le,path:ne}=pe,F=R(le,ne),b=t.get(F);switch(b.type){case Te:{n(b);break}case et:{_();break}}}};switch(a.type){case W:{p();break}case ct:{a.name===W||a.name===fe?p():r();break}case Dt:case Wt:{let{name:f,path:m}=a;switch(f){case fe:{p();break}default:{let x=R(f,m),Q=t.get(x);switch(Q.type){case Te:{n(Q);break}case et:{_();break}case he:{p();break}}break}}break}}}((o,a)=>{for(let[r,p]of o)if(p.type==a){Se.push(1,mt),Ce=Ce+1|0;break}})(t,he);let is=g(Ce);e.push(...is,...Se);let Be=o=>{if(typeof o!==he)return o;switch(o.type){case je:return o.name;case qt:return Be(o.value);case St:return Be(o.link);case Ct:return`${o.type}_${o.trail.join("_")}`;case Zt:return o.array.name}return null},nt=o=>{switch(o.type){case rt:return o;case je:return Z.get(o.name)?.data;case St:return nt(o.link);case qt:return nt(o.value);case vn:{if(input.value.type===je)return{name:"I32",path:"Flogram",type:"data"};break}case Zt:return Z.get(Be(o));case at:{let{value:a,trail:r}=JSON.parse(JSON.stringify(o)),{name:p}=a,_=Z.get(p||Be(a)),{data:n}=_,i=R(n.name,n.path),f=t.get(i),{indivisibles:m}=f,x=JSON.parse(JSON.stringify(r)),Q=f;for(;x.length>0;){let pe=x.shift();if(x.length>0){let le=Q.members.get(pe),ne=R(le.name,le.path);Q=t.get(ne);continue}Q=Q.members.get(pe)}return Q}}},$=(o,a=qs)=>{let r=0,p=[],_=(F,b)=>{let k={type:"call",key:F,inputs:b};p.unshift(k)},n=F=>{let b={type:"value",value:F};p.unshift(b)},i=F=>{let b={type:Ct,member:F};p.unshift(b)},f=(F,b,k,Y)=>{let V={key:null,stop:!1},z;if(F&&Rt.includes(F.data.name)){let{data:Oe}=F,{name:T}=Oe;z=R(T.toLowerCase()+"."+Me(k),b),tn=T}else if(F){let{data:Oe}=F,{name:T,path:re}=Oe,d=R(T,re),l=t.get(d),{indivisibles:I}=l,{mapTrail:P}=I,j=P.size-1;for(let[C,D]of P){p.unshift({type:"compare",currentIndex:j,name:k}),z=R(D.data.name.toLowerCase()+"."+Me(k),D.data.path);let y=Y.map(S=>({type:at,value:{type:je,name:S.name},trail:[D.trail]}));_(z,y);var w=y.length-1|0;for(let S=w;S>=0;S=S-1|0){let B=y[S];n(B)}j--}V.stop=!0}return V.key=z,V},m=F=>{let{inputs:b}=F,k=b.find(Y=>Y.type==dt);if(ts.has(F.name))return"Bool";if(k){let Y=b.map(z=>{if(z.type===je)return Z.get(z.name);if(z.type===rt)return{data:z};if(z.type===dt)return{data:{name:m(z)}}}),V=E.find(z=>z.description&&Array.isArray(z.description.inputs)?z.description.inputs.length!==Y.length?!1:z.description.inputs.every((w,Oe)=>w.data.name===Y[Oe].data.name):!1);return V?ts.has(V.name)?V.description.inputs[0].data.name:V.description.outputs[0].data.name:"unknown"}else{let Y=b.map(z=>({data:nt(z)})),V=E.find(z=>z.description&&Array.isArray(z.description.inputs)?z.description.inputs.length!==Y.length?!1:z.description.inputs.every((w,Oe)=>w.data.name===Y[Oe].data.name):!1);return V?ts.has(V.name)?V.description.inputs[0].data.name:V.description.outputs[0].data.name:"unknown"}},x=F=>{let{inputs:b,name:k,path:Y}=F,V=R(k,Y),z=[Y],w;if(typeof k===he){let T=k[0];if(w=Z.get(T),w){z.push(w.data.name);for(let d=1;d<=k.length-2;d++)T=k[d],w=Z.get(T),w&&z.push(w.data.name)}let re=k.length-1|0;V=R(k[re],z.join("."))}if(Y==="Flogram"&&k!==wr){let T=b.find(l=>l.type===dt),re=b.find(l=>l.type===rt),d=b.map(l=>Z.get(l.name)).find(Boolean);if(d){let l=f(d,Y,k,b);if(V=l.key,l.stop)return}else if(re)V=R(`${re.name.toLowerCase()}.${Me(k)}`,Y);else if(T)V=R(`${m(T).toLowerCase()}.${Me(k)}`,Y);else{let l=E.find(I=>I.name===F.name&&I.path===F.path&&I.description.inputs.length===F.inputs.length);V=R(`${ts.has(l.name)?l.description.inputs[0]?.data.name.toLowerCase():l.description.outputs[0]?.data.name.toLowerCase()}.${Me(l.name)}`,Y)}}if(_(V,b),typeof k===he){let T=Jn(V,b,c);if(T){let{procedure:re}=T,{description:d}=re,{self:l}=d,I=Z.get(k[0]),P=R(I.data.name,I.data.path),j=t.get(P);if(j){let C=be.get(k[0]),{indivisibles:D,members:y}=j,{mapTrail:S}=D;for(let B=l.length-1|0;B>=0;B--){let J=l[B];if(J.type===Ct){let L=J.trail.join(".");if(S.get(L)){let{address:oe}=S.get(L);i({index:C,address:oe})}else{let oe=JSON.parse(JSON.stringify(J.trail)),se=j;for(;oe.length>0;){let Ne=oe.shift();if(oe.length>0){let bt=se.members.get(Ne),jt=R(bt.name,bt.path);se=t.get(jt);continue}se=se.members.get(Ne)}let ae=R(se.name,se.path),xe=t.get(ae),{indivisibles:Ze}=xe,{mapIndex:ue,mapTrail:ve}=Ze,ke=ue.get(0),_e=`${L}.${ke.trail}`,{address:ie}=S.get(_e),Ve={index:C,address:ie-8};i(Ve)}}}}}}if(V!==$n){var Oe=b.length-1|0;for(let T=Oe;T>=0;T=T-1|0){let re=b[T];n(re)}}},Q=F=>{let{key:b,inputs:k}=F;if(b===$n){for(let z of k){let w=nt(z);z.type===at?w?.name===fe?(e.push(O,...g(Hn)),e.push(te,He),$(z),e.push(Ae,U),e.push(gt,ze,Ie),e.push(te,He),e.push(H,U),e.push(gt,ze,Ie),e.push(te,He)):($(z),e.push(te,He)):w?.name===fe?(e.push(O,...g(Hn)),e.push(te,He),$(z),e.push(te,He),e.push(te,He)):w?.name===W||w?.layout===W?(e.push(O,...g(ri)),e.push(te,He),$(z),e.push(te,He),e.push(te,He)):($(z),e.push(te,He)),z.type===at&&(e.push(qe),(w?.name===fe||w?.type===W||w?.layout===W)&&e.push(qe))}e.push(O,...g(ii)),e.push(te,He),r=r-k.length|0;return}let Y=Jn(b,k,c);switch(Y.type){case Te:{let{body:z}=Y;e.push(...z);break}case"artificial":{let{index:z}=Y,w=g(z);e.push(te,...w);break}}let{lengths:V}=Y;r=r-V.inputs|0,r=r+V.outputs|0},pe=F=>{let{value:b}=F,k=d=>{let l=0,I=Be(d),P;if(d.type===at){let{value:j,trail:C}=JSON.parse(JSON.stringify(d)),{name:D}=j,y=Z.get(D),{data:S}=y,B=R(S.name,S.path),J=t.get(B),{indivisibles:L}=J,{mapTrail:oe}=L,se=C.join("."),ae=JSON.parse(JSON.stringify(C)),xe=J;for(;ae.length>0;){let ue=ae.shift();if(ae.length>0){let ve=xe.members.get(ue),ke=R(ve.name,ve.path);xe=t.get(ke);continue}xe=xe.members.get(ue)}let Ze=R(xe.name,xe.path);P=t.get(Ze)}else{let j=Z.get(I),{data:C}=j,{name:D,path:y,segment:S}=C,B=R(D,y);P=t.get(B)}if(P){switch(P.type){case Te:{pe({value:d});let{link:j}=P,{load:C}=j;e.push(C.opcode,C.align,C.offset),l=l+1|0;break}case he:{let j=0,C=()=>{},D=J=>{pe({value:d});let{link:L}=J,{load:oe}=L;e.push(oe.opcode,oe.align,oe.offset+j|0),l=l+1|0,j=j+oe.size|0},y=()=>{},{indivisibles:S}=P,{mapTrail:B}=S;for(let J of B.values()){if(J.type===ct){y();continue}let{data:L}=J,{name:oe,path:se}=L,ae=R(oe,se),xe=t.get(ae);switch(xe.type){case Te:{D(xe);break}case et:{C();break}}}break}}return l}},Y=(d,l)=>{let I=0,{literal:P,name:j,path:C,size:D}=d,y=D||P.length;d.length&&!D&&(y=parseInt(d.length,10));let S=R(j,C),B=t.get(S);function J(L){let oe=0,{literal:se,name:ae,path:xe,vSize:Ze}=L,ue=Ze||se.length;L.length&&!Ze&&(ue=parseInt(L.length,10));let ve=R(ae,xe),ke=t.get(ve);v(),(ke.type===he||ae===fe&&L.layout===W||L.contains===W)&&(e.push(O,...g(ue*4*2|0)),e.push(te,Ue),e.push(Ut,U),G());for(let _e=0;_e<ue;_e++){let ie=se[_e];if(ie)if(ie.name===fe&&L.layout===W||ie.layout===W&&ke.type!==he){let Ve=[];if(ie.layout===W){let Ne=ie.size||ie.literal.length;e.push(H,U),e.push(H,U),e.push(H,U),e.push(O,...g(_e)),e.push(O,...g(8)),e.push(Ge),e.push(ee),Ve.push(ie.literal),J(ie),e.push(H,U),e.push(Ye,ze,Ie),e.push(O,...g(4)),e.push(O,...g(_e)),e.push(O,...g(8)),e.push(Ge),e.push(ee),e.push(ee),e.push(O,Ne),e.push(Ye,ze,Ie),e.push(Ae,U)}else{let Ne=ie.size||ie.literal.length;for(let jt=0;jt<Ne;jt++)Ve.push({type:ie.type,path:ie.path,name:"I32",literal:ie.literal[jt].charCodeAt().toString()});let bt={type:rt,name:"I32",layout:W,path:ie.path,literal:Ve};e.push(H,U),e.push(H,U),e.push(H,U),e.push(O,...g(_e)),e.push(O,...g(8)),e.push(Ge),e.push(ee),J(bt),e.push(H,U),e.push(Ye,ze,Ie),e.push(O,...g(4)),e.push(O,...g(_e)),e.push(O,...g(8)),e.push(Ge),e.push(ee),e.push(ee),e.push(O,Ne),e.push(Ye,ze,Ie),e.push(Ae,U)}}else switch(ke.type){case Te:{let{link:Ve}=ke,{store:Ne}=Ve;e.push(O,...g(Ne.size)),e.push(te,Ue),!ie||ie.type===rt?e.push(ke.opcode,...ke.encode(ie?.literal||0)):$(ie),e.push(Ne.opcode,Ne.align,Ne.offset),me(),oe=3;break}case he:{e.push(H,U),e.push(H,U),e.push(O,...g(_e)),e.push(O,...g(8)),e.push(Ge),e.push(ee),$(ie),e.push(Ae,we),e.push(Ye,ze,Ie),e.push(Ae,U),e.push(H,U),e.push(O,...g(4)),e.push(O,...g(_e)),e.push(O,...g(8)),e.push(Ge),e.push(ee),e.push(ee),e.push(H,we),e.push(Ye,ze,Ie);break}}}}return J(d),l?y:(e.push(H,U),e.push(O,...g(y)),I=1,I)},V=(d,l,I=!0)=>{let P=t.get(l);v();let j=(y,S)=>{G(),Re(),e.push(H,U),e.push(H,U),e.push(H,U),de(),e.push(O,...g(S)),e.push(ee),e.push(H,U),e.push(Ye,ze,Ie),e.push(O,...g(S)),e.push(O,...g(4)),e.push(ee),e.push(ee),e.push(O,...g(y)),e.push(Ye,ze,Ie),e.push(Ae,U)},C=[];for(let[y,S]of P.members){if(!S)continue;let B=d.find(oe=>oe.name===y),J=R(S.name,S.path),L=t.get(J);if(S.type===W){e.push(O,...g(Lt)),e.push(te,Ue),e.push(qe),C.push({data:{keyName:y,keyData:S},literal:B});continue}switch(L.type){case Te:{let{link:oe}=L,{store:se}=oe;if(S.type===ct)G(),e.push(O,...g(4)),e.push(te,Ue),$(B.value),e.push(se.opcode,se.align,se.offset),de();else if(S.name===fe)e.push(O,...g(Lt)),e.push(te,Ue),e.push(qe),C.push({data:{keyName:y,keyData:S},literal:B});else{e.push(O,...g(se.size)),e.push(te,Ue);let ae=JSON.parse(JSON.stringify(B.value));ae.literal&&(ae.name!==S.name||ae.path!==S.path)&&(ae={...ae,name:S.name,path:S.path}),$(ae),e.push(se.opcode,se.align,se.offset)}me();break}case he:{e.push(O,...g(Lt)),e.push(te,Ue),e.push(qe),C.push({data:{keyName:y,keyData:S},literal:B});break}}}if(C.length>0){let y=C[0],{data:S,literal:B}=y,{keyName:J,keyData:L}=S,{type:oe,name:se,layout:ae,path:xe}=L,ue=(_e=>{let ie=P.indivisibles.mapTrail;if(ie.has(_e))return ie.get(_e).address;let Ve=Array.from(ie.entries()).filter(([Ne])=>Ne.startsWith(`${_e}.`));return Ve.length?(Ve.sort((Ne,bt)=>Ne[1].address-bt[1].address),Ve[0][1].address-8):null})(J),ve=R(se,xe),ke=t.get(ve);if(se===fe)G(),$(B.value),e.push(qe,qe),j(B.value.size||B.value.literal.length,ue),me();else if(oe===W||ae===W)if(B.value.type===je){let _e=be.get(B.value.name);G();let ie=w(L,_e);j(ie,ue),me()}else{G();let _e=Y(B.value,!0);j(_e,ue),me()}else if(ke.type===he){G();let _e=V(B.value.literal,ve,!1);j(_e,ue),me()}}let D=P.indivisibles.mapTrail.size+C.length;return I&&(e.push(H,U),e.push(O,...g(D))),D},z=(d,l)=>{let I=0,P=Z.get(l),j;if(P){let{data:D}=P,{name:y,path:S,segment:B}=D;j=R(y,S)}else{let D=y=>{if(y.type===rt)return R(y.name,y.path);if(y.type===dt)return D(y.inputs[0]);if(y.type===St)return D(y.link);if(y.type===qt)return D(y.value);if(y.type===je){let S=Z.get(y.name),{data:B}=S,{name:J,path:L,segment:oe}=B;return R(J,L)}else if(y.type===at){let S=t.get(D(y.value)),{indivisibles:B}=S,{mapTrail:J}=B,L=y.trail.join("."),{data:oe}=J.get(L),{name:se,path:ae}=oe;return R(se,ae)}};j=D(d)}let C=t.get(j);switch(C.type){case Te:{let{link:D}=C,{store:y}=D;e.push(O,...g(y.size)),e.push(te,Ue),e.push(Ae,U),e.push(H,U),$(d),e.push(y.opcode,y.align,y.offset),e.push(H,U),I=I+7|0;break}case he:{let D=0,y=()=>{},S=oe=>{$(d);let{link:se}=oe,{load:ae}=se;e.push(ae.opcode,ae.align,ae.offset+D|0),I=I+1|0,D=D+ae.size|0},B=()=>{},{indivisibles:J}=C,{mapTrail:L}=J;for(let oe of L.values()){if(oe.type===ct){B();continue}let{data:se}=oe,{name:ae,path:xe}=se,Ze=R(ae,xe),ue=t.get(Ze);switch(ue.type){case Te:{S(ue);break}case et:{y();break}}}break}}return I},w=(d,l=0)=>{let{name:I,path:P}=d,j=R(I,"Flogram"),C=t.get(j),{link:D}=C,{store:y,load:S}=D,B=Number(d.length);v();for(let J=0;J<B;J++){e.push(O,...g(y.size)),e.push(te,Ue);let L=l;T(L,L+1|0),e.push(O,...g(J)),e.push(O,S.size),e.push(Ge),e.push(ee),e.push(S.opcode,S.align,S.offset),e.push(y.opcode,y.align,y.offset),me()}return B},Oe=(d,l)=>{let I=t.get(l),{opcode:P}=I,j=I.encode(d);e.push(P,...j)},T=(d,l)=>{for(;d<l;)e.push(Pe,d),d=d+1|0};switch(b.type){case dt:{x(b);break}case"instance":{let{path:d,members:l}=b;var re=l.length-1|0;for(let I=re;I>=0;I=I-1|0){let P=l[I],{path:j,value:C}=P;n(C)}break}case Dt:{let{data:d}=b,{name:l,path:I}=d,P=R(l,I),j=t.get(P);b.layout==="NONE"?e.push(j.opcode,...j.none):$(b.value),r=r+1|0;break}case St:{let{link:d}=b,l=k(d);r=r+l|0;break}case qt:{let{value:d}=b,l=Be(d);if(Z.get(l)?.data.type===W){$({name:l,type:je});return}let P=z(d,l);r=r+P|0;break}case vn:{let{value:d}=b;switch(d.type){case je:{let l=be.get(d.name);T(l+1|0,l+2|0);break}}break}case Xr:{let{values:d}=b;v(we);for(let l of d){let I=nt(l),P=R(I.name,I.path);if(I.name===fe||I.type===W||I.layout===W)$(l,"assignment"),e.push(qe),e.push(qe);else{let j=t.get(P),{link:C}=j,{store:D}=C;e.push(O,...g(D.size)),e.push(te,Ue),$(l),e.push(D.opcode,D.align,D.offset)}me()}v(),e.push(H,we),e.push(H,U),e.push(H,we),e.push(ni),e.push(O,4),e.push(si),r=r+2|0;break}case rt:{let{literal:d,name:l,path:I}=b,P=R(l,I),j=t.get(P);if(b.layout===W){Y(b),r=r+2|0;return}else if(l===fe){let C=[];for(let y of d)C.push({type:rt,literal:y.charCodeAt(0).toString(),name:fe,path:"Flogram"});let D={...b,literal:C};Y(D),r=r+2|0;return}j&&j.type===he?(V(d,P),r=r+2|0):(j||(console.log(b),console.log("NO SHAPE FOUND")),Oe(d,P),r=r+1|0);break}case Zt:{let{array:d,index:l}=b,{name:I}=d,{name:P}=l,j=be.get(I),C=Z.get(I),D=R(C.data.name,C.data.path),y=t.get(D);switch(y.type){case Te:if(!(C.data.contains===W||C.data?.type===W&&C.data?.layout===W||C.data?.name===fe)){let{link:S}=y,{load:B}=S;T(j,j+1|0),$(l),e.push(O,B.size),e.push(Ge),e.push(ee),e.push(B.opcode,B.align,B.offset),r=r+2|0;break}case he:{T(j,j+1|0),$(l),C.data?.type===W&&C.data?.name!==fe&&!C.data?.contains?e.push(O,4):e.push(O,...g(Xn)),e.push(Ge),e.push(ee),e.push(gt,ze,Ie),T(j,j+1|0),e.push(O,...g(4)),$(l),C.data?.type===W&&C.data?.name!==fe&&!C.data.contains?e.push(O,4):e.push(O,...g(Xn)),e.push(Ge),e.push(ee),e.push(ee),e.push(gt,ze,Ie),r=r+2|0;break}}break}case Wr:{$(b.value);break}case je:{let{name:d}=b,l=be.get(d),I=Z.get(d),{data:P}=I;switch(P.type){case ct:{P.name===W||P.name===fe?(T(l,l+2|0),r=r+2|0):(T(l,l+1|0),r=r+1|0);break}case W:{if(a==="assignment"&&P.length){let j=w(P,l);e.push(H,U),e.push(O,...g(j))}else T(l,l+2|0),r=r+2|0;break}case Dt:case Wt:{let{name:j,path:C}=P,D=R(j,C),y=t.get(D);switch(P.layout){case W:{T(l,l+2|0),r=r+2|0;break}default:{switch(y.type){case Te:{if(j===fe){a==="assignment"?(e.push(O,0),e.push(Ae,U),e.push(Ft,tt),e.push(Qt,tt),e.push(O,4),e.push(te,Ue),e.push(Pe,l),e.push(H,U),e.push(O,4),e.push(Ge),e.push(ee),e.push(gt,ze,Ie),e.push(Ye,ze,Ie),e.push(H,U),e.push(O,1),e.push(ee),e.push(Ae,U),e.push(te,Kn),e.push(H,U),e.push(Pe,l+1),e.push(Qs),e.push(kt,1),e.push(es,0),e.push(en),e.push(en),e.push(H,U),e.push(Pe,l+1)):(T(l,l+2|0),r=r+2|0);break}else T(l,l+1|0);break}case et:{T(l,l+1|0),r=r+1|0;break}case he:{T(l,l+2|0),r=r+2|0;break}}break}}break}}break}case at:{let{value:d,trail:l}=b,I=d.name||d.link||d.value,P,j=Z.get(I);if(j){let{data:ue}=j,ve=R(ue.name,ue.path);P=t.get(ve)}else{let ue=nt(d);P=t.get(R(ue.data?.name,ue.data?.path))}let{indivisibles:C}=P,{mapTrail:D}=C,y=JSON.parse(JSON.stringify(l)),S=D.get(l[0]),{address:B}=S,J=[B],L=P;for(;y.length>0;){let ue=y.shift();if(y.length>0){let ve=L.members.get(ue),ke=R(ve.name,ve.path);if(L=t.get(ke),L.indivisibles){let{indivisibles:_e}=L,{mapTrail:ie}=_e,Ve=ie.get(y[0]),{address:Ne}=Ve;J.push(Ne)}continue}L=L.members.get(ue)}let oe=R(L.name,L.path),se=t.get(oe),{link:ae}=se,{load:xe}=ae,Ze=be.get(I);for(e.push(Pe,...g(Ze));J.length>1;){let ue=J.shift();e.push(O,...g(ue)),e.push(ee),e.push(gt,ze,Ie)}e.push(O,...g(J[0])),e.push(ee),L.name===fe||L.type===W||L.layout===W?(e.push(Ae,U),e.push(H,U),e.push(O,4),e.push(ee),e.push(H,U)):e.push(xe.opcode,xe.align,xe.offset);break}}},le=F=>{let{name:b,currentIndex:k}=F;if(k===0)e.push(Ut,be.size+1);else if(e.push(Pe,be.size+1),b==="==")e.push(qr);else if(b==="!=")e.push(Qr);else throw new Error(`Unknown operator ${b} for objects`)},ne=F=>{let{member:b}=F,{isObject:k,index:Y,address:V}=b;if(k){e.push(Pe,...g(Y)),e.push(O,...g(V)),e.push(ee),e.push(Pe,...g(Y)),e.push(O,...g(V+4)),e.push(ee);return}e.push(Pe,...g(Y)),e.push(O,...g(V)),e.push(ee)};for(n(o);p.length>0;){let F=p.shift();switch(F.type){case"call":{Q(F);break}case"value":{pe(F);break}case Ct:{ne(F);break}case"compare":{le(F);break}}}return r},zt=o=>{let a=(p,_)=>{for(;p<_;)_=_-1|0,e.push(Ut,_)},r=(p,_)=>{switch(_.type){case ct:{_.name===W||_.name===fe?a(p,p+2|0):a(p,p+1|0);break}case fe:{a(p,p+2|0);break}case W:{a(p,p+2|0);break}case Dt:case Wt:{let{name:n,path:i}=_,f=R(n,i),m=t.get(f);switch(n){case fe:{a(p,p+2|0);break}case W:{a(p,p+Number(_.length)|0);break}default:{switch(m.type){case Te:if(n===fe){a(p,p+2|0);break}case et:{a(p,p+1|0);break}case he:{let{length:x}=m;a(p,p+2|0);break}}break}}break}}};switch(o.type){case je:{let{name:p}=o,_=be.get(p),n=Z.get(p),{data:i}=n;r(_,i);break}case at:{let{value:p,trail:_}=o,{name:n}=p,i=Z.get(n),{data:f}=i,m=R(f.name,f.path),x=t.get(m),{indivisibles:Q}=x,{mapTrail:pe}=Q,le=_.join("."),ne=JSON.parse(JSON.stringify(_)),F=pe.get(le),{index:b}=F,k=x;for(;ne.length>0;){let V=ne.shift();k=k.members.get(V)}let Y=be.get(n);k.type==W||k.type==fe?a(Y+b|0,Y+b+2|0):a(Y+b|0,Y+b+1|0);break}}},ps=(o,a)=>{let{array:r,index:p}=o,_=0,n=be.get(r.name),i=()=>{e.push(Pe,n)},f=Z.get(r.name),{data:m}=f,{name:x,path:Q,segment:pe}=m,le=R(x,Q),ne=t.get(le);switch(ne.type){case Te:{i(),$(p);let{link:F}=ne,{store:b}=F;e.push(O,b.size),e.push(Ge),e.push(ee),$(a),e.push(b.opcode,b.align,b.offset),_=_+4|0;break}case he:{let F=null,b=0;if(a.type===je){let{name:T}=a;F=Z.get(T),b=be.get(T)}let k=0,Y=()=>{},V=(T,re)=>{i();let{index:d}=re;e.push(Pe,b+d|0);let{link:l}=T,{store:I}=l;e.push(I.opcode,I.align,I.offset+k|0),_=_+1|0,k=k+I.size|0},z=()=>{},{indivisibles:w}=ne,{mapTrail:Oe}=w;for(let T of Oe.values()){if(T.type===ct){z();continue}let{data:re}=T,{name:d,path:l}=re,I=R(d,l),P=t.get(I);switch(P.type){case Te:{V(P,T);break}case et:{Y();break}}}break}}return _},ls=(o,a)=>{let{value:r,trail:p}=o,{name:_}=r,n=Z.get(_),{data:i}=n,f=R(i.name,i.path),m=t.get(f),{indivisibles:x}=m,{mapTrail:Q}=x,pe=p.join("."),le=JSON.parse(JSON.stringify(p)),ne=Q.get(pe),{address:F}=ne,b=m;for(;le.length>0;){let V=le.shift();if(le.length>0){let z=b.members.get(V),w=R(z.name,z.path);b=t.get(w);continue}b=b.members.get(V)}let k=R(b.name,b.path),Y=t.get(k);switch(Y.type){case Te:{let{link:V}=Y,{store:z}=V,w=be.get(_);e.push(Pe,...g(w)),e.push(O,...g(F)),e.push(ee),$(a),e.push(z.opcode,z.align,z.offset);break}}},us=(o,a)=>{let{link:r}=o,p=0,_=Be(r),n=Z.get(_),{data:i}=n,{name:f,path:m,segment:x}=i,Q=R(f,m),pe=t.get(Q);switch(pe.type){case Te:{$(r),$(a);let{link:le}=pe,{store:ne}=le;e.push(ne.opcode,ne.align,ne.offset),p=p+1|0;break}case he:{let le=null,ne=0,F=(T,re,d="")=>{let l=d?`${d}.${T.name}`:T.name,I=re.get(l);if(I){let{data:P}=I,j=R(P.name,P.path),C=t.get(j),{store:D}=C.link;$(r),e.push(O,...g(I.address)),e.push(ee),$(T.value),e.push(D.opcode,D.align,D.offset)}else if(T.value&&T.value.literal)for(let P of T.value.literal)F(P,re,l)};if(a.type===je){let{name:T}=a;if(ne=be.get(T),o.link.name.startsWith(Ct)){let re=be.get(o.link.name),{name:d,path:l}=Z.get(T),I=R(d,l),P=t.get(I),{indivisibles:j}=P,{mapTrail:C}=j;for(let D of C){let{data:y}=D,S=R(y.name,y.path),B=t.get(S),{load:J,store:L}=B.link;e.push(O,...g(re)),e.push(O,...g(D.address)),e.push(ee),e.push(O,...g(ne)),e.push(O,...g(D.address)),e.push(ee),e.push(J.opcode,J.align,J.offset),e.push(L.opcode,L.align,L.offset)}return}return $(r),e.push(Pe,...g(ne)),e.push(Ye,ze,Ie),$(r),e.push(O,...g(4)),e.push(ee),e.push(Pe,...g(ne+1|0)),e.push(Ye,ze,Ie),p=p+2|0,p}let{literal:b,name:k,path:Y}=a,V=R(k,Y),z=t.get(V),{indivisibles:w}=z,{mapTrail:Oe}=w;for(let T of b)F(T,Oe)}}return p},fs=(o,a)=>{let{link:r}=a,p=0,_=ne=>{let F=Array.from(ne.members.values()).reduce((z,w)=>w?z+1:z,0);v();let{indivisibles:b}=ne,{mapTrail:k}=b,Y=(z,w)=>{let{store:Oe,load:T}=z.link,{address:re}=k.get(w);e.push(O,...g(Oe.size)),e.push(te,Ue),$(r),e.push(O,...g(re)),e.push(ee),e.push(T.opcode,T.align,T.offset),e.push(Oe.opcode,Oe.align,Oe.offset)},V=(z,w)=>{e.push(O,...g(Lt)),e.push(te,Ue),e.push(Ae,we);for(let[T,re]of z.members){if(!re)continue;let d=R(re.name,re.path),l=t.get(d);if(l.type===he){G(),V(l,`${w}.${T}`);continue}let I=`${w}.${T}`;Y(l,I)}e.push(H,we),e.push(H,we),e.push(O,...g(Lt)),e.push(ee),e.push(Ye,ze,Ie);let Oe=Array.from(z.members.values()).reduce((T,re)=>re?T+1:T,0);e.push(H,we),e.push(O,...g(pi)),e.push(ee),e.push(O,...g(Oe)),e.push(Ye,ze,Ie),de()};for(let[z,w]of ne.members){if(!w)continue;let Oe=R(w.name,w.path),T=t.get(Oe);if(T.type===he){V(T,z);continue}Y(T,z)}e.push(H,U),e.push(O,...g(F))},n=Be(r),i=Z.get(n),{data:f}=i,{name:m,path:x,segment:Q}=f,pe=R(m,x),le=t.get(pe);switch(le.type){case Te:case he:{if(o.type===je)return _(le),zt(o),p;break}}return p},Es=(o,a,r)=>{let p=t.get(o),_=i=>{switch(i.type){case je:{let{name:f}=i,m=be.get(f);e.push(Pe,m);break}case rt:{let{literal:f}=i,m=p.type===Te?f:p.evaluate(f),x=g(m);e.push(O,...x);break}}},n=()=>{switch(p.type){case et:{e.push(Bn),e.push(kt,0);break}case Te:{e.push(Bn),e.push(kt,0);break}}};switch(p.type){case et:{_(a),_(r),n();break}case Te:{_(a),_(r),n();break}}},ge=[],Je=o=>{let a={type:Un,statement:o};ge.unshift(a)};ge.unshift({type:ft});let Yt=(o,a)=>{if(o.members)for(let[r,p]of o.members.entries()){let _=R(p?.name,p?.path),n=t.get(_);if(n&&n.type===he){let i=Yt(n,_,a);i&&u.push(i)}}return o.members&&o.members.has(Ln)?a:null},u=[];Et.forEach(o=>{let a=R(o.data.name,o.data.path),r=t.get(a);if(r&&r.type===he){let p=Yt(r,a);p&&u.push(p)}});let h=u.map(o=>({type:Sn,expression:{type:dt,name:Ln,path:o,inputs:[]}}));for(let o of h)Je(o);var A=Vt.length-1|0;for(let o=A;o>=0;o=o-1|0){let a=Vt[o];Je(a)}let M=o=>{let{target:a,source:r}=o;if(a.type===$r){us(a,r);return}if(a.type===Br){ps(a,r);return}if(a.type===at){ls(a,r);return}if(r.type===St){let p=Z.get(a.name),{data:_}=p;if(_.path!=="Flogram"){let n=R(_.name,_.path);if(t.get(n).type===he){fs(a,r);return}}}$(r,"assignment"),zt(a)},X=o=>{let{statements:a}=o;e.push(Ft,tt),e.push(Qt,tt);let r={type:ft,layout:Jt};ge.unshift(r),ge.unshift(r),ge.unshift({type:Fn});var p=a.length-1|0;for(let _=p;_>=0;_=_-1|0){let n=a[_];Je(n)}},K=o=>{let{statements:a,condition:r}=o;e.push(Ft,tt),e.push(Qt,tt);let p={type:ft,layout:Jt};ge.unshift(p),ge.unshift(p),ge.unshift({type:Vn,condition:r});var _=a.length-1|0;for(let n=_;n>=0;n=n-1|0){let i=a[n];Je(i)}},ce=o=>{let{statements:a,collection:r,index:p,iterator:_}=o;N(o),e.push(O,0),p?e.push(Ut,be.get(p)):e.push(Ae,U),e.push(Ft,tt),e.push(Qt,tt);let n={type:ft,layout:Jt};ge.unshift(n),ge.unshift(n),ge.unshift({type:wn,index:p});var i=a.length-1|0;for(let f=i;f>=0;f=f-1|0){let m=a[f];Je(m)}ge.unshift({type:Yn,collection:r,iterator:_,index:p})},q=o=>{e.push(es,2)},Ee=o=>{let{branches:a}=o;ge.unshift({type:ft});for(let r=a.length-1;r>=0;r--){let p=a[r];switch(p.type){case Mr:{let{statements:_}=p,n=_.length;for(let f=n-1;f>=0;f--){let m=_[f];Je(m)}let i=_.find(f=>f.type===qs);ge.unshift({type:Zs,stop:i}),$(p.values[0]);break}case Kr:{let{statements:_}=p,n=_.length;for(let i=n-1;i>=0;i--){let f=_[i];Je(f)}ge.unshift({type:kn});break}}}},ye=o=>{let a=o,{branches:r,values:p}=a;if(r.length>0&&p.length===0)return Ee(o);e.push(Ft,tt);let n={type:ft};ge.unshift(n);let i=[];for(let m of p)switch(m.type){case je:{let{name:x}=m,Q=Z.get(x),{data:pe}=Q,{name:le,path:ne}=pe,F=R(le,ne);i.push(F);break}}var f=r.length-1|0;for(let m=f;m>=0;m=m-1|0){let x=r[m],Q={type:Dn,branch:x,condition:a,commonKeys:i};ge.unshift(Q)}},De=o=>{let{expression:a}=o;var p=$(a)|0;for(let _=0;_<p;_=_+1|0)e.push(qe)},Fe=o=>{let{value:a}=o;$(a),e.push(te,oi),e.push(O,0),zt(a)},ot=o=>{let{values:a}=o;for(let r of a)$(r);e.push(ei)},We=o=>{e.push(en)},hs=o=>{e.push(12,0)},bs=o=>{e.push(ti)},ht=o=>{o.stop?(e.push(Mn),e.push(mt)):(e.push(Mn),e.push(tt))},Os=o=>{let{branch:a,commonKeys:r,condition:p}=o,{values:_}=a,{values:n}=p;var i=r.length|0;for(let x=0;x<i;x=x+1|0){let Q=r[x],pe=_[x],le=n[x];Es(Q,pe,le)}let{statements:f}=a;var m=f.length-1|0;for(let x=m;x>=0;x=x-1|0){let Q=f[x];Je(Q)}},Nt=o=>{let{condition:a}=o;$(a),e.push(O,0),e.push(Qs),e.push(kt,1),e.push(es,0)},wt=o=>{let{collection:a,iterator:r,index:p}=o;$(a);let _=be.get(p);p?e.push(Pe,_):e.push(H,U),e.push(Qs),e.push(kt,1),e.push(qe);let n=Object.freeze({type:Zt,array:a,index:{type:je,name:p}}),i=Object.freeze({type:je,name:r}),f=Object.freeze({type:Yr,target:i,source:n});Je(f)},_s=o=>{let{index:a}=o,r=be.get(a);a?e.push(Pe,r):e.push(H,U),e.push(O,1),e.push(ee),a?e.push(Ut,r):e.push(Ae,U),e.push(es,0)},Bt=o=>{let{statement:a}=o;switch(a.type){case"assign":{M(a);break}case Zs:{ye(a);break}case Jt:{X(a);break}case Gr:{K(a);break}case Hr:{ce(a);break}case Jr:{q(a);break}case Sn:{De(a);break}case Zr:{Fe(a);break}case qs:{ot(a);break}}};for(;ge.length>0;){let o=ge.shift();switch(o.type){case ft:{We(o);break}case Fn:{hs(o);break}case kn:{bs(o);break}case Zs:{ht(o);break}case Dn:{Os(o);break}case Un:{Bt(o);break}case Vn:{Nt(o);break}case Yn:{wt(o);break}case wn:{_s(o);break}default:break}}return e}var{HEX_ENCODE:sn,LEB128_ENCODE:st}=_t,{TYPES_ASSIGN:li,TYPES_ARRAY:lt,TYPES_DATA:ns,TYPES_GENERICS:ui,TYPES_ENUMERATION:vt,TYPES_EXPRESSION:fi,TYPES_LINK:os,TYPES_LOCAL:xt,TYPES_OBJECT:Tt,TYPES_PROCEDURE:nn,TYPES_RETURN:Ei,TYPES_SELECT:hi,TYPES_MEMBER:bi,TYPES_STORE:on,TYPES_LITERAL:Wn,TYPES_LINK_TO:cs,TYPES_VALUE_AT:as,TYPES_SELF:Zn,TYPES_NATIVE:yt,TYPES_STRING:It}=Mt,cn="",Le=(s,t)=>`${t}.${s}`,Oi=s=>[">","<",">=","<=","!=","=="].includes(s),_i=s=>["FP64","I64","U64","FP32","I32","U32","I16","U16","I8","U8","Bool"].includes(s),an=48,di=Object.freeze([0,127]),mi=Object.freeze({}),gi=Object.freeze([127]),qn=0;var xi=2;var Ti=10,yi=7,Ii=3,zi=2,Ni=1,ji=6,ut=96,rs=127,rn=Object.freeze([7,105,109,112,111,114,116,115]),Ai=Object.freeze([6,109,101,109,111,114,121]),Pi=0;var Ri=65,Xe=new Uint8Array(8),Ci=Object.freeze([0,97,115,109]),Si=Object.freeze([1,0,0,0]),Di=(s,t)=>{t=t??mi;let c={},{data:E,code:N}=s,e=N.filter(u=>!u.description.generics||u.description.generics.length===0),v=new Map,G=new Map,de=u=>{let h=0;for(let A of u){let{data:M}=A;switch(M.type){case"Maybe":case ns:{let{name:X,path:K}=M,ce=Le(X,K),q=v.get(ce);if(q)switch(q.type){case yt:if(X===It){h=h+2|0;break}case vt:{h=h+1|0;break}case Tt:{let{length:Ee}=q;h=h+2|0;break}}break}case os:{M.name===lt||M.name===It?h=h+2|0:h=h+1|0;break}case lt:{h=h+2|0;break}}}return h},Re=u=>{let{labels:h}=u,A=new Map;var M=h.length|0;for(let q=0;q<M;q=q+1|0){let{name:Ee}=h[q];A.set(Ee,q)}return Object.freeze({type:vt,encode:q=>{let Ee=A.get(q);return typeof Ee>"u"?gi:st(Ee)},evaluate:q=>A.get(q),opcode:Ri,link:Object.freeze({load:Object.freeze({opcode:40,align:2,offset:0,size:4}),store:Object.freeze({opcode:54,align:2,offset:0,size:4})})})},me=u=>{let h=[],A=[],M=0,X=()=>{let n=Object.freeze({type:"back"});h.unshift(n)},K=n=>{let i={type:ns,data:n};h.unshift(i)},ce=n=>{let i={type:"name",name:n};h.unshift(i)},q=(n,i)=>{i&&(X(),K(i),ce(n))},Ee=n=>E.find(i=>i.name===n),ye=(n,i)=>i.find(f=>f.name===n),De=(n,{inputs:i})=>i.find(f=>f.name===n),Fe=(n,i)=>{let f=n;for(let m of i){let x=ye(m,f.description.members),Q=Ee(x.data.name);if(Q&&Q.type===Tt)f=Q;else return x}return null},ot=(n,i)=>{let f=n.trail,m=ye(f[0],i.members);if(!m)return null;if(f.length===1)return m.data;let x=Ee(m.data.name);return Fe(x,f.slice(1)).data},We=(n,i,f,m)=>{if(De(i,f.description))return;f.description.self.push(n);let x=Object.seal({name:i,data:{...ot({trail:n.trail||n.value?.trail||n.link?.trail||[]},m),segment:"heap"}});n.type!==cs&&(x.data.type=os),f.description.inputs.push(x)},hs=(n,i,f)=>{let m=n.inputs.map(x=>ht(x,i,f));return{...n,inputs:m}},bs=(n,i,f)=>{if(!(n.value.link===Zn||n.value.value===Zn))return console.log("THIS IS NOT HANDLED; HANGING"),n;let m=`${n.type}_${n.trail.join("_")}`;if(We(n,m,i,f),n.value.value)return{type:cs,value:m};if(n.value.link)return{type:as,link:m}},ht=(n,i,f,m="")=>{switch(n.type){case xt:case Wn:return n;case bi:{let x=`${n.type}_${n.trail.join("_")}`;return We(n,x,i,f),m==="target"?{type:on,link:{type:xt,name:x}}:{type:as,link:{type:xt,name:x}}}case cs:{if(n.value.type===Wn)return n.value;{let x=`${n.value.type}_${n.value.trail.join("_")}`;return We(n,x,i,f),{type:cs,value:{type:xt,name:x}}}}case as:{let x=`${n.link.type}_${n.link.trail.join("_")}`;return We(n,x,i,f),{type:as,link:{type:xt,name:x}}}case on:{let x=`${n.link.type}_${n.link.trail.join("_")}`;return We(n,x,i,f),{type:on,link:{type:xt,name:x}}}case hi:return bs(n,i,f);case fi:return hs(n,i,f);default:return console.log("THIS IS NOT HANDLED; HANGING"),console.log(n),n}},Os=(n,i)=>{let f=JSON.parse(JSON.stringify(n));f.description.self=[];for(let m of f.description.statements)m.type===li?(m.target=ht(m.target,f,i,"target"),m.source=ht(m.source,f,i)):m.type===Ei&&(m.values=m.values.map(x=>ht(x,f,i)));e.push(f)},{members:Nt}=u,wt=new Map;for(let n of Nt){let{name:i,data:f}=n;wt.set(i,f)}var _s=Nt.length-1|0;for(let n=_s;n>=0;n=n-1|0){let i=Nt[n],{name:f,data:m}=i;if(i.type&&i.type===nn){Os(i,u);continue}q(f,m)}let Bt=new Map,o=new Map,a=0;for(;h.length>0;){let n=h.shift();switch(n.type){case"back":{A.pop();break}case ns:{let{data:i}=n,f=()=>{let le=A.join("."),ne=Le(i.name,i.path),F=v.get(ne),{link:b}=F,k=Object.freeze({data:i,index:a,address:M,trail:le});i.type===lt||i.layout===lt||i.name===It?M+=8:M+=b?.load.size||8,Bt.set(le,k),o.set(a,k),i.type===lt||i.name===It||i.layout===lt?a=a+2|0:a=a+1|0};if(i.type===os){f();break}let{name:m,path:x}=i,Q=Le(m,x);switch(v.get(Q).type){case yt:case vt:{f();break}case Tt:{f();break}}break}case"name":{let{name:i}=n;A.push(i);break}}}let r=a|0,p=Object.freeze({mapTrail:Bt,mapIndex:o});return{type:Tt,length:r,members:wt,indivisibles:p}},Qe={};for(let u of E){let{path:h}=u;switch(u.type){case yt:{let{name:A,path:M}=u,X=Le(A,M);if(Object.hasOwn(pt,X)){let K=pt[X];v.set(X,K);continue}break}case"import":{if(Object.hasOwn(pt,h)){let A=pt[h];v.set(h,A);continue}break}case ui:{let{name:A,path:M}=u,X=Le(A,M),K=pt["Flogram.FP32"];v.set(X,K);break}case vt:{let{name:A,path:M,description:X}=u,K=Le(A,M),ce=Re(X);v.set(K,ce);break}case Tt:{let{name:A,path:M,description:X}=u,{generics:K}=X,ce=Le(A,M);if(!K||K.length===0){let q=me(X);v.set(ce,q)}break}}}c.structures=Qe;let $e=0;t.memory&&($e+=t.draws?7:6);let Et=(u,h)=>{let A=G.get(u);if(typeof A>"u"){G.set(u,[h]);return}(A.length==0||A.length>0&&A[0].body!==h.body)&&G.set(u,[h,...A])},Vt=u=>{let{name:h,path:A}=u,M=Le(h,A);switch(A==="Flogram"&&(_i(h)?M=Le(u.description.inputs[0]?.data?.name?.toLowerCase()+"."+Me(h),A):u.description.outputs&&u.description.outputs.length>=1&&!Oi(u.name)?u.description.outputs[0]?.data?.name&&(M=Le(u.description.outputs[0]?.data?.name?.toLowerCase()+"."+Me(h,u.description.inputs?.length),A)):(Rt.includes(u.description.inputs[1]?.data?.name?.toUpperCase())&&(M=Le(u.description.inputs[1]?.data?.name?.toUpperCase()+"."+Me(h),A),cn=u.description.inputs[1]?.data?.name?.toUpperCase()),cn&&(M=Le(cn.toLowerCase()+"."+Me(h),A)))),u.type){case yt:{if(Object.hasOwn(Pt,M)){let X=Pt[M];Et(M,X);return}break}case nn:{let{description:X}=u,{inputs:K,outputs:ce}=X,q=Le(h,A),Ee={type:"artificial",index:$e,procedure:u,lengths:Object.freeze({inputs:de(K),outputs:de(ce)})};Et(q,Ee);break}}$e=$e+1|0},be=[],Z=[];for(let u of e){if(u.description.generics?.length>0)continue;let{description:h}=u,{inputs:A,outputs:M}=h,X=[...A,...M];if(!(u.type===yt&&X.some(K=>!Rt.includes(K.data.name))))switch(Vt(u),u.type){case"import":{let{path:K}=u;if(Object.hasOwn(Pt,K))continue;be.push(u);break}case nn:{Z.push(u);break}}}let Ce=u=>{let h=0,A=[];for(let M of u){let X=()=>{A.push(rs),h=h+1|0},K=De=>{let{identity:Fe}=De;A.push(Fe),h=h+1|0},ce=()=>{A.push(rs),h=h+1|0},q=()=>{A.push(rs),h=h+1|0,A.push(rs),h=h+1|0},{name:Ee,data:ye}=M;switch(ye.type){case"Maybe":case ns:{let{name:De,path:Fe}=ye,ot=Le(De,Fe),We=v.get(ot);if(!We)K(pt["Flogram.FP32"]);else switch(We.type){case yt:{De===It?q():K(We);break}case vt:{X();break}case Tt:{q();break}}break}case os:{ye.name===lt||ye.name===It?q():ce();break}case lt:{q();break}}}return[h,A]},Se=(u,h)=>{let A=h.length|0,M=st(A);h.unshift(u,...M)},pn=()=>{let u=[],h=0,A=[...be,...Z];t.memory&&(h=t.draws?7:6,u.push(ut,1,127,1,127),u.push(ut,1,127,0),u.push(ut,0,0),u.push(ut,2,127,127,0),u.push(ut,0,2,127,127),u.push(ut,0,2,127,127),t.draws&&u.push(ut,1,127,0));for(let K of A){let{description:ce}=K,{inputs:q,outputs:Ee}=ce,[ye,De]=Ce(q),[Fe,ot]=Ce(Ee);u.push(ut,ye,...De,Fe,...ot)}let M=A.length|0,X=st(M+h);return u.unshift(...X),Se(Ni,u),u},is=()=>{let u=[];return u.push(2),u.push(127,1),u.push(65,0,11),u.push(127,1),u.push(65,0,11),Se(ji,u),u},Be=0,nt=()=>{let u=[],h=0,A={};if(t.memory){let K=Ee=>{let ye=[...Ee].map(De=>De.charCodeAt(0));return[ye.length,...ye]},ce=[K("alloc"),K("dealloc"),K("merge"),K("save"),K("undo"),K("undoPenultimate")];t.draws&&ce.push(K("draw"));let q=t.draws?7:6;for(let Ee=0;Ee<q;Ee++){Xe.fill(an),sn(h,Xe);let ye=h|0;u.push(...rn,...ce[Ee],qn,ye),h=h+1|0}}for(let K of be){let{path:ce}=K;Xe.fill(an),sn(h,Xe);let q=String.fromCodePoint(...Xe);A[q]={path:K.path,description:K.description};let Ee=h|0;u.push(...rn,Xe.length|0,...Xe,qn,Ee),h=h+1|0}Be=h|0,t.memory&&(u.push(...rn,...Ai,xi,...di),h=h+1|0);let M=h|0,X=st(M);return u.unshift(...X),Se(zi,u),c.imports=A,u},$=()=>{let u=[];var h=Z.length|0;for(let X=0;X<h;X=X+1|0){let K=X|0,ce=Be+K|0,q=st(ce);u.push(...q)}let A=Z.length|0,M=st(A);return u.unshift(...M),Se(Ii,u),u},zt=()=>{let u=[],h=0,A={};var M=Z.length|0;for(let ce=0;ce<M;ce=ce+1|0){let q=ce+Be|0,Ee=st(q);Xe.fill(an),sn(h,Xe);let{name:ye,path:De,description:Fe}=Z[ce];Fe={inputs:Fe.inputs,outputs:Fe.outputs};let ot=String.fromCodePoint(...Xe);A[ot]={name:ye,path:De,description:Fe},u.push(Xe.length|0,...Xe,Pi,...Ee),h=h+1|0}let X=h|0,K=st(X);return u.unshift(...K),Se(yi,u),c.procedures=A,u},ps=()=>{let u=[];for(let M of Z){let X=ss(M,v,G,e),K=X.length|0,ce=st(K);u.push(...ce,...X)}let h=Z.length|0,A=st(h);return u.unshift(...A),Se(Ti,u),u},ls=pn(),us=is(),fs=nt(),Es=$(),ge=zt(),Je=ps(),Yt=new Uint8Array([...Ci,...Si,...ls,...fs,...Es,...us,...ge,...Je]);return[c,Yt]},Fi=Object.freeze({compile:Di}),dp=Fi;export{dp as default};
