var so="as",no="=",oo="break",co="else",ao="enum",ro="export",io="if",po="import",lo="->",uo="is",fo="loop",Eo="mut",ho="native",bo="object",Oo="fn",_o="return",mo="self",go="template",xo=Object.freeze({ALIAS:so,ASSIGN:no,BREAK:oo,ELSE:co,ENUMERATION:ao,EXPORT:ro,IF:io,IMPORT:po,INTO:lo,IS:uo,LOOP:fo,MUTABLE:Eo,NATIVE:ho,OBJECT:bo,PROCEDURE:Oo,RETURN:_o,SELF:mo,TEMPLATE:go}),fn=xo;var To="assign",yo="array_assignment",Io="branch-match",zo="branch-default",No="condition",jo="loop",Po="data",Ao="generics",Ro="enumeration",Co="expression",So="instance",Do="Link",Fo="local",ko="object",Uo="procedure",Lo="return",vo="select",Vo="member",Yo="store",wo="break",Bo="literal",Mo="array_access",Ko="valueLink",Go="linkValue",Ho="self",Xo="procedure-call",$o="Maybe",Jo="native",Wo="move",Zo="String",qo="Array",Qo="import",ec="library",tc="constructor",sc="destructor",nc="free",oc="block-end",cc="default-block",ac="continue",rc="branch",ic="statement",pc="draw",lc="size",uc="concatenation",fc="foreach",Ec="while",hc="while-condition",bc="foreach-condition",Oc="foreach-end",_c="I32",dc=Object.freeze({TYPES_ASSIGN:To,TYPES_ARRAY:qo,TYPES_ARRAY_ASSIGNMENT:yo,TYPES_BRANCH_MATCH:Io,TYPES_BRANCH_DEFAULT:zo,TYPES_CONDITION:No,TYPES_LOOP:jo,TYPES_FOREACH_END:Oc,TYPES_WHILE_CONDITION:hc,TYPES_FOREACH_CONDITION:bc,TYPES_DATA:Po,TYPES_GENERICS:Ao,TYPES_ENUMERATION:Ro,TYPES_EXPRESSION:Co,TYPES_INSTANCE:So,TYPES_LINK:Do,TYPES_IMPORT:Qo,TYPES_LOCAL:Fo,TYPES_OBJECT:ko,TYPES_PROCEDURE:Uo,TYPES_RETURN:Lo,TYPES_SELECT:vo,TYPES_MEMBER:Vo,TYPES_STORE:Yo,TYPES_BREAK:wo,TYPES_LITERAL:Bo,TYPES_ARRAY_ACCESS:Mo,TYPES_LINK_TO:Ko,TYPES_VALUE_AT:Go,TYPES_SELF:Ho,TYPES_LIBRARY:ec,TYPES_DROP:Xo,TYPES_MAYBE:$o,TYPES_NATIVE:Jo,TYPES_MOVE:Wo,TYPES_STRING:Zo,TYPES_CONSTRUCTOR:tc,TYPES_FREE:nc,TYPES_DEFAULT_BLOCK:cc,TYPES_BLOCK_END:oc,TYPES_CONTINUE:ac,TYPES_BRANCH:rc,TYPES_STATEMENT:ic,TYPES_DESTRUCTOR:sc,TYPES_DRAW:pc,TYPES_SIZE:lc,TYPES_CONCAT:uc,TYPES_FOREACH:fc,TYPES_WHILE:Ec,TYPES_I32:_c}),gs=dc;var mc=Object.freeze({COLON:58,COMMA:44,DIGIT_ZERO:48,DIGIT_NINE:57,DOT:46,HASHTAG:35,HORIZONTAL_TAB:9,HYPHEN_MINUS:45,LEFT_CURLY_BRACKET:123,LEFT_PARENTHESIS:40,LEFT_SQUARE_BRACKET:91,LINE_BREAK:10,NULL:0,PLUS_SIGN:43,RIGHT_CURLY_BRACKET:125,RIGHT_PARENTHESIS:41,RIGHT_SQUARE_BRACKET:93,SEMICOLON:59,SPACE:32}),En=mc;var gc=Object.freeze([]),xc=Object.freeze({}),Tc="",yc="	",Ic=`
`,zc="UTF-8",Gt=gs,Nc=Object.freeze({EMPTY_ARRAY:gc,EMPTY_OBJECT:xc,EMPTY_STRING:Tc,HORIZONTAL_TAB:yc,LINE_BREAK:Ic,UNICODE_TEXT:zc,Codes:En,Keys:fn,Types:gs}),hn=Nc;var{EMPTY_STRING:jc,UNICODE_TEXT:Is}=hn,Pc=44,Ac=48,Rc=57,Cc=46,Sc=45,Dc=43,Fc=65,kc=90,Uc=-1,Lc=1,vc=new TextDecoder(Is),Vc=new TextEncoder,Yc=(o,s,a=0,E=o.length|0,T=0,e=s.length|0)=>{for(T=T|0,a=a|0,e=e|0,E=E|0;;){let B=a>=E,K=T>=e;if(B||K)break;let re=o[a],ye=s[T];if(a=a+1|0,T=T+1|0,re<ye)return Uc;if(re>ye)return Lc}return 0},wc=(o,s,a=0,E=o.length|0,T=0,e=s.length|0)=>{for(T=T|0,a=a|0,e=e|0,E=E|0;;){let B=T>=e,K=a>=E;if(B||K)break;s[T]=o[a],T=T+1|0,a=a+1|0}},Bc=(o,s,a=0,E=o.length|0,T=0,e=s.length|0)=>{a=a|0,T=T|0,E=E|0,e=e|0;let B=E-a|0,K=e-T|0;if(B!==K)return!1;for(;;){let te=a>=E,re=T>=e;if(te||re)break;let Re=o[a],Ye=s[T];if(a=a+1|0,T=T+1|0,Re!==Ye)return!1}return!0},Mc=o=>{o=o>>>0;let s=0,a=0;for(;a=(a<<1|1)>>>0,!(a>o);)s=s+1|0;return s},_n=Object.freeze([48,49,50,51,52,53,54,55,56,57,97,98,99,100,101,102]),ys=(o,s,a,E)=>{for(o=o>>>0,E=E??s.length|0,a=a|0,E=E|0;o>0&&E>a;)E=E-1|0,s[E]=_n[o&15],o=o>>>4},Kc=(o,s,a,E)=>{let T=a|0,e=a+E|0;if(E===0)return!1;let B=s[T];for((B===Dc||B===Sc)&&(T=T+1|0);T<e;){let K=s[T];if(T=T+1|0,!(Ac<=K&&K<=Rc||(Cc===K||Pc===K)))return!1}return!0},Gc=o=>{let s=o>=Fc,a=o<=kc;return s&&a},Xt=128,$t=127,dn=-1,_t=64,zs=o=>{o=o|0;let s=[];for(;;){let a=o&$t;o=o>>7;let E=o===0,T=(a&_t)===0,e=E&&T,B=o===-1,K=(a&_t)!==0;if(e||B&&K){s.push(a);break}a=a|Xt,s.push(a)}return s},Hc=o=>{let s=[],a=!0;for(;a;){let E=o&$t;o>>=7,o===0&&!(E&_t)||o===-1&&E&_t?a=!1:E|=Xt,s.push(E)}return s},mn=(o,s)=>{s=s|0;let a=0,E=0;for(;;){let T=o[s]|0;s=s+1|0;let e=(T&$t)<<E;if(E=E+7|0,a=a|e,(T&Xt)===0){let K=(T&_t)!==0,te=E<32;if(K&&te){let ye=dn<<E;a=a|ye}break}}return a},Xc=(o,s)=>{s=s|0;let a=0,E=0;for(;;){let T=o[s]|0;s=s+1|0;let e=(T&$t)<<E;if(E=E+7|0,a=a|e,!(T&Xt)){if(T&_t){let B=dn<<E;a=a|B}break}}return a},$c=o=>vc.decode(o),Jc=o=>Vc.encode(o),Wc=(o=jc)=>{let s=o.length|0,a=zs(s),E=Buffer.from(o,Is);return Object.freeze([...a,...E])},Zc=(o,s)=>{s=s|0;let a=mn(o,s),E=zs(a).length;return s=s+E|0,o.subarray(s,s+a|0).toString(Is)},qc=58,Qc=46,Ct=32,xs=48,ea=67,rt=new Uint8Array(ea),bn=rt.subarray(0,8),Ht=rt.subarray(10,49),On=rt.subarray(51,68),Ts=16,ta=2;rt[8]=qc;rt[9]=Ct;rt[49]=Ct;rt[50]=Ct;var sa=(o,s)=>{s=s??console.log;let a=32,E=126,T=o.length|0,e=0;for(;T>0;){bn.fill(xs),ys(e,bn),Ht.fill(Ct),On.fill(Ct);let B=T>=Ts?Ts:T;T=T-Ts|0;let K=0,te=0;for(let ye=1;ye<=B;ye=ye+1|0){let Re=o[e]&255;Ht[K+0|0]=xs,Ht[K+1|0]=xs,ys(Re,Ht,K,K+2|0);let Ye=Qc;a<=Re&&Re<=E&&(Ye=Re),On[te]=Ye,e=e+1|0,K=K+2|0,te=te+1|0,ye%ta===0&&(K=K+1|0)}let re=String.fromCodePoint(...rt);s(re)}},na=function*(o,s){let a=o.length|0,E=s.length|0,T=0;for(;T<a&&T<E;){let e=o[T],B=s[T];yield[e,B],T=T+1|0}},oa=function*(o,s,a){let E=o.length|0,T=s.length|0,e=a.length|0,B=0;for(;B<E&&B<T&&B<e;){let K=o[B],te=s[B],re=a[B];yield[K,te,re],B=B+1|0}},ca=Object.freeze({ARRAY_COMPARE:Yc,ARRAY_COPY:wc,ARRAY_EQUAL:Bc,BIT_DEPTH:Mc,HEX_DIGITS:_n,HEX_ENCODE:ys,IS_NUMBER:Kc,IS_UPPERCASE:Gc,LEB128_DECODE:mn,LEB128_DECODE_SIGNED:Xc,LEB128_ENCODE:zs,LEB128_ENCODE_SIGNED:Hc,UTF8_DECODE:$c,UTF8_ENCODE:Jc,WASM_STRING_ENCODE:Wc,WASM_STRING_DECODE:Zc,XXD_DUMP_HEX:sa,ZIP2:na,ZIP3:oa}),dt=ca;var Be=(o,s=2)=>{let a="";switch(o){case"+":a="add";break;case"-":a=s===2?"sub":"neg";break;case"*":a="mul";break;case"/":a="div";break;case"%":a="rem";break;case"==":a="eq";break;case">":a="gt";break;case"<":a="lt";break;case">=":a="ge";break;case"<=":a="le";break;case"!=":a="ne";break;case"&":a="and";break;case"|":a="or";break;case"^":a="xor";break;case"not":a="not";break;case"I32":a="toi32";break;case"U32":a="tou32";break;case"I64":a="toi64";break;case"U64":a="tou64";break;case"FP64":a="tofp64";break;case"FP32":a="tofp32";break}return a};var aa=Object.freeze({type:"native",body:Object.freeze([160]),lengths:Object.freeze({inputs:2,outputs:1})}),ra=Object.freeze({type:"native",body:Object.freeze([163]),lengths:Object.freeze({inputs:2,outputs:1})}),ia=Object.freeze({type:"native",body:Object.freeze([162]),lengths:Object.freeze({inputs:2,outputs:1})}),pa=Object.freeze({type:"native",body:Object.freeze([68,0,0,0,0,0,0,240,191,162]),lengths:Object.freeze({inputs:1,outputs:1})}),la=Object.freeze({type:"native",body:Object.freeze([161]),lengths:Object.freeze({inputs:2,outputs:1})}),ua=Object.freeze({type:"native",body:Object.freeze([124]),lengths:Object.freeze({inputs:2,outputs:1})}),fa=Object.freeze({type:"native",body:Object.freeze([128]),lengths:Object.freeze({inputs:2,outputs:1})}),Ea=Object.freeze({type:"native",body:Object.freeze([126]),lengths:Object.freeze({inputs:2,outputs:1})}),ha=Object.freeze({type:"native",body:Object.freeze([66,255,255,255,255,255,255,255,255,126]),lengths:Object.freeze({inputs:1,outputs:1})}),ba=Object.freeze({type:"native",body:Object.freeze([125]),lengths:Object.freeze({inputs:2,outputs:1})}),Oa=Object.freeze({type:"native",body:Object.freeze([124]),lengths:Object.freeze({inputs:2,outputs:1})}),_a=Object.freeze({type:"native",body:Object.freeze([127]),lengths:Object.freeze({inputs:2,outputs:1})}),da=Object.freeze({type:"native",body:Object.freeze([126]),lengths:Object.freeze({inputs:2,outputs:1})}),Wi=Object.freeze({type:"native",body:Object.freeze([66,255,255,255,255,255,255,255,255,126]),lengths:Object.freeze({inputs:2,outputs:1})}),ma=Object.freeze({type:"native",body:Object.freeze([125]),lengths:Object.freeze({inputs:2,outputs:1})}),gn=Object.freeze({type:"native",body:Object.freeze([146]),lengths:Object.freeze({inputs:2,outputs:1})}),xn=Object.freeze({type:"native",body:Object.freeze([149]),lengths:Object.freeze({inputs:2,outputs:1})}),Tn=Object.freeze({type:"native",body:Object.freeze([148]),lengths:Object.freeze({inputs:2,outputs:1})}),ga=Object.freeze({type:"native",body:Object.freeze([67,0,0,128,191,148]),lengths:Object.freeze({inputs:2,outputs:1})}),yn=Object.freeze({type:"native",body:Object.freeze([140]),lengths:Object.freeze({inputs:2,outputs:1})}),Ns=Object.freeze({type:"native",body:Object.freeze([106]),lengths:Object.freeze({inputs:2,outputs:1})}),js=Object.freeze({type:"native",body:Object.freeze([110]),lengths:Object.freeze({inputs:2,outputs:1})}),Ps=Object.freeze({type:"native",body:Object.freeze([108]),lengths:Object.freeze({inputs:2,outputs:1})}),As=Object.freeze({type:"native",body:Object.freeze([107]),lengths:Object.freeze({inputs:2,outputs:1})}),Rs=Object.freeze({type:"native",body:Object.freeze([106]),lengths:Object.freeze({inputs:2,outputs:1})}),Cs=Object.freeze({type:"native",body:Object.freeze([109]),lengths:Object.freeze({inputs:2,outputs:1})}),Ss=Object.freeze({type:"native",body:Object.freeze([108]),lengths:Object.freeze({inputs:2,outputs:1})}),Ds=Object.freeze({type:"native",body:Object.freeze([65,1,0,0,0,108]),lengths:Object.freeze({inputs:1,outputs:1})}),Fs=Object.freeze({type:"native",body:Object.freeze([107]),lengths:Object.freeze({inputs:2,outputs:1})}),xa=Object.freeze({type:"native",body:Object.freeze([130]),lengths:Object.freeze({inputs:2,outputs:1})}),Ta=Object.freeze({type:"native",body:Object.freeze([129]),lengths:Object.freeze({inputs:2,outputs:1})}),ks=Object.freeze({type:"native",body:Object.freeze([112]),lengths:Object.freeze({inputs:2,outputs:1})}),Us=Object.freeze({type:"native",body:Object.freeze([111]),lengths:Object.freeze({inputs:2,outputs:1})}),ya=Object.freeze({type:"native",body:Object.freeze([86]),lengths:Object.freeze({inputs:2,outputs:1})}),Ia=Object.freeze({type:"native",body:Object.freeze([85]),lengths:Object.freeze({inputs:2,outputs:1})}),za=Object.freeze({type:"native",body:Object.freeze([100]),lengths:Object.freeze({inputs:2,outputs:1})}),Ls=Object.freeze({type:"native",body:Object.freeze([75]),lengths:Object.freeze({inputs:2,outputs:1})}),vs=Object.freeze({type:"native",body:Object.freeze([74]),lengths:Object.freeze({inputs:2,outputs:1})}),Na=Object.freeze({type:"native",body:Object.freeze([94]),lengths:Object.freeze({inputs:2,outputs:1})}),ja=Object.freeze({type:"native",body:Object.freeze([84]),lengths:Object.freeze({inputs:2,outputs:1})}),Pa=Object.freeze({type:"native",body:Object.freeze([83]),lengths:Object.freeze({inputs:2,outputs:1})}),Aa=Object.freeze({type:"native",body:Object.freeze([99]),lengths:Object.freeze({inputs:2,outputs:1})}),Vs=Object.freeze({type:"native",body:Object.freeze([73]),lengths:Object.freeze({inputs:2,outputs:1})}),Ys=Object.freeze({type:"native",body:Object.freeze([72]),lengths:Object.freeze({inputs:2,outputs:1})}),Ra=Object.freeze({type:"native",body:Object.freeze([93]),lengths:Object.freeze({inputs:2,outputs:1})}),Ca=Object.freeze({type:"native",body:Object.freeze([87]),lengths:Object.freeze({inputs:2,outputs:1})}),Sa=Object.freeze({type:"native",body:Object.freeze([88]),lengths:Object.freeze({inputs:2,outputs:1})}),Da=Object.freeze({type:"native",body:Object.freeze([101]),lengths:Object.freeze({inputs:2,outputs:1})}),ws=Object.freeze({type:"native",body:Object.freeze([76]),lengths:Object.freeze({inputs:2,outputs:1})}),Bs=Object.freeze({type:"native",body:Object.freeze([77]),lengths:Object.freeze({inputs:2,outputs:1})}),Fa=Object.freeze({type:"native",body:Object.freeze([95]),lengths:Object.freeze({inputs:2,outputs:1})}),ka=Object.freeze({type:"native",body:Object.freeze([89]),lengths:Object.freeze({inputs:2,outputs:1})}),Ua=Object.freeze({type:"native",body:Object.freeze([90]),lengths:Object.freeze({inputs:2,outputs:1})}),La=Object.freeze({type:"native",body:Object.freeze([102]),lengths:Object.freeze({inputs:2,outputs:1})}),Ms=Object.freeze({type:"native",body:Object.freeze([78]),lengths:Object.freeze({inputs:2,outputs:1})}),Ks=Object.freeze({type:"native",body:Object.freeze([79]),lengths:Object.freeze({inputs:2,outputs:1})}),va=Object.freeze({type:"native",body:Object.freeze([96]),lengths:Object.freeze({inputs:2,outputs:1})}),Va=Object.freeze({type:"native",body:Object.freeze([81]),lengths:Object.freeze({inputs:2,outputs:1})}),Ya=Object.freeze({type:"native",body:Object.freeze([81]),lengths:Object.freeze({inputs:2,outputs:1})}),wa=Object.freeze({type:"native",body:Object.freeze([97]),lengths:Object.freeze({inputs:2,outputs:1})}),Gs=Object.freeze({type:"native",body:Object.freeze([70]),lengths:Object.freeze({inputs:2,outputs:1})}),Hs=Object.freeze({type:"native",body:Object.freeze([70]),lengths:Object.freeze({inputs:2,outputs:1})}),Ba=Object.freeze({type:"native",body:Object.freeze([91]),lengths:Object.freeze({inputs:2,outputs:1})}),Ma=Object.freeze({type:"native",body:Object.freeze([82]),lengths:Object.freeze({inputs:2,outputs:1})}),Ka=Object.freeze({type:"native",body:Object.freeze([82]),lengths:Object.freeze({inputs:2,outputs:1})}),Ga=Object.freeze({type:"native",body:Object.freeze([98]),lengths:Object.freeze({inputs:2,outputs:1})}),Xs=Object.freeze({type:"native",body:Object.freeze([71]),lengths:Object.freeze({inputs:2,outputs:1})}),$s=Object.freeze({type:"native",body:Object.freeze([71]),lengths:Object.freeze({inputs:2,outputs:1})}),Ha=Object.freeze({type:"native",body:Object.freeze([92]),lengths:Object.freeze({inputs:2,outputs:1})}),Xa=Object.freeze({type:"native",body:Object.freeze([113]),lengths:Object.freeze({inputs:2,outputs:1})}),$a=Object.freeze({type:"native",body:Object.freeze([114]),lengths:Object.freeze({inputs:2,outputs:1})}),Ja=Object.freeze({type:"native",body:Object.freeze([115]),lengths:Object.freeze({inputs:2,outputs:1})}),Wa=Object.freeze({type:"native",body:Object.freeze([69]),lengths:Object.freeze({inputs:1,outputs:1})}),In=Object.freeze({type:"native",body:Object.freeze([167]),lengths:Object.freeze({inputs:1,outputs:1})}),zn=Object.freeze({type:"native",body:Object.freeze([167]),lengths:Object.freeze({inputs:1,outputs:1})}),Za=Object.freeze({type:"native",body:Object.freeze([170]),lengths:Object.freeze({inputs:1,outputs:1})}),qa=Object.freeze({type:"native",body:Object.freeze([171]),lengths:Object.freeze({inputs:1,outputs:1})}),Qa=Object.freeze({type:"native",body:Object.freeze([168]),lengths:Object.freeze({inputs:1,outputs:1})}),er=Object.freeze({type:"native",body:Object.freeze([169]),lengths:Object.freeze({inputs:1,outputs:1})}),Nn=Object.freeze({type:"native",body:Object.freeze([]),lengths:Object.freeze({inputs:1,outputs:1})}),Jt=Object.freeze({type:"native",body:Object.freeze([193]),lengths:Object.freeze({inputs:1,outputs:1})}),Wt=Object.freeze({type:"native",body:Object.freeze([192]),lengths:Object.freeze({inputs:1,outputs:1})}),tr=Object.freeze({type:"native",body:Object.freeze([]),lengths:Object.freeze({inputs:1,outputs:1})}),sr=Object.freeze({type:"native",body:Object.freeze([]),lengths:Object.freeze({inputs:1,outputs:1})}),nr=Object.freeze({type:"native",body:Object.freeze([176]),lengths:Object.freeze({inputs:1,outputs:1})}),or=Object.freeze({type:"native",body:Object.freeze([177]),lengths:Object.freeze({inputs:1,outputs:1})}),cr=Object.freeze({type:"native",body:Object.freeze([175]),lengths:Object.freeze({inputs:1,outputs:1})}),ar=Object.freeze({type:"native",body:Object.freeze([174]),lengths:Object.freeze({inputs:1,outputs:1})}),rr=Object.freeze({type:"native",body:Object.freeze([196]),lengths:Object.freeze({inputs:1,outputs:1})}),ir=Object.freeze({type:"native",body:Object.freeze([196]),lengths:Object.freeze({inputs:1,outputs:1})}),pr=Object.freeze({type:"native",body:Object.freeze([196]),lengths:Object.freeze({inputs:1,outputs:1})}),lr=Object.freeze({type:"native",body:Object.freeze([196]),lengths:Object.freeze({inputs:1,outputs:1})}),jn=Object.freeze({type:"native",body:Object.freeze([195]),lengths:Object.freeze({inputs:1,outputs:1})}),Pn=Object.freeze({type:"native",body:Object.freeze([195]),lengths:Object.freeze({inputs:1,outputs:1})}),An=Object.freeze({type:"native",body:Object.freeze([194]),lengths:Object.freeze({inputs:1,outputs:1})}),Rn=Object.freeze({type:"native",body:Object.freeze([194]),lengths:Object.freeze({inputs:1,outputs:1})}),ur=Object.freeze({type:"native",body:Object.freeze([185]),lengths:Object.freeze({inputs:1,outputs:1})}),fr=Object.freeze({type:"native",body:Object.freeze([186]),lengths:Object.freeze({inputs:1,outputs:1})}),Js=Object.freeze({type:"native",body:Object.freeze([183]),lengths:Object.freeze({inputs:1,outputs:1})}),Ws=Object.freeze({type:"native",body:Object.freeze([184]),lengths:Object.freeze({inputs:1,outputs:1})}),Er=Object.freeze({type:"native",body:Object.freeze([187]),lengths:Object.freeze({inputs:1,outputs:1})}),hr=Object.freeze({type:"native",body:Object.freeze([180]),lengths:Object.freeze({inputs:1,outputs:1})}),br=Object.freeze({type:"native",body:Object.freeze([181]),lengths:Object.freeze({inputs:1,outputs:1})}),Zs=Object.freeze({type:"native",body:Object.freeze([178]),lengths:Object.freeze({inputs:1,outputs:1})}),qs=Object.freeze({type:"native",body:Object.freeze([179]),lengths:Object.freeze({inputs:1,outputs:1})}),Or=Object.freeze({type:"native",body:Object.freeze([182]),lengths:Object.freeze({inputs:1,outputs:1})}),St=Object.freeze(Object.assign({"Flogram./":xn,"Flogram.*":Tn,"Flogram.+":gn,"Flogram.-":yn},{"Flogram.fp64.div":ra,"Flogram.fp64.mul":ia,"Flogram.fp64.add":aa,"Flogram.fp64.sub":la,"Flogram.fp64.neg":pa,"Flogram.fp64.gt":za,"Flogram.fp64.lt":Aa,"Flogram.fp64.le":Da,"Flogram.fp64.ge":La,"Flogram.fp64.ne":Ga,"Flogram.fp64.eq":wa,"Flogram.fp64.toi32":Za,"Flogram.fp64.tou32":qa,"Flogram.fp64.tou64":or,"Flogram.fp64.toi64":nr,"Flogram.fp64.tofp32":Or},{"Flogram.u64.add":ua,"Flogram.u64.sub":ba,"Flogram.u64.mul":Ea,"Flogram.u64.div":fa,"Flogram.u64.rem":xa,"Flogram.u64.gt":ya,"Flogram.u64.lt":ja,"Flogram.u64.le":Sa,"Flogram.u64.ge":Ua,"Flogram.u64.ne":Ka,"Flogram.u64.eq":Ya,"Flogram.u64.toi32":zn,"Flogram.u64.tou32":zn,"Flogram.u64.toi64":tr,"Flogram.u64.tofp32":br,"Flogram.u64.tofp64":fr},{"Flogram.i64.add":Oa,"Flogram.i64.sub":ma,"Flogram.i64.neg":ha,"Flogram.i64.mul":da,"Flogram.i64.div":_a,"Flogram.i64.rem":Ta,"Flogram.i64.gt":Ia,"Flogram.i64.lt":Pa,"Flogram.i64.le":Ca,"Flogram.i64.ge":ka,"Flogram.i64.ne":Ma,"Flogram.i64.eq":Va,"Flogram.i64.toi32":In,"Flogram.i64.tou32":In,"Flogram.i64.tou64":sr,"Flogram.i64.tofp32":hr,"Flogram.i64.tofp64":ur},{"Flogram.fp32.div":xn,"Flogram.fp32.mul":Tn,"Flogram.fp32.add":gn,"Flogram.fp32.sub":yn,"Flogram.fp32.neg":ga,"Flogram.fp32.gt":Na,"Flogram.fp32.lt":Ra,"Flogram.fp32.le":Fa,"Flogram.fp32.ge":va,"Flogram.fp32.ne":Ha,"Flogram.fp32.eq":Ba,"Flogram.fp32.toi32":Qa,"Flogram.fp32.tou32":er,"Flogram.fp32.tou64":cr,"Flogram.fp32.toi64":ar,"Flogram.fp32.tofp64":Er},{"Flogram.u32.add":Ns,"Flogram.u32.sub":As,"Flogram.u32.mul":Ps,"Flogram.u32.div":js,"Flogram.u32.rem":ks,"Flogram.u32.gt":Ls,"Flogram.u32.lt":Vs,"Flogram.u32.le":Bs,"Flogram.u32.ge":Ks,"Flogram.u32.ne":$s,"Flogram.u32.eq":Hs,"Flogram.u32.toi32":Nn,"Flogram.u32.toi64":pr,"Flogram.u32.tou64":lr,"Flogram.u32.tofp32":qs,"Flogram.u32.tofp64":Ws},{"Flogram.i32.add":Rs,"Flogram.i32.sub":Fs,"Flogram.i32.neg":Ds,"Flogram.i32.mul":Ss,"Flogram.i32.div":Cs,"Flogram.i32.rem":Us,"Flogram.i32.gt":vs,"Flogram.i32.lt":Ys,"Flogram.i32.le":ws,"Flogram.i32.ge":Ms,"Flogram.i32.ne":Xs,"Flogram.i32.eq":Gs,"Flogram.i32.toi64":rr,"Flogram.i32.tou64":ir,"Flogram.i32.tou32":Nn,"Flogram.i32.tofp32":Zs,"Flogram.i32.tofp64":Js},{"Flogram.i16.add":Rs,"Flogram.i16.sub":Fs,"Flogram.i16.neg":Ds,"Flogram.i16.mul":Ss,"Flogram.i16.div":Cs,"Flogram.i16.rem":Us,"Flogram.i16.gt":vs,"Flogram.i16.lt":Ys,"Flogram.i16.le":ws,"Flogram.i16.ge":Ms,"Flogram.i16.ne":Xs,"Flogram.i16.eq":Gs,"Flogram.i16.toi32":Jt,"Flogram.i16.tou32":Jt,"Flogram.i16.toi64":jn,"Flogram.i16.tou64":Pn,"Flogram.i16.tofp32":Zs,"Flogram.i16.tofp64":Js},{"Flogram.u16.add":Ns,"Flogram.u16.sub":As,"Flogram.u16.mul":Ps,"Flogram.u16.div":js,"Flogram.u16.rem":ks,"Flogram.u16.gt":Ls,"Flogram.u16.lt":Vs,"Flogram.u16.le":Bs,"Flogram.u16.ge":Ks,"Flogram.u16.ne":$s,"Flogram.u16.eq":Hs,"Flogram.u16.toi32":Jt,"Flogram.u16.tou32":Jt,"Flogram.u16.toi64":jn,"Flogram.u16.tou64":Pn,"Flogram.u16.tofp32":qs,"Flogram.u16.tofp64":Ws},{"Flogram.i8.add":Rs,"Flogram.i8.sub":Fs,"Flogram.i16.neg":Ds,"Flogram.i8.mul":Ss,"Flogram.i8.div":Cs,"Flogram.i8.rem":Us,"Flogram.i8.gt":vs,"Flogram.i8.lt":Ys,"Flogram.i8.le":ws,"Flogram.i8.ge":Ms,"Flogram.i8.ne":Xs,"Flogram.i8.eq":Gs,"Flogram.i8.toi32":Wt,"Flogram.i8.tou32":Wt,"Flogram.i8.toi64":An,"Flogram.i8.tou64":Rn,"Flogram.i8.tofp32":Zs,"Flogram.i8.tofp64":Js},{"Flogram.u8.add":Ns,"Flogram.u8.sub":As,"Flogram.u8.mul":Ps,"Flogram.u8.div":js,"Flogram.u8.rem":ks,"Flogram.u8.gt":Ls,"Flogram.u8.lt":Vs,"Flogram.u8.le":Bs,"Flogram.u8.ge":Ks,"Flogram.u8.ne":$s,"Flogram.u8.eq":Hs,"Flogram.u8.toi32":Wt,"Flogram.u8.tou32":Wt,"Flogram.u8.toi64":An,"Flogram.u8.tou64":Rn,"Flogram.u8.tofp32":qs,"Flogram.u8.tofp64":Ws},{"Flogram.bool.and":Xa,"Flogram.bool.or":$a,"Flogram.bool.xor":Ja,"Flogram.bool.not":Wa}));var{LEB128_ENCODE:Me}=dt,Qi=new Int8Array(1),ep=new Uint8Array(1),_r=o=>{let s=[],a=!0;for(;a;){let E=o&127;o>>=7,o===0&&!(E&64)||o===-1&&E&64?a=!1:E|=128,s.push(E)}return new Uint8Array(s)},dr=o=>{let s=[],a=!0;for(;a;){let E=o&127;o>>=7,o===0?a=!1:E|=128,s.push(E)}return new Uint8Array(s)},mr=o=>{let s=[];for(;o>=128;)s.push(o&127|128),o>>>=7;return s.push(o),new Uint8Array(s)},gr=128,xr=127,Cn=64,Tr=o=>{o=o<<16>>16;let s=[];for(;;){let a=o&xr;o=o>>7;let E=o===0,T=(a&Cn)===0,e=E&&T,B=o===-1,K=(a&Cn)!==0;if(e||B&&K){s.push(a);break}a=a|gr,s.push(a)}return s};var yr=o=>{let s=new Float32Array(1);return s[0]=parseFloat(o),new Uint8Array(s.buffer)},Sn=o=>{let s=[],a=!0;for(;a;){let E=o&127;o>>=7,o===0&&!(E&64)||o===-1&&E&64?a=!1:E|=128,s.push(E)}return new Uint8Array(s)},Ir=o=>Me(o),zr=o=>{let s=new Float64Array(1);return s[0]=o,new Uint8Array(s.buffer)},Nr=o=>{let s=[];for(;o>=128;)s.push(o&127|128),o>>>=7;return s.push(o),new Uint8Array(s)},jr=o=>{let s=[],a=!0;for(;a;){let E=o&127;o>>=7,o===0&&!(E&64)||o===-1&&E&64?a=!1:E|=128,s.push(E)}return new Uint8Array(s)},Pr=o=>{let s=new Uint8Array(1);return s[0]=o==="TRUE"?1:o==="FALSE"?0:o,s},Ar=o=>{let s=o.charCodeAt(0);return Me(s)},Dn=()=>{let o=new ArrayBuffer(4);return new Float32Array(o)[0]=-0,[...new Uint8Array(o)]},Rr=Object.freeze({type:"native",identity:127,opcode:65,encode:Sn,link:Object.freeze({load:Object.freeze({opcode:40,align:2,offset:0,size:4}),store:Object.freeze({opcode:54,align:2,offset:0,size:4})})}),Cr=Object.freeze({type:"native",identity:127,opcode:65,none:Me(-1),encode:Ar,link:Object.freeze({load:Object.freeze({opcode:44,align:2,offset:0,size:4}),store:Object.freeze({opcode:54,align:2,offset:0,size:4})})}),Sr=Object.freeze({type:"native",identity:127,opcode:65,none:Me(-1),encode:Pr,link:Object.freeze({load:Object.freeze({opcode:40,align:2,offset:0,size:4}),store:Object.freeze({opcode:54,align:2,offset:0,size:4}),values:{TRUE:1,FALSE:0}})}),Dr=Object.freeze({type:"native",identity:124,opcode:68,none:Dn(),encode:zr,link:Object.freeze({load:Object.freeze({opcode:43,align:3,offset:0,size:8}),store:Object.freeze({opcode:57,align:3,offset:0,size:8})})}),Fr=Object.freeze({type:"native",identity:126,opcode:66,none:Me(-1),encode:Nr,link:Object.freeze({load:Object.freeze({opcode:43,align:3,offset:0,size:8}),store:Object.freeze({opcode:57,align:3,offset:0,size:8})})}),kr=Object.freeze({type:"native",identity:126,opcode:66,none:Me(-9223372036854776e3),encode:jr,link:Object.freeze({load:Object.freeze({opcode:43,align:3,offset:0,size:8}),store:Object.freeze({opcode:57,align:3,offset:0,size:8})})}),Ur=Object.freeze({type:"native",identity:125,opcode:67,none:Dn(),encode:yr,link:Object.freeze({load:Object.freeze({opcode:42,align:2,offset:0,size:4}),store:Object.freeze({opcode:56,align:2,offset:0,size:4})})}),Lr=Object.freeze({type:"native",identity:127,opcode:65,none:Me(-1),encode:Ir,link:Object.freeze({load:Object.freeze({opcode:40,align:2,offset:0,size:4}),store:Object.freeze({opcode:54,align:2,offset:0,size:4})})}),vr=Object.freeze({type:"native",identity:127,opcode:65,none:Me(-2147483648),encode:Sn,link:Object.freeze({load:Object.freeze({opcode:40,align:2,offset:0,size:4}),store:Object.freeze({opcode:54,align:2,offset:0,size:4})})}),Vr=Object.freeze({type:"native",identity:127,opcode:65,none:Me(-32768),encode:Tr,link:Object.freeze({load:Object.freeze({opcode:40,align:2,offset:0,size:4}),store:Object.freeze({opcode:54,align:2,offset:0,size:4})})}),Yr=Object.freeze({type:"native",identity:127,opcode:65,encode:mr,none:Me(-1),link:Object.freeze({load:Object.freeze({opcode:40,align:2,offset:0,size:4}),store:Object.freeze({opcode:54,align:2,offset:0,size:4})})}),wr=Object.freeze({type:"native",identity:127,opcode:65,none:Me(-128),encode:_r,decode:o=>new Int8Array([o])[0],link:Object.freeze({load:Object.freeze({opcode:44,align:0,offset:0,size:4}),store:Object.freeze({opcode:58,align:0,offset:0,size:4})})}),Br=Object.freeze({type:"native",identity:127,opcode:65,none:Me(-1),encode:dr,link:Object.freeze({load:Object.freeze({opcode:43,align:0,offset:0,size:4}),store:Object.freeze({opcode:58,align:0,offset:0,size:4})})}),it=Object.freeze({"Flogram.String":Rr,"Flogram.Char":Cr,"Flogram.Bool":Sr,"Flogram.FP64":Dr,"Flogram.U64":Fr,"Flogram.I64":kr,"Flogram.FP32":Ur,"Flogram.U32":Lr,"Flogram.I32":vr,"Flogram.I16":Vr,"Flogram.U16":Yr,"Flogram.I8":wr,"Flogram.U8":Br});var Mr=Object.freeze(["FP64","U64","I64","FP32","U32","I32","U16","I16","U8","I8","Bool","Char","Array","String","Link","Maybe"]),Dt=Mr;var{TYPES_ASSIGN:Kr,TYPES_DRAW:Gr,TYPES_ARRAY:Z,TYPES_ARRAY_ASSIGNMENT:Hr,TYPES_BRANCH_MATCH:Xr,TYPES_BRANCH_DEFAULT:$r,TYPES_CONDITION:Qs,TYPES_LOOP:Zt,TYPES_WHILE:Jr,TYPES_FOREACH:Wr,TYPES_DATA:qt,TYPES_GENERICS:up,TYPES_ENUMERATION:ct,TYPES_EXPRESSION:mt,TYPES_INSTANCE:fp,TYPES_LINK:pt,TYPES_LOCAL:Pe,TYPES_CONCAT:Fn,TYPES_OBJECT:ue,TYPES_PROCEDURE:Ep,TYPES_RETURN:en,TYPES_SELECT:Ze,TYPES_MEMBER:Ft,TYPES_STORE:Zr,TYPES_BREAK:qr,TYPES_LITERAL:at,TYPES_ARRAY_ACCESS:Qt,TYPES_LINK_TO:es,TYPES_VALUE_AT:kt,TYPES_SELF:hp,TYPES_DROP:kn,TYPES_MAYBE:Ut,TYPES_MOVE:Qr,TYPES_NATIVE:Te,TYPES_STRING:fe,TYPES_FREE:ei,TYPES_BRANCH:Un,TYPES_CONTINUE:Ln,TYPES_DEFAULT_BLOCK:vn,TYPES_BLOCK_END:ft,TYPES_STATEMENT:Vn,TYPES_DESTRUCTOR:Yn,TYPES_SIZE:wn,TYPES_WHILE_CONDITION:Bn,TYPES_FOREACH_CONDITION:Mn,TYPES_FOREACH_END:Kn}=Gt,Lt=2,ts=3,ss=12,vt=13,qe=16,$e=26,O=65,Gn=71,ti=113,si=114,tn=70,Se=32,Vt=33,G=35,Ae=36,ni=15,sn=11,Hn=4,oi=5,Qe=64,gt=127,Ke=108,ci=109,q=106,ai=107,ve=54,xt=40,Ie=0,ze=2,ri="alloc",ii="dealloc",Xn="merge",$n="save",pi="undo",li="undoPenultimate",ui="draw",fi=999999,Jn=888888,Ei=777777,L=0,Ve=1,hi=4,Yt=8,Wn=8,Zn="Flogram.draw",ns=new Set(["==","!=",">",">=","<","<=","!","&","|"]),{LEB128_ENCODE:g}=dt,nn,j=(o,s)=>`${s}.${o}`,qn=(o,s,a)=>{let E=a.get(o);if(E&&E.length===1)return E[0];if(E&&E.length>1)return E[0];throw console.log(o),console.log(a),Error("No Callees were found")};function os(o,s,a,E){o?.description?.inputs.length>0?nn=o.description.inputs[0].data.name:o?.description?.outputs.length>0&&(nn=o.description.outputs[0].data.name);let T=c=>{He(c.collection).length},e=[],B=new Set,K=c=>{B.add(c)},te=()=>{e.push(qe,ri),K("alloc")},re=()=>{e.push(qe,ui),K("draw")},ye=(c=L)=>{e.push(O,0),te(),e.push(Ae,c)},Re=()=>{e.push(G,L),e.push(G,Ve),e.push(qe,$n),e.push(G,Ve),e.push(G,L),e.push(qe,$n),K("save")},Ye=()=>{e.push(qe,pi),e.push(Ae,Ve),e.push(Ae,L),K("undo")},Bt=()=>{e.push(qe,li),e.push(Ae,Ve),e.push(Ae,L),K("undoPenultimate")},Je=()=>{e.push(qe,Xn),K("merge")},{description:Nt}=o,{inputs:We,locals:Et,statements:tt}=Nt,he=new Map,ie=new Map;{let c=0,i=t=>{for(let n of t){let{name:r,data:u}=n;switch(he.set(r,c),ie.set(r,n),u.type){case Ut:case qt:{let{name:b,path:C}=u,M=j(b,C);switch(b){case fe:{c=c+2|0;break}default:{let v=s.get(M);switch(v.type){case Te:{c=c+1|0;break}case ct:{c=c+1|0;break}case ue:{let{length:W}=v;c=c+2|0;break}}break}}break}case Z:{c=c+2|0;break}case pt:{u.name===fe||u.name===Z?c=c+2|0:c=c+1|0;break}}}};i(We),i(Et)}let Ce=0,st=[];for(let c of Et){let{data:i}=c,t=()=>{st.push(1,gt),Ce=Ce+1|0},n=()=>{st.push(1,gt),Ce=Ce+1|0,st.push(1,gt),Ce=Ce+1|0},r=()=>{st.push(1,gt),Ce=Ce+1|0},u=b=>{let{identity:C}=b;st.push(1,C),Ce=Ce+1|0};switch(i.type){case Z:{n();break}case pt:{i.name===Z||i.name===fe?n():t();break}case Ut:case qt:{let{name:b,path:C}=i;switch(b){case fe:{n();break}default:{let M=j(b,C),v=s.get(M);switch(v.type){case Te:{u(v);break}case ct:{r();break}case ue:{n();break}}break}}break}}}((c,i)=>{for(let[t,n]of c)if(n.type==i){st.push(1,gt),Ce=Ce+1|0;break}})(s,ue);let ls=g(Ce);e.push(...ls,...st);let nt=c=>{if(typeof c!==ue)return c;switch(c.type){case Pe:return c.name;case es:return nt(c.value);case kt:return nt(c.link);case Ft:return`${c.type}_${c.trail.join("_")}`;case Qt:return c.array.name;case Ze:return nt(c.value)}return null},He=c=>{switch(c.type){case at:return c;case Pe:return ie.get(c.name)?.data;case kt:return He(c.link);case es:return He(c.value);case wn:{if(input.value.type===Pe)return{name:"I32",path:"Flogram",type:"data"};break}case Qt:return ie.get(nt(c));case Ze:{let{value:i,trail:t}=JSON.parse(JSON.stringify(c)),{name:n}=i,r=ie.get(n||nt(i)),{data:u}=r,b=j(u.name,u.path),C=s.get(b),{indivisibles:M}=C,v=JSON.parse(JSON.stringify(t)),W=C;for(;v.length>0;){let Oe=v.shift();if(v.length>0){let _e=W.members.get(Oe),de=j(_e.name,_e.path);W=s.get(de);continue}W=W.members.get(Oe)}return W}}},H=(c,i=en)=>{let t=0,n=[],r=(k,h)=>{let A={type:"call",key:k,inputs:h};n.unshift(A)},u=k=>{let h={type:"value",value:k};n.unshift(h)},b=k=>{let h={type:Ft,member:k};n.unshift(h)},C=(k,h,A,S)=>{let P={key:null,stop:!1},d;if(k&&Dt.includes(k.data.name)){let{data:me}=k,{name:F}=me;d=j(F.toLowerCase()+"."+Be(A),h),nn=F}else if(k){let{data:me}=k,{name:F,path:ge}=me,_=j(F,ge),l=s.get(_),{indivisibles:y}=l,{mapTrail:I}=y,z=I.size-1;for(let[R,U]of I){n.unshift({type:"compare",currentIndex:z,name:A}),d=j(U.data.name.toLowerCase()+"."+Be(A),U.data.path);let m=S.map(N=>({type:Ze,value:{type:Pe,name:N.name},trail:[U.trail]}));r(d,m);var $=m.length-1|0;for(let N=$;N>=0;N=N-1|0){let Y=m[N];u(Y)}z--}P.stop=!0}return P.key=d,P},M=k=>{let{inputs:h}=k,A=h.find(S=>S.type==mt);if(ns.has(k.name))return"Bool";if(A){let S=h.map(d=>{if(d.type===Pe)return ie.get(d.name);if(d.type===at)return{data:d};if(d.type===mt)return{data:{name:M(d)}}}),P=E.find(d=>d.description&&Array.isArray(d.description.inputs)?d.description.inputs.length!==S.length?!1:d.description.inputs.every(($,me)=>$.data.name===S[me].data.name):!1);return P?ns.has(P.name)?P.description.inputs[0].data.name:P.description.outputs[0].data.name:"unknown"}else{let S=h.map(d=>({data:He(d)})),P=E.find(d=>d.description&&Array.isArray(d.description.inputs)?d.description.inputs.length!==S.length?!1:d.description.inputs.every(($,me)=>$.data.name===S[me].data.name):!1);return P?ns.has(P.name)?P.description.inputs[0].data.name:P.description.outputs[0].data.name:"unknown"}},v=k=>{let{inputs:h,name:A,path:S}=k,P=j(A,S),d=[S],$;if(typeof A===ue){let F=A[0];if($=ie.get(F),$){d.push($.data.name);for(let _=1;_<=A.length-2;_++)F=A[_],$=ie.get(F),$&&d.push($.data.name)}let ge=A.length-1|0;P=j(A[ge],d.join("."))}if(S==="Flogram"&&A!==Gr){let F=h.find(l=>l.type===mt),ge=h.find(l=>l.type===at),_=h.map(l=>ie.get(l.name)).find(Boolean);if(_){let l=C(_,S,A,h);if(P=l.key,l.stop)return}else if(ge)P=j(`${ge.name.toLowerCase()}.${Be(A)}`,S);else if(F)P=j(`${M(F).toLowerCase()}.${Be(A)}`,S);else{let l=E.find(y=>y.name===k.name&&y.path===k.path&&y.description.inputs.length===k.inputs.length);P=j(`${ns.has(l.name)?l.description.inputs[0]?.data.name.toLowerCase():l.description.outputs[0]?.data.name.toLowerCase()}.${Be(l.name)}`,S)}}if(r(P,h),typeof A===ue){let F=qn(P,h,a);if(F){let{procedure:ge}=F,{description:_}=ge,{self:l}=_,y=ie.get(A[0]),I=j(y.data.name,y.data.path),z=s.get(I);if(z){let R=he.get(A[0]),{indivisibles:U,members:m}=z,{mapTrail:N}=U;for(let Y=l.length-1|0;Y>=0;Y--){let ee=l[Y];if(ee.type===Ft){let w=ee.trail.join(".");if(N.get(w)){let{address:ne}=N.get(w);b({index:R,address:ne})}else{let ne=JSON.parse(JSON.stringify(ee.trail)),se=z;for(;ne.length>0;){let je=ne.shift();if(ne.length>0){let Ot=se.members.get(je),Rt=j(Ot.name,Ot.path);se=s.get(Rt);continue}se=se.members.get(je)}let oe=j(se.name,se.path),xe=s.get(oe),{indivisibles:Xe}=xe,{mapIndex:le,mapTrail:Ue}=Xe,De=le.get(0),Ee=`${w}.${De.trail}`,{address:ce}=N.get(Ee),Le={index:R,address:ce-8};b(Le)}}}}}}if(P!==Zn){var me=h.length-1|0;for(let F=me;F>=0;F=F-1|0){let ge=h[F];u(ge)}}},W=k=>{let{key:h,inputs:A}=k;if(h===Zn){for(let d of A){let $=He(d);d.type===Ze?$?.name===fe?(e.push(O,...g(Jn)),re(),H(d),e.push(Ae,L),e.push(xt,ze,Ie),re(),e.push(G,L),e.push(xt,ze,Ie),re()):(H(d),re()):$?.name===fe||d.type===Fn?(e.push(O,...g(Jn)),re(),H(d),re(),re()):$?.name===Z||$?.layout===Z?(e.push(O,...g(fi)),re(),H(d),re(),re()):(H(d),re()),d.type===Ze&&(e.push($e),($?.name===fe||$?.type===Z||$?.layout===Z)&&e.push($e))}e.push(O,...g(Ei)),re(),t=t-A.length|0;return}let S=qn(h,A,a);switch(S.type){case Te:{let{body:d}=S;e.push(...d);break}case"artificial":{let{index:d}=S;e.push(qe,d);break}}let{lengths:P}=S;t=t-P.inputs|0,t=t+P.outputs|0},Oe=k=>{let{value:h}=k,A=_=>{let l=0,y=nt(_),I;if(_.type===Ze){let{value:z,trail:R}=JSON.parse(JSON.stringify(_)),{name:U}=z,m=ie.get(U),{data:N}=m,Y=j(N.name,N.path),ee=s.get(Y),{indivisibles:w}=ee,{mapTrail:ne}=w,se=R.join("."),oe=JSON.parse(JSON.stringify(R)),xe=ee;for(;oe.length>0;){let le=oe.shift();if(oe.length>0){let Ue=xe.members.get(le),De=j(Ue.name,Ue.path);xe=s.get(De);continue}xe=xe.members.get(le)}let Xe=j(xe.name,xe.path);I=s.get(Xe)}else{let z=ie.get(y),{data:R}=z,{name:U,path:m,segment:N}=R,Y=j(U,m);I=s.get(Y)}if(I){switch(I.type){case Te:{Oe({value:_});let{link:z}=I,{load:R}=z;e.push(R.opcode,R.align,R.offset),l=l+1|0;break}case ue:{let z=0,R=()=>{},U=ee=>{Oe({value:_});let{link:w}=ee,{load:ne}=w;e.push(ne.opcode,ne.align,ne.offset+z|0),l=l+1|0,z=z+ne.size|0},m=()=>{},{indivisibles:N}=I,{mapTrail:Y}=N;for(let ee of Y.values()){if(ee.type===pt){m();continue}let{data:w}=ee,{name:ne,path:se}=w,oe=j(ne,se),xe=s.get(oe);switch(xe.type){case Te:{U(xe);break}case ct:{R();break}}}break}}return l}},S=(_,l)=>{let y=0,{literal:I,name:z,path:R,size:U}=_,m=U||I.length;_.length&&!U&&(m=parseInt(_.length,10));let N=j(z,R),Y=s.get(N);function ee(w){let ne=0,{literal:se,name:oe,path:xe,vSize:Xe}=w,le=Xe||se.length;w.length&&!Xe&&(le=parseInt(w.length,10));let Ue=j(oe,xe),De=s.get(Ue);ye(),(De.type===ue||oe===fe&&w.layout===Z||w.contains===Z)&&(e.push(O,...g(le*4*2|0)),te(),e.push(Vt,L),Re());for(let Ee=0;Ee<le;Ee++){let ce=se[Ee];if(ce)if(ce.name===fe&&w.layout===Z||ce.layout===Z&&De.type!==ue){let Le=[];if(ce.layout===Z){let je=ce.size||ce.literal.length;e.push(G,L),e.push(G,L),e.push(G,L),e.push(O,...g(Ee)),e.push(O,...g(8)),e.push(Ke),e.push(q),Le.push(ce.literal),ee(ce),e.push(G,L),e.push(ve,ze,Ie),e.push(O,...g(4)),e.push(O,...g(Ee)),e.push(O,...g(8)),e.push(Ke),e.push(q),e.push(q),e.push(O,je),e.push(ve,ze,Ie),e.push(Ae,L)}else{let je=ce.size||ce.literal.length;for(let Rt=0;Rt<je;Rt++)Le.push({type:ce.type,path:ce.path,name:"I32",literal:ce.literal[Rt].charCodeAt().toString()});let Ot={type:at,name:"I32",layout:Z,path:ce.path,literal:Le};e.push(G,L),e.push(G,L),e.push(G,L),e.push(O,...g(Ee)),e.push(O,...g(8)),e.push(Ke),e.push(q),ee(Ot),e.push(G,L),e.push(ve,ze,Ie),e.push(O,...g(4)),e.push(O,...g(Ee)),e.push(O,...g(8)),e.push(Ke),e.push(q),e.push(q),e.push(O,je),e.push(ve,ze,Ie),e.push(Ae,L)}}else switch(De.type){case Te:{let{link:Le}=De,{store:je}=Le;e.push(O,...g(je.size)),te(),!ce||ce.type===at?e.push(De.opcode,...De.encode(ce?.literal||0)):H(ce),e.push(je.opcode,je.align,je.offset),Je(),ne=3;break}case ue:{e.push(G,L),e.push(G,L),e.push(O,...g(Ee)),e.push(O,...g(8)),e.push(Ke),e.push(q),H(ce),e.push(Ae,Ve),e.push(ve,ze,Ie),e.push(Ae,L),e.push(G,L),e.push(O,...g(4)),e.push(O,...g(Ee)),e.push(O,...g(8)),e.push(Ke),e.push(q),e.push(q),e.push(G,Ve),e.push(ve,ze,Ie);break}}}}return ee(_),l?m:(e.push(G,L),e.push(O,...g(m)),y=1,y)},P=(_,l,y=!0)=>{let I=s.get(l);ye();let z=(m,N)=>{Re(),Bt(),e.push(G,L),e.push(G,L),e.push(G,L),Ye(),e.push(O,...g(N)),e.push(q),e.push(G,L),e.push(ve,ze,Ie),e.push(O,...g(N)),e.push(O,...g(4)),e.push(q),e.push(q),e.push(O,...g(m)),e.push(ve,ze,Ie),e.push(Ae,L)},R=[];for(let[m,N]of I.members){if(!N)continue;let Y=_.find(ne=>ne.name===m)||{name:m,value:N.value},ee=j(N.name,N.path),w=s.get(ee);if(N.type===Z){e.push(O,...g(Yt)),te(),e.push($e),R.push({data:{keyName:m,keyData:N},literal:Y});continue}switch(w.type){case Te:{let{link:ne}=w,{store:se}=ne;if(N.type===pt)Re(),e.push(O,...g(4)),te(),H(Y.value),e.push(se.opcode,se.align,se.offset),Ye();else if(N.name===fe)e.push(O,...g(Yt)),te(),e.push($e),R.push({data:{keyName:m,keyData:N},literal:Y});else{e.push(O,...g(se.size)),te();let oe=JSON.parse(JSON.stringify(Y.value));oe.literal&&(oe.name!==N.name||oe.path!==N.path)&&(oe={...oe,name:N.name,path:N.path}),H(oe),e.push(se.opcode,se.align,se.offset)}Je();break}case ue:{e.push(O,...g(Yt)),te(),e.push($e),R.push({data:{keyName:m,keyData:N},literal:Y});break}}}if(R.length>0){let m=R[0],{data:N,literal:Y}=m,{keyName:ee,keyData:w}=N,{type:ne,name:se,layout:oe,path:xe}=w,le=(Ee=>{let ce=I.indivisibles.mapTrail;if(ce.has(Ee))return ce.get(Ee).address;let Le=Array.from(ce.entries()).filter(([je])=>je.startsWith(`${Ee}.`));return Le.length?(Le.sort((je,Ot)=>je[1].address-Ot[1].address),Le[0][1].address-8):null})(ee),Ue=j(se,xe),De=s.get(Ue);if(se===fe)Re(),H(Y.value),e.push($e,$e),z(Y.value.size||Y.value.literal.length,le),Je();else if(ne===Z||oe===Z)if(Y.value.type===Pe){let Ee=he.get(Y.value.name);Re();let ce=$(w,Ee);z(ce,le),Je()}else{Re();let Ee=S(Y.value,!0);z(Ee,le),Je()}else if(De.type===ue){Re();let Ee=P(Y.value.literal,Ue,!1);z(Ee,le),Je()}else console.log("we failed here.......")}let U=I.indivisibles.mapTrail.size+R.length;return y&&(e.push(G,L),e.push(O,...g(U))),U},d=(_,l)=>{let y=0,I=ie.get(l),z;if(I){let{data:U}=I,{name:m,path:N,segment:Y}=U;z=j(m,N)}else{let U=m=>{if(m.type===at)return j(m.name,m.path);if(m.type===mt)return U(m.inputs[0]);if(m.type===kt)return U(m.link);if(m.type===es)return U(m.value);if(m.type===Pe){let N=ie.get(m.name),{data:Y}=N,{name:ee,path:w,segment:ne}=Y;return j(ee,w)}else if(m.type===Ze){let N=s.get(U(m.value)),{indivisibles:Y}=N,{mapTrail:ee}=Y,w=m.trail.join("."),{data:ne}=ee.get(w),{name:se,path:oe}=ne;return j(se,oe)}};z=U(_)}let R=s.get(z);switch(R.type){case Te:{let{link:U}=R,{store:m}=U;e.push(O,...g(m.size)),te(),e.push(Ae,L),e.push(G,L),H(_),e.push(m.opcode,m.align,m.offset),e.push(G,L),y=y+7|0;break}case ue:{let U=0,m=()=>{},N=ne=>{H(_);let{link:se}=ne,{load:oe}=se;e.push(oe.opcode,oe.align,oe.offset+U|0),y=y+1|0,U=U+oe.size|0},Y=()=>{},{indivisibles:ee}=R,{mapTrail:w}=ee;for(let ne of w.values()){if(ne.type===pt){Y();continue}let{data:se}=ne,{name:oe,path:xe}=se,Xe=j(oe,xe),le=s.get(Xe);switch(le.type){case Te:{N(le);break}case ct:{m();break}}}break}}return y},$=(_,l=0)=>{let{name:y,path:I}=_,z=j(y,"Flogram"),R=s.get(z),{link:U}=R,{store:m,load:N}=U,Y=Number(_.length);ye();for(let ee=0;ee<Y;ee++){e.push(O,...g(m.size)),te();let w=l;F(w,w+1|0),e.push(O,...g(ee)),e.push(O,N.size),e.push(Ke),e.push(q),e.push(N.opcode,N.align,N.offset),e.push(m.opcode,m.align,m.offset),Je()}return Y},me=(_,l)=>{let y=s.get(l),{opcode:I}=y,z=y.encode(_);e.push(I,...z)},F=(_,l)=>{for(;_<l;)e.push(Se,_),_=_+1|0};switch(h.type){case mt:{v(h);break}case"instance":{let{path:_,members:l}=h;var ge=l.length-1|0;for(let y=ge;y>=0;y=y-1|0){let I=l[y],{path:z,value:R}=I;u(R)}break}case Ut:{let{data:_}=h,{name:l,path:y}=_,I=j(l,y),z=s.get(I);h.layout==="NONE"?e.push(z.opcode,...z.none):H(h.value),t=t+1|0;break}case kt:{let{link:_}=h,l=A(_);t=t+l|0;break}case es:{let{value:_}=h,l=nt(_);if(ie.get(l)?.data.type===Z){H({name:l,type:Pe});return}let I=d(_,l);t=t+I|0;break}case wn:{let{value:_}=h;switch(_.type){case Pe:{let l=he.get(_.name);F(l+1|0,l+2|0);break}}break}case Fn:{let{values:_}=h;ye(Ve);for(let l of _){let y=He(l),I=j(y.name,y.path);if(y.name===fe||y.type===Z||y.layout===Z)H(l,"assignment"),e.push($e),e.push($e);else{let z=s.get(I),{link:R}=z,{store:U}=R;e.push(O,...g(U.size)),te(),H(l),e.push(U.opcode,U.align,U.offset)}Je()}ye(),e.push(G,Ve),e.push(G,L),e.push(G,Ve),e.push(ai),e.push(O,4),e.push(ci),t=t+2|0;break}case at:{let{literal:_,name:l,path:y}=h,I=j(l,y),z=s.get(I);if(h.layout===Z){S(h),t=t+2|0;return}else if(l===fe){let R=[];for(let m of _)R.push({type:at,literal:m.charCodeAt(0).toString(),name:fe,path:"Flogram"});let U={...h,literal:R};S(U),t=t+2|0;return}z&&z.type===ue?(P(_,I),t=t+2|0):(z||(console.log(h),console.log("NO SHAPE FOUND")),me(_,I),t=t+1|0);break}case Qt:{let{array:_,index:l}=h,{name:y}=_,{name:I}=l,z=he.get(y),R=ie.get(y),U=j(R.data.name,R.data.path),m=s.get(U);switch(m.type){case Te:if(!(R.data.contains===Z||R.data?.type===Z&&R.data?.layout===Z||R.data?.name===fe)){let{link:N}=m,{load:Y}=N;F(z,z+1|0),H(l),e.push(O,Y.size),e.push(Ke),e.push(q),e.push(Y.opcode,Y.align,Y.offset),t=t+2|0;break}case ue:{F(z,z+1|0),H(l),R.data?.type===Z&&R.data?.name!==fe&&!R.data?.contains?e.push(O,4):e.push(O,...g(Wn)),e.push(Ke),e.push(q),e.push(xt,ze,Ie),F(z,z+1|0),e.push(O,...g(4)),H(l),R.data?.type===Z&&R.data?.name!==fe&&!R.data.contains?e.push(O,4):e.push(O,...g(Wn)),e.push(Ke),e.push(q),e.push(q),e.push(xt,ze,Ie),t=t+2|0;break}}break}case Qr:{H(h.value);break}case Pe:{let{name:_}=h,l=he.get(_),y=ie.get(_),{data:I}=y;switch(I.type){case pt:{I.name===Z||I.name===fe?(F(l,l+2|0),t=t+2|0):(F(l,l+1|0),t=t+1|0);break}case Z:{if(i==="assignment"&&I.length){let z=$(I,l);e.push(G,L),e.push(O,...g(z))}else F(l,l+2|0),t=t+2|0;break}case Ut:case qt:{let{name:z,path:R}=I,U=j(z,R),m=s.get(U);switch(I.layout){case Z:{F(l,l+2|0),t=t+2|0;break}default:{switch(m.type){case Te:{if(z===fe){i==="assignment"?(e.push(O,0),e.push(Ae,L),e.push(Lt,Qe),e.push(ts,Qe),e.push(O,4),te(),e.push(Se,l),e.push(G,L),e.push(O,4),e.push(Ke),e.push(q),e.push(xt,ze,Ie),e.push(ve,ze,Ie),e.push(G,L),e.push(O,1),e.push(q),e.push(Ae,L),e.push(qe,Xn),K("merge"),e.push(G,L),e.push(Se,l+1),e.push(tn),e.push(vt,1),e.push(ss,0),e.push(sn),e.push(sn),e.push(G,L),e.push(Se,l+1)):(F(l,l+2|0),t=t+2|0);break}else F(l,l+1|0);break}case ct:{F(l,l+1|0),t=t+1|0;break}case ue:{F(l,l+2|0),t=t+2|0;break}}break}}break}}break}case Ze:{let{value:_,trail:l}=h,y=_.name||_.link||_.value,I,z=ie.get(y);if(z){let{data:le}=z,Ue=j(le.name,le.path);I=s.get(Ue)}else{let le=He(_);I=s.get(j(le.data?.name,le.data?.path))}let{indivisibles:R}=I,{mapTrail:U}=R,m=JSON.parse(JSON.stringify(l)),N=U.get(l[0]),{address:Y}=N,ee=[Y],w=I;for(;m.length>0;){let le=m.shift();if(m.length>0){let Ue=w.members.get(le),De=j(Ue.name,Ue.path);if(w=s.get(De),w.indivisibles){let{indivisibles:Ee}=w,{mapTrail:ce}=Ee,Le=ce.get(m[0]),{address:je}=Le;ee.push(je)}continue}w=w.members.get(le)}let ne=j(w.name,w.path),se=s.get(ne),{link:oe}=se,{load:xe}=oe,Xe=he.get(y);for(e.push(Se,...g(Xe));ee.length>1;){let le=ee.shift();e.push(O,...g(le)),e.push(q),e.push(xt,ze,Ie)}e.push(O,...g(ee[0])),e.push(q),w.name===fe||w.type===Z||w.layout===Z?(e.push(Ae,L),e.push(G,L),e.push(O,4),e.push(q),e.push(G,L)):e.push(xe.opcode,xe.align,xe.offset);break}}},_e=k=>{let{name:h,currentIndex:A}=k;if(A===0)e.push(Vt,he.size+1);else if(e.push(Se,he.size+1),h==="==")e.push(ti);else if(h==="!=")e.push(si);else throw new Error(`Unknown operator ${h} for objects`)},de=k=>{let{member:h}=k,{isObject:A,index:S,address:P}=h;if(A){e.push(Se,...g(S)),e.push(O,...g(P)),e.push(q),e.push(Se,...g(S)),e.push(O,...g(P+4)),e.push(q);return}e.push(Se,...g(S)),e.push(O,...g(P)),e.push(q)};for(u(c);n.length>0;){let k=n.shift();switch(k.type){case"call":{W(k);break}case"value":{Oe(k);break}case Ft:{de(k);break}case"compare":{_e(k);break}}}return t},ht=c=>{let i=(n,r)=>{for(;n<r;)r=r-1|0,e.push(Vt,r)},t=(n,r)=>{switch(r.type){case pt:{r.name===Z||r.name===fe?i(n,n+2|0):i(n,n+1|0);break}case fe:{i(n,n+2|0);break}case Z:{i(n,n+2|0);break}case Ut:case qt:{let{name:u,path:b}=r,C=j(u,b),M=s.get(C);switch(u){case fe:{i(n,n+2|0);break}case Z:{i(n,n+Number(r.length)|0);break}default:{switch(M.type){case Te:if(u===fe){i(n,n+2|0);break}case ct:{i(n,n+1|0);break}case ue:{let{length:v}=M;i(n,n+2|0);break}}break}}break}}};switch(c.type){case Pe:{let{name:n}=c,r=he.get(n),u=ie.get(n),{data:b}=u;t(r,b);break}case Ze:{let{value:n,trail:r}=c,{name:u}=n,b=ie.get(u),{data:C}=b,M=j(C.name,C.path),v=s.get(M),{indivisibles:W}=v,{mapTrail:Oe}=W,_e=r.join("."),de=JSON.parse(JSON.stringify(r)),k=Oe.get(_e),{index:h}=k,A=v;for(;de.length>0;){let P=de.shift();A=A.members.get(P)}let S=he.get(u);A.type==Z||A.type==fe?i(S+h|0,S+h+2|0):i(S+h|0,S+h+1|0);break}}},us=(c,i)=>{let{array:t,index:n}=c,r=0,u=he.get(t.name),b=()=>{e.push(Se,u)},C=ie.get(t.name),{data:M}=C,{name:v,path:W,segment:Oe}=M,_e=j(v,W),de=s.get(_e);switch(de.type){case Te:{b(),H(n);let{link:k}=de,{store:h}=k;e.push(O,h.size),e.push(Ke),e.push(q),H(i),e.push(h.opcode,h.align,h.offset),r=r+4|0;break}case ue:{let k=null,h=0;if(i.type===Pe){let{name:F}=i;k=ie.get(F),h=he.get(F)}let A=0,S=()=>{},P=(F,ge)=>{b();let{index:_}=ge;e.push(Se,h+_|0);let{link:l}=F,{store:y}=l;e.push(y.opcode,y.align,y.offset+A|0),r=r+1|0,A=A+y.size|0},d=()=>{},{indivisibles:$}=de,{mapTrail:me}=$;for(let F of me.values()){if(F.type===pt){d();continue}let{data:ge}=F,{name:_,path:l}=ge,y=j(_,l),I=s.get(y);switch(I.type){case Te:{P(I,F);break}case ct:{S();break}}}break}}return r},fs=(c,i)=>{let{value:t,trail:n}=c,{name:r}=t,u=ie.get(r),{data:b}=u,C=j(b.name,b.path),M=s.get(C),{indivisibles:v}=M,{mapTrail:W}=v,Oe=n.join("."),_e=JSON.parse(JSON.stringify(n)),de=W.get(Oe),{address:k}=de,h=M;for(;_e.length>0;){let P=_e.shift();if(_e.length>0){let d=h.members.get(P),$=j(d.name,d.path);h=s.get($);continue}h=h.members.get(P)}let A=j(h.name,h.path),S=s.get(A);switch(S.type){case Te:{let{link:P}=S,{store:d}=P,$=he.get(r);e.push(Se,...g($)),e.push(O,...g(k)),e.push(q),H(i),e.push(d.opcode,d.align,d.offset);break}}},Es=(c,i)=>{let{link:t}=c,n=0,{name:r,path:u,segment:b}=He(t),C=j(r,u),M=s.get(C);switch(M.type){case Te:{H(t),H(i);let{link:v}=M,{store:W}=v;e.push(W.opcode,W.align,W.offset),n=n+1|0;break}case ue:{let v=null,W=0,Oe=(d,$,me="")=>{let F=me?`${me}.${d.name}`:d.name,ge=$.get(F);if(ge){let{data:_}=ge,l=j(_.name,_.path),y=s.get(l),{store:I}=y.link;H(t),e.push(O,...g(ge.address)),e.push(q),H(d.value),e.push(I.opcode,I.align,I.offset)}else if(d.value&&d.value.literal)for(let _ of d.value.literal)Oe(_,$,F)};if(i.type===Pe){let{name:d}=i;if(W=he.get(d),c.link.name.startsWith(Ft)){let $=he.get(c.link.name),{name:me,path:F}=ie.get(d),ge=j(me,F),_=s.get(ge),{indivisibles:l}=_,{mapTrail:y}=l;for(let I of y){let{data:z}=I,R=j(z.name,z.path),U=s.get(R),{load:m,store:N}=U.link;e.push(O,...g($)),e.push(O,...g(I.address)),e.push(q),e.push(O,...g(W)),e.push(O,...g(I.address)),e.push(q),e.push(m.opcode,m.align,m.offset),e.push(N.opcode,N.align,N.offset)}return}return H(t),e.push(Se,...g(W)),e.push(ve,ze,Ie),H(t),e.push(O,...g(4)),e.push(q),e.push(Se,...g(W+1|0)),e.push(ve,ze,Ie),n=n+2|0,n}let{literal:_e,name:de,path:k}=i,h=j(de,k),A=s.get(h),{indivisibles:S}=A,{mapTrail:P}=S;for(let d of _e)Oe(d,P)}}return n},hs=(c,i)=>{let{link:t}=i,n=0,r=v=>{let W=Array.from(v.members.values()).reduce((h,A)=>A?h+1:h,0);ye();let{indivisibles:Oe}=v,{mapTrail:_e}=Oe,de=(h,A)=>{let{store:S,load:P}=h.link,{address:d}=_e.get(A);e.push(O,...g(S.size)),te(),H(t),e.push(O,...g(d)),e.push(q),e.push(P.opcode,P.align,P.offset),e.push(S.opcode,S.align,S.offset)},k=(h,A)=>{e.push(O,...g(Yt)),te(),e.push(Ae,Ve);for(let[P,d]of h.members){if(!d)continue;let $=j(d.name,d.path),me=s.get($);if(me.type===ue){Re(),k(me,`${A}.${P}`);continue}let F=`${A}.${P}`;de(me,F)}e.push(G,Ve),e.push(G,Ve),e.push(O,...g(Yt)),e.push(q),e.push(ve,ze,Ie);let S=Array.from(h.members.values()).reduce((P,d)=>d?P+1:P,0);e.push(G,Ve),e.push(O,...g(hi)),e.push(q),e.push(O,...g(S)),e.push(ve,ze,Ie),Ye()};for(let[h,A]of v.members){if(!A)continue;let S=j(A.name,A.path),P=s.get(S);if(P.type===ue){k(P,h);continue}de(P,h)}e.push(G,L),e.push(O,...g(W))},{name:u,path:b}=He(t),C=j(u,b),M=s.get(C);switch(M.type){case Te:case ue:{if(c.type===Pe)return r(M),ht(c),n;break}}return n},bs=(c,i,t)=>{let n=s.get(c),r=b=>{switch(b.type){case Pe:{let{name:C}=b,M=he.get(C);e.push(Se,M);break}case at:{let{literal:C}=b,M=n.type===Te?C:n.evaluate(C),v=g(M);e.push(O,...v);break}}},u=()=>{switch(n.type){case ct:{e.push(Gn),e.push(vt,0);break}case Te:{e.push(Gn),e.push(vt,0);break}}};switch(n.type){case ct:{r(i),r(t),u();break}case Te:{r(i),r(t),u();break}}},p=[],f=c=>{let i={type:Vn,statement:c};p.unshift(i)};p.unshift({type:ft});let x=(c,i)=>{if(c.members)for(let[t,n]of c.members.entries()){let r=j(n?.name,n?.path),u=s.get(r);if(u&&u.type===ue){let b=x(u,r,i);b&&D.push(b)}}return c.members&&c.members.has(Yn)?i:null},D=[];Et.forEach(c=>{let i=j(c.data.name,c.data.path),t=s.get(i);if(t&&t.type===ue){let n=x(t,i);n&&D.push(n)}});let X=D.map(c=>({type:kn,expression:{type:mt,name:Yn,path:c,inputs:[]}}));for(let c of X)f(c);var J=tt.length-1|0;for(let c=J;c>=0;c=c-1|0){let i=tt[c];f(i)}let Q=c=>{let{target:i,source:t}=c;if(i.type===Zr){Es(i,t);return}if(i.type===Hr){us(i,t);return}if(i.type===Ze){fs(i,t);return}if(t.type===kt){let n=ie.get(i.name),{data:r}=n;if(r.path!=="Flogram"){let u=j(r.name,r.path);if(s.get(u).type===ue){hs(i,t);return}}}H(t,"assignment"),ht(i)},V=c=>{let{statements:i}=c;e.push(Lt,Qe),e.push(ts,Qe);let t={type:ft,layout:Zt};p.unshift(t),p.unshift(t),p.unshift({type:Ln});var n=i.length-1|0;for(let r=n;r>=0;r=r-1|0){let u=i[r];f(u)}},pe=c=>{let{statements:i,condition:t}=c;e.push(Lt,Qe),e.push(ts,Qe);let n={type:ft,layout:Zt};p.unshift(n),p.unshift(n),p.unshift({type:Bn,condition:t});var r=i.length-1|0;for(let u=r;u>=0;u=u-1|0){let b=i[u];f(b)}},ae=c=>{let{statements:i,collection:t,index:n,iterator:r}=c;T(c),e.push(O,0),n?e.push(Vt,he.get(n)):e.push(Ae,L),e.push(Lt,Qe),e.push(ts,Qe);let u={type:ft,layout:Zt};p.unshift(u),p.unshift(u),p.unshift({type:Kn,index:n});var b=i.length-1|0;for(let C=b;C>=0;C=C-1|0){let M=i[C];f(M)}p.unshift({type:Mn,collection:t,iterator:r,index:n})},be=c=>{e.push(ss,2)},Ne=c=>{let{branches:i}=c;p.unshift({type:ft});for(let t=i.length-1;t>=0;t--){let n=i[t];switch(n.type){case Xr:{let{statements:r}=n,u=r.length;for(let C=u-1;C>=0;C--){let M=r[C];f(M)}let b=r.find(C=>C.type===en);p.unshift({type:Qs,stop:b}),H(n.values[0]);break}case $r:{let{statements:r}=n,u=r.length;for(let b=u-1;b>=0;b--){let C=r[b];f(C)}p.unshift({type:vn});break}}}},we=c=>{let i=c,{branches:t,values:n}=i;if(t.length>0&&n.length===0)return Ne(c);e.push(Lt,Qe);let u={type:ft};p.unshift(u);let b=[];for(let M of n)switch(M.type){case Pe:{let{name:v}=M,W=ie.get(v),{data:Oe}=W,{name:_e,path:de}=Oe,k=j(_e,de);b.push(k);break}}var C=t.length-1|0;for(let M=C;M>=0;M=M-1|0){let v=t[M],W={type:Un,branch:v,condition:i,commonKeys:b};p.unshift(W)}},ke=c=>{let{expression:i}=c;var n=H(i)|0;for(let r=0;r<n;r=r+1|0)e.push($e)},jt=c=>{let{value:i}=c;H(i),e.push(qe,ii),K("dealloc"),e.push(O,0),ht(i)},Os=c=>{let{values:i}=c;for(let t of i)H(t);e.push(ni)},bt=c=>{e.push(sn)},_s=c=>{e.push(12,0)},Pt=c=>{e.push(oi)},At=c=>{c.stop?(e.push(Hn),e.push(gt)):(e.push(Hn),e.push(Qe))},ds=c=>{let{branch:i,commonKeys:t,condition:n}=c,{values:r}=i,{values:u}=n;var b=t.length|0;for(let v=0;v<b;v=v+1|0){let W=t[v],Oe=r[v],_e=u[v];bs(W,Oe,_e)}let{statements:C}=i;var M=C.length-1|0;for(let v=M;v>=0;v=v-1|0){let W=C[v];f(W)}},Mt=c=>{let{condition:i}=c;H(i),e.push(O,0),e.push(tn),e.push(vt,1),e.push(ss,0)},Kt=c=>{let{collection:i,iterator:t,index:n}=c;H(i);let r=he.get(n);n?e.push(Se,r):e.push(G,L),e.push(tn),e.push(vt,1),e.push($e);let u=Object.freeze({type:Qt,array:i,index:{type:Pe,name:n}}),b=Object.freeze({type:Pe,name:t}),C=Object.freeze({type:Kr,target:b,source:u});f(C)},ot=c=>{let{index:i}=c,t=he.get(i);i?e.push(Se,t):e.push(G,L),e.push(O,1),e.push(q),i?e.push(Vt,t):e.push(Ae,L),e.push(ss,0)},ms=c=>{let{statement:i}=c;switch(i.type){case"assign":{Q(i);break}case Qs:{we(i);break}case Zt:{V(i);break}case Jr:{pe(i);break}case Wr:{ae(i);break}case qr:{be(i);break}case kn:{ke(i);break}case ei:{jt(i);break}case en:{Os(i);break}}};for(;p.length>0;){let c=p.shift();switch(c.type){case ft:{bt(c);break}case Ln:{_s(c);break}case vn:{Pt(c);break}case Qs:{At(c);break}case Un:{ds(c);break}case Vn:{ms(c);break}case Bn:{Mt(c);break}case Mn:{Kt(c);break}case Kn:{ot(c);break}default:break}}return{totalOctets:e,nativeImports:B}}var{HEX_ENCODE:on,LEB128_ENCODE:et}=dt,{TYPES_ASSIGN:bi,TYPES_ARRAY:lt,TYPES_DATA:cs,TYPES_GENERICS:Oi,TYPES_ENUMERATION:wt,TYPES_EXPRESSION:_i,TYPES_LINK:as,TYPES_LOCAL:Tt,TYPES_OBJECT:yt,TYPES_PROCEDURE:cn,TYPES_RETURN:di,TYPES_SELECT:mi,TYPES_MEMBER:gi,TYPES_STORE:an,TYPES_LITERAL:Qn,TYPES_LINK_TO:rs,TYPES_VALUE_AT:is,TYPES_SELF:eo,TYPES_NATIVE:It,TYPES_STRING:zt}=Gt,rn="",Fe=(o,s)=>`${s}.${o}`,xi=o=>[">","<",">=","<=","!=","=="].includes(o),Ti=o=>["FP64","I64","U64","FP32","I32","U32","I16","U16","I8","U8","Bool"].includes(o),pn=48,yi=Object.freeze([0,127]),Ii=Object.freeze({}),zi=Object.freeze([127]),to=0;var Ni=2;var ji=10,Pi=7,Ai=3,Ri=2,Ci=1,Si=6,ut=96,ps=127,ln=Object.freeze([7,105,109,112,111,114,116,115]),Di=Object.freeze([6,109,101,109,111,114,121]),Fi=0;var ki=65,Ge=new Uint8Array(8),Ui=Object.freeze([0,97,115,109]),Li=Object.freeze([1,0,0,0]),vi=(o,s)=>{s=s??Ii;let a={},{data:E,code:T}=o,e=T.filter(p=>!p.description.generics||p.description.generics.length===0),B=new Map,K=new Map,te=p=>{let f=0;for(let x of p){let{data:D}=x;switch(D.type){case"Maybe":case cs:{let{name:X,path:J}=D,Q=Fe(X,J),V=B.get(Q);if(V)switch(V.type){case It:if(X===zt){f=f+2|0;break}case wt:{f=f+1|0;break}case yt:{let{length:pe}=V;f=f+2|0;break}}break}case as:{D.name===lt||D.name===zt?f=f+2|0:f=f+1|0;break}case lt:{f=f+2|0;break}}}return f},re=p=>{let{labels:f}=p,x=new Map;var D=f.length|0;for(let V=0;V<D;V=V+1|0){let{name:pe}=f[V];x.set(pe,V)}return Object.freeze({type:wt,encode:V=>{let pe=x.get(V);return typeof pe>"u"?zi:et(pe)},evaluate:V=>x.get(V),opcode:ki,link:Object.freeze({load:Object.freeze({opcode:40,align:2,offset:0,size:4}),store:Object.freeze({opcode:54,align:2,offset:0,size:4})})})},ye=p=>{let f=[],x=[],D=0,X=()=>{let t=Object.freeze({type:"back"});f.unshift(t)},J=t=>{let n={type:cs,data:t};f.unshift(n)},Q=t=>{let n={type:"name",name:t};f.unshift(n)},V=(t,n)=>{n&&(X(),J(n),Q(t))},pe=t=>E.find(n=>n.name===t),ae=(t,n)=>n.find(r=>r.name===t),be=(t,{inputs:n})=>n.find(r=>r.name===t),Ne=(t,n)=>{let r=t;for(let u of n){let b=ae(u,r.description.members),C=pe(b.data.name);if(C&&C.type===yt)r=C;else return b}return null},we=(t,n)=>{let r=t.trail,u=ae(r[0],n.members);if(!u)return null;if(r.length===1)return u.data;let b=pe(u.data.name);return Ne(b,r.slice(1)).data},ke=(t,n,r,u)=>{if(be(n,r.description))return;r.description.self.push(t);let b=Object.seal({name:n,data:{...we({trail:t.trail||t.value?.trail||t.link?.trail||[]},u),segment:"heap"}});t.type!==rs&&(b.data.type=as),r.description.inputs.push(b)},jt=(t,n,r)=>{let u=t.inputs.map(b=>bt(b,n,r));return{...t,inputs:u}},Os=(t,n,r)=>{if(!(t.value.link===eo||t.value.value===eo))return console.log("THIS IS NOT HANDLED; HANGING"),t;let u=`${t.type}_${t.trail.join("_")}`;if(ke(t,u,n,r),t.value.value)return{type:rs,value:u};if(t.value.link)return{type:is,link:u}},bt=(t,n,r,u="")=>{switch(t.type){case Tt:case Qn:return t;case gi:{let b=`${t.type}_${t.trail.join("_")}`;return ke(t,b,n,r),u==="target"?{type:an,link:{type:Tt,name:b}}:{type:is,link:{type:Tt,name:b}}}case rs:{if(t.value.type===Qn)return t.value;{let b=`${t.value.type}_${t.value.trail.join("_")}`;return ke(t,b,n,r),{type:rs,value:{type:Tt,name:b}}}}case is:{let b=`${t.link.type}_${t.link.trail.join("_")}`;return ke(t,b,n,r),{type:is,link:{type:Tt,name:b}}}case an:{let b=`${t.link.type}_${t.link.trail.join("_")}`;return ke(t,b,n,r),{type:an,link:{type:Tt,name:b}}}case mi:return Os(t,n,r);case _i:return jt(t,n,r);default:return console.log("THIS IS NOT HANDLED; HANGING"),console.log(t),t}},_s=(t,n)=>{let r=JSON.parse(JSON.stringify(t));r.description.self=[];for(let u of r.description.statements)u.type===bi?(u.target=bt(u.target,r,n,"target"),u.source=bt(u.source,r,n)):u.type===di&&(u.values=u.values.map(b=>bt(b,r,n)));e.push(r)},{members:Pt}=p,At=new Map;for(let t of Pt){let{name:n,data:r,value:u}=t;At.set(n,r),u&&At.set(n,{...r,value:u})}var ds=Pt.length-1|0;for(let t=ds;t>=0;t=t-1|0){let n=Pt[t],{name:r,data:u}=n;if(n.type&&n.type===cn){_s(n,p);continue}V(r,u)}let Mt=new Map,Kt=new Map,ot=0;for(;f.length>0;){let t=f.shift();switch(t.type){case"back":{x.pop();break}case cs:{let{data:n}=t,r=()=>{let v=x.join("."),W=Fe(n.name,n.path),Oe=B.get(W),{link:_e}=Oe,de=Object.freeze({data:n,index:ot,address:D,trail:v});n.type===lt||n.layout===lt||n.name===zt?D+=8:D+=_e?.load.size||8,Mt.set(v,de),Kt.set(ot,de),n.type===lt||n.name===zt||n.layout===lt?ot=ot+2|0:ot=ot+1|0};if(n.type===as){r();break}let{name:u,path:b}=n,C=Fe(u,b);switch(B.get(C).type){case It:case wt:{r();break}case yt:{r();break}}break}case"name":{let{name:n}=t;x.push(n);break}}}let ms=ot|0,c=Object.freeze({mapTrail:Mt,mapIndex:Kt});return{type:yt,length:ms,members:At,indivisibles:c}},Re={};for(let p of E){let{path:f}=p;switch(p.type){case It:{let{name:x,path:D}=p,X=Fe(x,D);if(Object.hasOwn(it,X)){let J=it[X];B.set(X,J);continue}break}case"import":{if(Object.hasOwn(it,f)){let x=it[f];B.set(f,x);continue}break}case Oi:{let{name:x,path:D}=p,X=Fe(x,D),J=it["Flogram.FP32"];B.set(X,J);break}case wt:{let{name:x,path:D,description:X}=p,J=Fe(x,D),Q=re(X);B.set(J,Q);break}case yt:{let{name:x,path:D,description:X}=p,{generics:J}=X,Q=Fe(x,D);if(!J||J.length===0){let V=ye(X);B.set(Q,V)}break}}}a.structures=Re;let Ye=0,Bt=(p,f)=>{let x=K.get(p);if(typeof x>"u"){K.set(p,[f]);return}(x.length==0||x.length>0&&x[0].body!==f.body)&&K.set(p,[f,...x])},Je=p=>{let{name:f,path:x}=p,D=Fe(f,x);switch(x==="Flogram"&&(Ti(f)?D=Fe(p.description.inputs[0]?.data?.name?.toLowerCase()+"."+Be(f),x):p.description.outputs&&p.description.outputs.length>=1&&!xi(p.name)?p.description.outputs[0]?.data?.name&&(D=Fe(p.description.outputs[0]?.data?.name?.toLowerCase()+"."+Be(f,p.description.inputs?.length),x)):(Dt.includes(p.description.inputs[1]?.data?.name?.toUpperCase())&&(D=Fe(p.description.inputs[1]?.data?.name?.toUpperCase()+"."+Be(f),x),rn=p.description.inputs[1]?.data?.name?.toUpperCase()),rn&&(D=Fe(rn.toLowerCase()+"."+Be(f),x)))),p.type){case It:{if(Object.hasOwn(St,D)){let X=St[D];Bt(D,X);return}break}case cn:{let{description:X}=p,{inputs:J,outputs:Q}=X,V=Fe(f,x),pe={type:"artificial",index:"artificial"+Ye,procedure:p,lengths:Object.freeze({inputs:te(J),outputs:te(Q)})};Bt(V,pe);break}}Ye=Ye+1|0},Nt=[],We=[];for(let p of e){if(p.description.generics?.length>0)continue;let{description:f}=p,{inputs:x,outputs:D}=f,X=[...x,...D];if(!(p.type===It&&X.some(J=>!Dt.includes(J.data.name))))switch(Je(p),p.type){case"import":{let{path:J}=p;if(Object.hasOwn(St,J))continue;Nt.push(p);break}case cn:{We.push(p);break}}}let Et=p=>{let f=0,x=[];for(let D of p){let X=()=>{x.push(ps),f=f+1|0},J=be=>{let{identity:Ne}=be;x.push(Ne),f=f+1|0},Q=()=>{x.push(ps),f=f+1|0},V=()=>{x.push(ps),f=f+1|0,x.push(ps),f=f+1|0},{name:pe,data:ae}=D;switch(ae.type){case"Maybe":case cs:{let{name:be,path:Ne}=ae,we=Fe(be,Ne),ke=B.get(we);if(!ke)J(it["Flogram.FP32"]);else switch(ke.type){case It:{be===zt?V():J(ke);break}case wt:{X();break}case yt:{V();break}}break}case as:{ae.name===lt||ae.name===zt?V():Q();break}case lt:{V();break}}}return[f,x]},tt=(p,f)=>{let x=f.length|0,D=et(x);f.unshift(p,...D)},he=p=>{let f=[],x=0,D=[...Nt,...We],X=new Map([["alloc",[ut,1,127,1,127]],["dealloc",[ut,1,127,0]],["merge",[ut,0,0]],["save",[ut,2,127,127,0]],["undo",[ut,0,2,127,127]],["undoPenultimate",[ut,0,2,127,127]],["draw",[ut,1,127,0]]]);for(let V of p)if(X.has(V))f.push(...X.get(V));else throw new Error("Procedure not found:",V);for(let V of D){let{description:pe}=V,{inputs:ae,outputs:be}=pe,[Ne,we]=Et(ae),[ke,jt]=Et(be);f.push(ut,Ne,...we,ke,...jt)}let J=D.length|0,Q=et(J+p.size);return f.unshift(...Q),tt(Ci,f),f},ie=()=>{let p=[];return p.push(2),p.push(127,1),p.push(65,0,11),p.push(127,1),p.push(65,0,11),tt(Si,p),p},Ce=0,st=p=>{let f=[],x=0,D={};if(s.memory){let Q=ae=>{let be=[...ae].map(Ne=>Ne.charCodeAt(0));return[be.length,...be]},V=[];for(let ae of p)V.push(Q(ae)),D[ae]={path:ae,description:{inputs:[],outputs:[]}};let pe=Array.from(p);for(let ae of p)Ge.fill(pn),on(x,Ge),f.push(...ln,...V[pe.indexOf(ae)],to,pe.indexOf(ae)),x=x+1|0}for(let Q of Nt){Ge.fill(pn),on(x,Ge);let V=String.fromCodePoint(...Ge);D[V]={path:Q.path,description:Q.description};let pe=x|0;f.push(...ln,Ge.length|0,...Ge,to,pe),x=x+1|0}Ce=x|0,s.memory&&(f.push(...ln,...Di,Ni,...yi),x=x+1|0);let X=x|0,J=et(X);return f.unshift(...J),tt(Ri,f),a.imports=D,f},un=()=>{let p=[];var f=We.length|0;for(let X=0;X<f;X=X+1|0){let J=X|0,Q=Ce+J|0,V=et(Q);p.push(...V)}let x=We.length|0,D=et(x);return p.unshift(...D),tt(Ai,p),p},ls=()=>{let p=[],f=0,x={};var D=We.length|0;for(let Q=0;Q<D;Q=Q+1|0){let V=Q+Ce|0,pe=et(V);Ge.fill(pn),on(f,Ge);let{name:ae,path:be,description:Ne}=We[Q];Ne={inputs:Ne.inputs,outputs:Ne.outputs};let we=String.fromCodePoint(...Ge);x[we]={name:ae,path:be,description:Ne},p.push(Ge.length|0,...Ge,Fi,...pe),f=f+1|0}let X=f|0,J=et(X);return p.unshift(...J),tt(Pi,p),a.procedures=x,p},nt=()=>{let p=[],f=new Set;for(let J of We){let{totalOctets:Q,nativeImports:V}=os(J,B,K,e);f=new Set([...f,...V]);let pe=Q.length|0,ae=et(pe);p.push(...ae,...Q)}let x=We.length|0,D=et(x);return p.unshift(...D),tt(ji,p),p=((J,Q,V)=>{let pe=Array.from(V),ae="artificial";return J.map(be=>{if(typeof be=="string"){if(be.startsWith(ae)){let Ne=be.slice(ae.length),we=parseInt(Ne,10);if(!isNaN(we))return we+Q}if(pe.includes(be))return pe.indexOf(be)}return be})})(p,f.size,f),{totalOctets:p,allImports:f}},He=ie(),{totalOctets:H,allImports:ht}=nt(),us=he(ht),fs=st(ht),Es=ls(),hs=un(),bs=new Uint8Array([...Ui,...Li,...us,...fs,...hs,...He,...Es,...H]);return[a,bs]},Vi=Object.freeze({compile:vi}),yp=Vi;export{yp as default};
