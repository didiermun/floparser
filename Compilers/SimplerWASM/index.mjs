var Ho="as",Xo="=",$o="break",Jo="else",Wo="enum",qo="export",Zo="if",Qo="import",en="->",tn="is",sn="loop",on="mut",nn="native",cn="object",an="fn",rn="return",pn="self",ln="template",un=Object.freeze({ALIAS:Ho,ASSIGN:Xo,BREAK:$o,ELSE:Jo,ENUMERATION:Wo,EXPORT:qo,IF:Zo,IMPORT:Qo,INTO:en,IS:tn,LOOP:sn,MUTABLE:on,NATIVE:nn,OBJECT:cn,PROCEDURE:an,RETURN:rn,SELF:pn,TEMPLATE:ln}),co=un;var fn="assign",En="array_assignment",bn="branch-match",On="branch-default",hn="condition",_n="loop",dn="data",mn="generics",gn="enumeration",xn="expression",Tn="instance",yn="Link",In="local",zn="object",Nn="procedure",jn="return",Pn="select",An="member",Rn="store",Cn="break",Sn="literal",Dn="array_access",Fn="valueLink",kn="linkValue",Un="self",Ln="procedure-call",vn="Maybe",Vn="native",Yn="move",wn="String",Mn="Array",Bn="import",Kn="library",Gn="constructor",Hn="destructor",Xn="free",$n="block-end",Jn="default-block",Wn="continue",qn="branch",Zn="statement",Qn="draw",ec="size",tc="concatenation",sc="foreach",oc="while",nc="while-condition",cc="foreach-condition",ac="foreach-end",rc=Object.freeze({TYPES_ASSIGN:fn,TYPES_ARRAY:Mn,TYPES_ARRAY_ASSIGNMENT:En,TYPES_BRANCH_MATCH:bn,TYPES_BRANCH_DEFAULT:On,TYPES_CONDITION:hn,TYPES_LOOP:_n,TYPES_FOREACH_END:ac,TYPES_WHILE_CONDITION:nc,TYPES_FOREACH_CONDITION:cc,TYPES_DATA:dn,TYPES_GENERICS:mn,TYPES_ENUMERATION:gn,TYPES_EXPRESSION:xn,TYPES_INSTANCE:Tn,TYPES_LINK:yn,TYPES_IMPORT:Bn,TYPES_LOCAL:In,TYPES_OBJECT:zn,TYPES_PROCEDURE:Nn,TYPES_RETURN:jn,TYPES_SELECT:Pn,TYPES_MEMBER:An,TYPES_STORE:Rn,TYPES_BREAK:Cn,TYPES_LITERAL:Sn,TYPES_ARRAY_ACCESS:Dn,TYPES_LINK_TO:Fn,TYPES_VALUE_AT:kn,TYPES_SELF:Un,TYPES_LIBRARY:Kn,TYPES_DROP:Ln,TYPES_MAYBE:vn,TYPES_NATIVE:Vn,TYPES_MOVE:Yn,TYPES_STRING:wn,TYPES_CONSTRUCTOR:Gn,TYPES_FREE:Xn,TYPES_DEFAULT_BLOCK:Jn,TYPES_BLOCK_END:$n,TYPES_CONTINUE:Wn,TYPES_BRANCH:qn,TYPES_STATEMENT:Zn,TYPES_DESTRUCTOR:Hn,TYPES_DRAW:Qn,TYPES_SIZE:ec,TYPES_CONCAT:tc,TYPES_FOREACH:sc,TYPES_WHILE:oc}),fs=rc;var ic=Object.freeze({COLON:58,COMMA:44,DIGIT_ZERO:48,DIGIT_NINE:57,DOT:46,HASHTAG:35,HORIZONTAL_TAB:9,HYPHEN_MINUS:45,LEFT_CURLY_BRACKET:123,LEFT_PARENTHESIS:40,LEFT_SQUARE_BRACKET:91,LINE_BREAK:10,NULL:0,PLUS_SIGN:43,RIGHT_CURLY_BRACKET:125,RIGHT_PARENTHESIS:41,RIGHT_SQUARE_BRACKET:93,SEMICOLON:59,SPACE:32}),ao=ic;var pc=Object.freeze([]),lc=Object.freeze({}),uc="",fc="	",Ec=`
`,bc="UTF-8",Ft=fs,Oc=Object.freeze({EMPTY_ARRAY:pc,EMPTY_OBJECT:lc,EMPTY_STRING:uc,HORIZONTAL_TAB:fc,LINE_BREAK:Ec,UNICODE_TEXT:bc,Codes:ao,Keys:co,Types:fs}),ro=Oc;var{EMPTY_STRING:hc,UNICODE_TEXT:hs}=ro,_c=44,dc=48,mc=57,gc=46,xc=45,Tc=43,yc=65,Ic=90,zc=-1,Nc=1,jc=new TextDecoder(hs),Pc=new TextEncoder,Ac=(s,t,o=0,f=s.length|0,e=0,w=t.length|0)=>{for(e=e|0,o=o|0,w=w|0,f=f|0;;){let U=o>=f,X=e>=w;if(U||X)break;let Ee=s[o],Re=t[e];if(o=o+1|0,e=e+1|0,Ee<Re)return zc;if(Ee>Re)return Nc}return 0},Rc=(s,t,o=0,f=s.length|0,e=0,w=t.length|0)=>{for(e=e|0,o=o|0,w=w|0,f=f|0;;){let U=e>=w,X=o>=f;if(U||X)break;t[e]=s[o],e=e+1|0,o=o+1|0}},Cc=(s,t,o=0,f=s.length|0,e=0,w=t.length|0)=>{o=o|0,e=e|0,f=f|0,w=w|0;let U=f-o|0,X=w-e|0;if(U!==X)return!1;for(;;){let ge=o>=f,Ee=e>=w;if(ge||Ee)break;let Me=s[o],Fe=t[e];if(o=o+1|0,e=e+1|0,Me!==Fe)return!1}return!0},Sc=s=>{s=s>>>0;let t=0,o=0;for(;o=(o<<1|1)>>>0,!(o>s);)t=t+1|0;return t},lo=Object.freeze([48,49,50,51,52,53,54,55,56,57,97,98,99,100,101,102]),Os=(s,t,o,f)=>{for(s=s>>>0,f=f??t.length|0,o=o|0,f=f|0;s>0&&f>o;)f=f-1|0,t[f]=lo[s&15],s=s>>>4},Dc=(s,t,o,f)=>{let e=o|0,w=o+f|0;if(f===0)return!1;let U=t[e];for((U===Tc||U===xc)&&(e=e+1|0);e<w;){let X=t[e];if(e=e+1|0,!(dc<=X&&X<=mc||(gc===X||_c===X)))return!1}return!0},Fc=s=>{let t=s>=yc,o=s<=Ic;return t&&o},Ut=128,Lt=127,uo=-1,pt=64,_s=s=>{s=s|0;let t=[];for(;;){let o=s&Lt;s=s>>7;let f=s===0,e=(o&pt)===0,w=f&&e,U=s===-1,X=(o&pt)!==0;if(w||U&&X){t.push(o);break}o=o|Ut,t.push(o)}return t},kc=s=>{let t=[],o=!0;for(;o;){let f=s&Lt;s>>=7,s===0&&!(f&pt)||s===-1&&f&pt?o=!1:f|=Ut,t.push(f)}return t},fo=(s,t)=>{t=t|0;let o=0,f=0;for(;;){let e=s[t]|0;t=t+1|0;let w=(e&Lt)<<f;if(f=f+7|0,o=o|w,(e&Ut)===0){let X=(e&pt)!==0,ge=f<32;if(X&&ge){let Re=uo<<f;o=o|Re}break}}return o},Uc=(s,t)=>{t=t|0;let o=0,f=0;for(;;){let e=s[t]|0;t=t+1|0;let w=(e&Lt)<<f;if(f=f+7|0,o=o|w,!(e&Ut)){if(e&pt){let U=uo<<f;o=o|U}break}}return o},Lc=s=>jc.decode(s),vc=s=>Pc.encode(s),Vc=(s=hc)=>{let t=s.length|0,o=_s(t),f=Buffer.from(s,hs);return Object.freeze([...o,...f])},Yc=(s,t)=>{t=t|0;let o=fo(s,t),f=_s(o).length;return t=t+f|0,s.subarray(t,t+o|0).toString(hs)},wc=58,Mc=46,yt=32,Es=48,Bc=67,tt=new Uint8Array(Bc),io=tt.subarray(0,8),kt=tt.subarray(10,49),po=tt.subarray(51,68),bs=16,Kc=2;tt[8]=wc;tt[9]=yt;tt[49]=yt;tt[50]=yt;var Gc=(s,t)=>{t=t??console.log;let o=32,f=126,e=s.length|0,w=0;for(;e>0;){io.fill(Es),Os(w,io),kt.fill(yt),po.fill(yt);let U=e>=bs?bs:e;e=e-bs|0;let X=0,ge=0;for(let Re=1;Re<=U;Re=Re+1|0){let Me=s[w]&255;kt[X+0|0]=Es,kt[X+1|0]=Es,Os(Me,kt,X,X+2|0);let Fe=Mc;o<=Me&&Me<=f&&(Fe=Me),po[ge]=Fe,w=w+1|0,X=X+2|0,ge=ge+1|0,Re%Kc===0&&(X=X+1|0)}let Ee=String.fromCodePoint(...tt);t(Ee)}},Hc=function*(s,t){let o=s.length|0,f=t.length|0,e=0;for(;e<o&&e<f;){let w=s[e],U=t[e];yield[w,U],e=e+1|0}},Xc=function*(s,t,o){let f=s.length|0,e=t.length|0,w=o.length|0,U=0;for(;U<f&&U<e&&U<w;){let X=s[U],ge=t[U],Ee=o[U];yield[X,ge,Ee],U=U+1|0}},$c=Object.freeze({ARRAY_COMPARE:Ac,ARRAY_COPY:Rc,ARRAY_EQUAL:Cc,BIT_DEPTH:Sc,HEX_DIGITS:lo,HEX_ENCODE:Os,IS_NUMBER:Dc,IS_UPPERCASE:Fc,LEB128_DECODE:fo,LEB128_DECODE_SIGNED:Uc,LEB128_ENCODE:_s,LEB128_ENCODE_SIGNED:kc,UTF8_DECODE:Lc,UTF8_ENCODE:vc,WASM_STRING_ENCODE:Vc,WASM_STRING_DECODE:Yc,XXD_DUMP_HEX:Gc,ZIP2:Hc,ZIP3:Xc}),lt=$c;var ke=(s,t=2)=>{let o="";switch(s){case"+":o="add";break;case"-":o=t===2?"sub":"neg";break;case"*":o="mul";break;case"/":o="div";break;case"%":o="rem";break;case"==":o="eq";break;case">":o="gt";break;case"<":o="lt";break;case">=":o="ge";break;case"<=":o="le";break;case"!=":o="ne";break;case"&":o="and";break;case"|":o="or";break;case"^":o="xor";break;case"not":o="not";break;case"I32":o="toi32";break;case"U32":o="tou32";break;case"I64":o="toi64";break;case"U64":o="tou64";break;case"FP64":o="tofp64";break;case"FP32":o="tofp32";break}return o};var Jc=Object.freeze({type:"native",body:Object.freeze([160]),lengths:Object.freeze({inputs:2,outputs:1})}),Wc=Object.freeze({type:"native",body:Object.freeze([163]),lengths:Object.freeze({inputs:2,outputs:1})}),qc=Object.freeze({type:"native",body:Object.freeze([162]),lengths:Object.freeze({inputs:2,outputs:1})}),Zc=Object.freeze({type:"native",body:Object.freeze([68,0,0,0,0,0,0,240,191,162]),lengths:Object.freeze({inputs:1,outputs:1})}),Qc=Object.freeze({type:"native",body:Object.freeze([161]),lengths:Object.freeze({inputs:2,outputs:1})}),ea=Object.freeze({type:"native",body:Object.freeze([124]),lengths:Object.freeze({inputs:2,outputs:1})}),ta=Object.freeze({type:"native",body:Object.freeze([128]),lengths:Object.freeze({inputs:2,outputs:1})}),sa=Object.freeze({type:"native",body:Object.freeze([126]),lengths:Object.freeze({inputs:2,outputs:1})}),oa=Object.freeze({type:"native",body:Object.freeze([66,255,255,255,255,255,255,255,255,126]),lengths:Object.freeze({inputs:1,outputs:1})}),na=Object.freeze({type:"native",body:Object.freeze([125]),lengths:Object.freeze({inputs:2,outputs:1})}),ca=Object.freeze({type:"native",body:Object.freeze([124]),lengths:Object.freeze({inputs:2,outputs:1})}),aa=Object.freeze({type:"native",body:Object.freeze([127]),lengths:Object.freeze({inputs:2,outputs:1})}),ra=Object.freeze({type:"native",body:Object.freeze([126]),lengths:Object.freeze({inputs:2,outputs:1})}),Bi=Object.freeze({type:"native",body:Object.freeze([66,255,255,255,255,255,255,255,255,126]),lengths:Object.freeze({inputs:2,outputs:1})}),ia=Object.freeze({type:"native",body:Object.freeze([125]),lengths:Object.freeze({inputs:2,outputs:1})}),Eo=Object.freeze({type:"native",body:Object.freeze([146]),lengths:Object.freeze({inputs:2,outputs:1})}),bo=Object.freeze({type:"native",body:Object.freeze([149]),lengths:Object.freeze({inputs:2,outputs:1})}),Oo=Object.freeze({type:"native",body:Object.freeze([148]),lengths:Object.freeze({inputs:2,outputs:1})}),pa=Object.freeze({type:"native",body:Object.freeze([67,0,0,128,191,148]),lengths:Object.freeze({inputs:2,outputs:1})}),ho=Object.freeze({type:"native",body:Object.freeze([140]),lengths:Object.freeze({inputs:2,outputs:1})}),ds=Object.freeze({type:"native",body:Object.freeze([106]),lengths:Object.freeze({inputs:2,outputs:1})}),ms=Object.freeze({type:"native",body:Object.freeze([110]),lengths:Object.freeze({inputs:2,outputs:1})}),gs=Object.freeze({type:"native",body:Object.freeze([108]),lengths:Object.freeze({inputs:2,outputs:1})}),xs=Object.freeze({type:"native",body:Object.freeze([107]),lengths:Object.freeze({inputs:2,outputs:1})}),Ts=Object.freeze({type:"native",body:Object.freeze([106]),lengths:Object.freeze({inputs:2,outputs:1})}),ys=Object.freeze({type:"native",body:Object.freeze([109]),lengths:Object.freeze({inputs:2,outputs:1})}),Is=Object.freeze({type:"native",body:Object.freeze([108]),lengths:Object.freeze({inputs:2,outputs:1})}),zs=Object.freeze({type:"native",body:Object.freeze([65,1,0,0,0,108]),lengths:Object.freeze({inputs:1,outputs:1})}),Ns=Object.freeze({type:"native",body:Object.freeze([107]),lengths:Object.freeze({inputs:2,outputs:1})}),la=Object.freeze({type:"native",body:Object.freeze([130]),lengths:Object.freeze({inputs:2,outputs:1})}),ua=Object.freeze({type:"native",body:Object.freeze([129]),lengths:Object.freeze({inputs:2,outputs:1})}),js=Object.freeze({type:"native",body:Object.freeze([112]),lengths:Object.freeze({inputs:2,outputs:1})}),Ps=Object.freeze({type:"native",body:Object.freeze([111]),lengths:Object.freeze({inputs:2,outputs:1})}),fa=Object.freeze({type:"native",body:Object.freeze([86]),lengths:Object.freeze({inputs:2,outputs:1})}),Ea=Object.freeze({type:"native",body:Object.freeze([85]),lengths:Object.freeze({inputs:2,outputs:1})}),ba=Object.freeze({type:"native",body:Object.freeze([100]),lengths:Object.freeze({inputs:2,outputs:1})}),As=Object.freeze({type:"native",body:Object.freeze([75]),lengths:Object.freeze({inputs:2,outputs:1})}),Rs=Object.freeze({type:"native",body:Object.freeze([74]),lengths:Object.freeze({inputs:2,outputs:1})}),Oa=Object.freeze({type:"native",body:Object.freeze([94]),lengths:Object.freeze({inputs:2,outputs:1})}),ha=Object.freeze({type:"native",body:Object.freeze([84]),lengths:Object.freeze({inputs:2,outputs:1})}),_a=Object.freeze({type:"native",body:Object.freeze([83]),lengths:Object.freeze({inputs:2,outputs:1})}),da=Object.freeze({type:"native",body:Object.freeze([99]),lengths:Object.freeze({inputs:2,outputs:1})}),Cs=Object.freeze({type:"native",body:Object.freeze([73]),lengths:Object.freeze({inputs:2,outputs:1})}),Ss=Object.freeze({type:"native",body:Object.freeze([72]),lengths:Object.freeze({inputs:2,outputs:1})}),ma=Object.freeze({type:"native",body:Object.freeze([93]),lengths:Object.freeze({inputs:2,outputs:1})}),ga=Object.freeze({type:"native",body:Object.freeze([87]),lengths:Object.freeze({inputs:2,outputs:1})}),xa=Object.freeze({type:"native",body:Object.freeze([88]),lengths:Object.freeze({inputs:2,outputs:1})}),Ta=Object.freeze({type:"native",body:Object.freeze([101]),lengths:Object.freeze({inputs:2,outputs:1})}),Ds=Object.freeze({type:"native",body:Object.freeze([76]),lengths:Object.freeze({inputs:2,outputs:1})}),Fs=Object.freeze({type:"native",body:Object.freeze([77]),lengths:Object.freeze({inputs:2,outputs:1})}),ya=Object.freeze({type:"native",body:Object.freeze([95]),lengths:Object.freeze({inputs:2,outputs:1})}),Ia=Object.freeze({type:"native",body:Object.freeze([89]),lengths:Object.freeze({inputs:2,outputs:1})}),za=Object.freeze({type:"native",body:Object.freeze([90]),lengths:Object.freeze({inputs:2,outputs:1})}),Na=Object.freeze({type:"native",body:Object.freeze([102]),lengths:Object.freeze({inputs:2,outputs:1})}),ks=Object.freeze({type:"native",body:Object.freeze([78]),lengths:Object.freeze({inputs:2,outputs:1})}),Us=Object.freeze({type:"native",body:Object.freeze([79]),lengths:Object.freeze({inputs:2,outputs:1})}),ja=Object.freeze({type:"native",body:Object.freeze([96]),lengths:Object.freeze({inputs:2,outputs:1})}),Pa=Object.freeze({type:"native",body:Object.freeze([81]),lengths:Object.freeze({inputs:2,outputs:1})}),Aa=Object.freeze({type:"native",body:Object.freeze([81]),lengths:Object.freeze({inputs:2,outputs:1})}),Ra=Object.freeze({type:"native",body:Object.freeze([97]),lengths:Object.freeze({inputs:2,outputs:1})}),Ls=Object.freeze({type:"native",body:Object.freeze([70]),lengths:Object.freeze({inputs:2,outputs:1})}),vs=Object.freeze({type:"native",body:Object.freeze([70]),lengths:Object.freeze({inputs:2,outputs:1})}),Ca=Object.freeze({type:"native",body:Object.freeze([91]),lengths:Object.freeze({inputs:2,outputs:1})}),Sa=Object.freeze({type:"native",body:Object.freeze([82]),lengths:Object.freeze({inputs:2,outputs:1})}),Da=Object.freeze({type:"native",body:Object.freeze([82]),lengths:Object.freeze({inputs:2,outputs:1})}),Fa=Object.freeze({type:"native",body:Object.freeze([98]),lengths:Object.freeze({inputs:2,outputs:1})}),Vs=Object.freeze({type:"native",body:Object.freeze([71]),lengths:Object.freeze({inputs:2,outputs:1})}),Ys=Object.freeze({type:"native",body:Object.freeze([71]),lengths:Object.freeze({inputs:2,outputs:1})}),ka=Object.freeze({type:"native",body:Object.freeze([92]),lengths:Object.freeze({inputs:2,outputs:1})}),Ua=Object.freeze({type:"native",body:Object.freeze([113]),lengths:Object.freeze({inputs:2,outputs:1})}),La=Object.freeze({type:"native",body:Object.freeze([114]),lengths:Object.freeze({inputs:2,outputs:1})}),va=Object.freeze({type:"native",body:Object.freeze([115]),lengths:Object.freeze({inputs:2,outputs:1})}),Va=Object.freeze({type:"native",body:Object.freeze([69]),lengths:Object.freeze({inputs:1,outputs:1})}),_o=Object.freeze({type:"native",body:Object.freeze([167]),lengths:Object.freeze({inputs:1,outputs:1})}),mo=Object.freeze({type:"native",body:Object.freeze([167]),lengths:Object.freeze({inputs:1,outputs:1})}),Ya=Object.freeze({type:"native",body:Object.freeze([170]),lengths:Object.freeze({inputs:1,outputs:1})}),wa=Object.freeze({type:"native",body:Object.freeze([171]),lengths:Object.freeze({inputs:1,outputs:1})}),Ma=Object.freeze({type:"native",body:Object.freeze([168]),lengths:Object.freeze({inputs:1,outputs:1})}),Ba=Object.freeze({type:"native",body:Object.freeze([169]),lengths:Object.freeze({inputs:1,outputs:1})}),go=Object.freeze({type:"native",body:Object.freeze([]),lengths:Object.freeze({inputs:1,outputs:1})}),vt=Object.freeze({type:"native",body:Object.freeze([193]),lengths:Object.freeze({inputs:1,outputs:1})}),Vt=Object.freeze({type:"native",body:Object.freeze([192]),lengths:Object.freeze({inputs:1,outputs:1})}),Ka=Object.freeze({type:"native",body:Object.freeze([]),lengths:Object.freeze({inputs:1,outputs:1})}),Ga=Object.freeze({type:"native",body:Object.freeze([]),lengths:Object.freeze({inputs:1,outputs:1})}),Ha=Object.freeze({type:"native",body:Object.freeze([176]),lengths:Object.freeze({inputs:1,outputs:1})}),Xa=Object.freeze({type:"native",body:Object.freeze([177]),lengths:Object.freeze({inputs:1,outputs:1})}),$a=Object.freeze({type:"native",body:Object.freeze([175]),lengths:Object.freeze({inputs:1,outputs:1})}),Ja=Object.freeze({type:"native",body:Object.freeze([174]),lengths:Object.freeze({inputs:1,outputs:1})}),Wa=Object.freeze({type:"native",body:Object.freeze([196]),lengths:Object.freeze({inputs:1,outputs:1})}),qa=Object.freeze({type:"native",body:Object.freeze([196]),lengths:Object.freeze({inputs:1,outputs:1})}),Za=Object.freeze({type:"native",body:Object.freeze([196]),lengths:Object.freeze({inputs:1,outputs:1})}),Qa=Object.freeze({type:"native",body:Object.freeze([196]),lengths:Object.freeze({inputs:1,outputs:1})}),xo=Object.freeze({type:"native",body:Object.freeze([195]),lengths:Object.freeze({inputs:1,outputs:1})}),To=Object.freeze({type:"native",body:Object.freeze([195]),lengths:Object.freeze({inputs:1,outputs:1})}),yo=Object.freeze({type:"native",body:Object.freeze([194]),lengths:Object.freeze({inputs:1,outputs:1})}),Io=Object.freeze({type:"native",body:Object.freeze([194]),lengths:Object.freeze({inputs:1,outputs:1})}),er=Object.freeze({type:"native",body:Object.freeze([185]),lengths:Object.freeze({inputs:1,outputs:1})}),tr=Object.freeze({type:"native",body:Object.freeze([186]),lengths:Object.freeze({inputs:1,outputs:1})}),ws=Object.freeze({type:"native",body:Object.freeze([183]),lengths:Object.freeze({inputs:1,outputs:1})}),Ms=Object.freeze({type:"native",body:Object.freeze([184]),lengths:Object.freeze({inputs:1,outputs:1})}),sr=Object.freeze({type:"native",body:Object.freeze([187]),lengths:Object.freeze({inputs:1,outputs:1})}),or=Object.freeze({type:"native",body:Object.freeze([180]),lengths:Object.freeze({inputs:1,outputs:1})}),nr=Object.freeze({type:"native",body:Object.freeze([181]),lengths:Object.freeze({inputs:1,outputs:1})}),Bs=Object.freeze({type:"native",body:Object.freeze([178]),lengths:Object.freeze({inputs:1,outputs:1})}),Ks=Object.freeze({type:"native",body:Object.freeze([179]),lengths:Object.freeze({inputs:1,outputs:1})}),cr=Object.freeze({type:"native",body:Object.freeze([182]),lengths:Object.freeze({inputs:1,outputs:1})}),It=Object.freeze(Object.assign({"Flogram./":bo,"Flogram.*":Oo,"Flogram.+":Eo,"Flogram.-":ho},{"Flogram.fp64.div":Wc,"Flogram.fp64.mul":qc,"Flogram.fp64.add":Jc,"Flogram.fp64.sub":Qc,"Flogram.fp64.neg":Zc,"Flogram.fp64.gt":ba,"Flogram.fp64.lt":da,"Flogram.fp64.le":Ta,"Flogram.fp64.ge":Na,"Flogram.fp64.ne":Fa,"Flogram.fp64.eq":Ra,"Flogram.fp64.toi32":Ya,"Flogram.fp64.tou32":wa,"Flogram.fp64.tou64":Xa,"Flogram.fp64.toi64":Ha,"Flogram.fp64.tofp32":cr},{"Flogram.u64.add":ea,"Flogram.u64.sub":na,"Flogram.u64.mul":sa,"Flogram.u64.div":ta,"Flogram.u64.rem":la,"Flogram.u64.gt":fa,"Flogram.u64.lt":ha,"Flogram.u64.le":xa,"Flogram.u64.ge":za,"Flogram.u64.ne":Da,"Flogram.u64.eq":Aa,"Flogram.u64.toi32":mo,"Flogram.u64.tou32":mo,"Flogram.u64.toi64":Ka,"Flogram.u64.tofp32":nr,"Flogram.u64.tofp64":tr},{"Flogram.i64.add":ca,"Flogram.i64.sub":ia,"Flogram.i64.neg":oa,"Flogram.i64.mul":ra,"Flogram.i64.div":aa,"Flogram.i64.rem":ua,"Flogram.i64.gt":Ea,"Flogram.i64.lt":_a,"Flogram.i64.le":ga,"Flogram.i64.ge":Ia,"Flogram.i64.ne":Sa,"Flogram.i64.eq":Pa,"Flogram.i64.toi32":_o,"Flogram.i64.tou32":_o,"Flogram.i64.tou64":Ga,"Flogram.i64.tofp32":or,"Flogram.i64.tofp64":er},{"Flogram.fp32.div":bo,"Flogram.fp32.mul":Oo,"Flogram.fp32.add":Eo,"Flogram.fp32.sub":ho,"Flogram.fp32.neg":pa,"Flogram.fp32.gt":Oa,"Flogram.fp32.lt":ma,"Flogram.fp32.le":ya,"Flogram.fp32.ge":ja,"Flogram.fp32.ne":ka,"Flogram.fp32.eq":Ca,"Flogram.fp32.toi32":Ma,"Flogram.fp32.tou32":Ba,"Flogram.fp32.tou64":$a,"Flogram.fp32.toi64":Ja,"Flogram.fp32.tofp64":sr},{"Flogram.u32.add":ds,"Flogram.u32.sub":xs,"Flogram.u32.mul":gs,"Flogram.u32.div":ms,"Flogram.u32.rem":js,"Flogram.u32.gt":As,"Flogram.u32.lt":Cs,"Flogram.u32.le":Fs,"Flogram.u32.ge":Us,"Flogram.u32.ne":Ys,"Flogram.u32.eq":vs,"Flogram.u32.toi32":go,"Flogram.u32.toi64":Za,"Flogram.u32.tou64":Qa,"Flogram.u32.tofp32":Ks,"Flogram.u32.tofp64":Ms},{"Flogram.i32.add":Ts,"Flogram.i32.sub":Ns,"Flogram.i32.neg":zs,"Flogram.i32.mul":Is,"Flogram.i32.div":ys,"Flogram.i32.rem":Ps,"Flogram.i32.gt":Rs,"Flogram.i32.lt":Ss,"Flogram.i32.le":Ds,"Flogram.i32.ge":ks,"Flogram.i32.ne":Vs,"Flogram.i32.eq":Ls,"Flogram.i32.toi64":Wa,"Flogram.i32.tou64":qa,"Flogram.i32.tou32":go,"Flogram.i32.tofp32":Bs,"Flogram.i32.tofp64":ws},{"Flogram.i16.add":Ts,"Flogram.i16.sub":Ns,"Flogram.i16.neg":zs,"Flogram.i16.mul":Is,"Flogram.i16.div":ys,"Flogram.i16.rem":Ps,"Flogram.i16.gt":Rs,"Flogram.i16.lt":Ss,"Flogram.i16.le":Ds,"Flogram.i16.ge":ks,"Flogram.i16.ne":Vs,"Flogram.i16.eq":Ls,"Flogram.i16.toi32":vt,"Flogram.i16.tou32":vt,"Flogram.i16.toi64":xo,"Flogram.i16.tou64":To,"Flogram.i16.tofp32":Bs,"Flogram.i16.tofp64":ws},{"Flogram.u16.add":ds,"Flogram.u16.sub":xs,"Flogram.u16.mul":gs,"Flogram.u16.div":ms,"Flogram.u16.rem":js,"Flogram.u16.gt":As,"Flogram.u16.lt":Cs,"Flogram.u16.le":Fs,"Flogram.u16.ge":Us,"Flogram.u16.ne":Ys,"Flogram.u16.eq":vs,"Flogram.u16.toi32":vt,"Flogram.u16.tou32":vt,"Flogram.u16.toi64":xo,"Flogram.u16.tou64":To,"Flogram.u16.tofp32":Ks,"Flogram.u16.tofp64":Ms},{"Flogram.i8.add":Ts,"Flogram.i8.sub":Ns,"Flogram.i16.neg":zs,"Flogram.i8.mul":Is,"Flogram.i8.div":ys,"Flogram.i8.rem":Ps,"Flogram.i8.gt":Rs,"Flogram.i8.lt":Ss,"Flogram.i8.le":Ds,"Flogram.i8.ge":ks,"Flogram.i8.ne":Vs,"Flogram.i8.eq":Ls,"Flogram.i8.toi32":Vt,"Flogram.i8.tou32":Vt,"Flogram.i8.toi64":yo,"Flogram.i8.tou64":Io,"Flogram.i8.tofp32":Bs,"Flogram.i8.tofp64":ws},{"Flogram.u8.add":ds,"Flogram.u8.sub":xs,"Flogram.u8.mul":gs,"Flogram.u8.div":ms,"Flogram.u8.rem":js,"Flogram.u8.gt":As,"Flogram.u8.lt":Cs,"Flogram.u8.le":Fs,"Flogram.u8.ge":Us,"Flogram.u8.ne":Ys,"Flogram.u8.eq":vs,"Flogram.u8.toi32":Vt,"Flogram.u8.tou32":Vt,"Flogram.u8.toi64":yo,"Flogram.u8.tou64":Io,"Flogram.u8.tofp32":Ks,"Flogram.u8.tofp64":Ms},{"Flogram.bool.and":Ua,"Flogram.bool.or":La,"Flogram.bool.xor":va,"Flogram.bool.not":Va}));var{LEB128_ENCODE:Ue}=lt,Hi=new Int8Array(1),Xi=new Uint8Array(1),ar=s=>{let t=[],o=!0;for(;o;){let f=s&127;s>>=7,s===0&&!(f&64)||s===-1&&f&64?o=!1:f|=128,t.push(f)}return new Uint8Array(t)},rr=s=>{let t=[],o=!0;for(;o;){let f=s&127;s>>=7,s===0?o=!1:f|=128,t.push(f)}return new Uint8Array(t)},ir=s=>{let t=[];for(;s>=128;)t.push(s&127|128),s>>>=7;return t.push(s),new Uint8Array(t)},pr=128,lr=127,zo=64,ur=s=>{s=s<<16>>16;let t=[];for(;;){let o=s&lr;s=s>>7;let f=s===0,e=(o&zo)===0,w=f&&e,U=s===-1,X=(o&zo)!==0;if(w||U&&X){t.push(o);break}o=o|pr,t.push(o)}return t};var fr=s=>{let t=new Float32Array(1);return t[0]=parseFloat(s),new Uint8Array(t.buffer)},No=s=>{let t=[],o=!0;for(;o;){let f=s&127;s>>=7,s===0&&!(f&64)||s===-1&&f&64?o=!1:f|=128,t.push(f)}return new Uint8Array(t)},Er=s=>Ue(s),br=s=>{let t=new Float64Array(1);return t[0]=s,new Uint8Array(t.buffer)},Or=s=>{let t=[];for(;s>=128;)t.push(s&127|128),s>>>=7;return t.push(s),new Uint8Array(t)},hr=s=>{let t=[],o=!0;for(;o;){let f=s&127;s>>=7,s===0&&!(f&64)||s===-1&&f&64?o=!1:f|=128,t.push(f)}return new Uint8Array(t)},_r=s=>{let t=new Uint8Array(1);return t[0]=s==="TRUE"?1:s==="FALSE"?0:s,t},dr=s=>{let t=s.charCodeAt(0);return Ue(t)},jo=()=>{let s=new ArrayBuffer(4);return new Float32Array(s)[0]=-0,[...new Uint8Array(s)]},mr=Object.freeze({type:"native",identity:127,opcode:65,encode:No,link:Object.freeze({load:Object.freeze({opcode:40,align:2,offset:0,size:4}),store:Object.freeze({opcode:54,align:2,offset:0,size:4})})}),gr=Object.freeze({type:"native",identity:127,opcode:65,none:Ue(-1),encode:dr,link:Object.freeze({load:Object.freeze({opcode:44,align:2,offset:0,size:4}),store:Object.freeze({opcode:54,align:2,offset:0,size:4})})}),xr=Object.freeze({type:"native",identity:127,opcode:65,none:Ue(-1),encode:_r,link:Object.freeze({load:Object.freeze({opcode:40,align:2,offset:0,size:4}),store:Object.freeze({opcode:54,align:2,offset:0,size:4}),values:{TRUE:1,FALSE:0}})}),Tr=Object.freeze({type:"native",identity:124,opcode:68,none:jo(),encode:br,link:Object.freeze({load:Object.freeze({opcode:43,align:3,offset:0,size:8}),store:Object.freeze({opcode:57,align:3,offset:0,size:8})})}),yr=Object.freeze({type:"native",identity:126,opcode:66,none:Ue(-1),encode:Or,link:Object.freeze({load:Object.freeze({opcode:43,align:3,offset:0,size:8}),store:Object.freeze({opcode:57,align:3,offset:0,size:8})})}),Ir=Object.freeze({type:"native",identity:126,opcode:66,none:Ue(-9223372036854776e3),encode:hr,link:Object.freeze({load:Object.freeze({opcode:43,align:3,offset:0,size:8}),store:Object.freeze({opcode:57,align:3,offset:0,size:8})})}),zr=Object.freeze({type:"native",identity:125,opcode:67,none:jo(),encode:fr,link:Object.freeze({load:Object.freeze({opcode:42,align:2,offset:0,size:4}),store:Object.freeze({opcode:56,align:2,offset:0,size:4})})}),Nr=Object.freeze({type:"native",identity:127,opcode:65,none:Ue(-1),encode:Er,link:Object.freeze({load:Object.freeze({opcode:40,align:2,offset:0,size:4}),store:Object.freeze({opcode:54,align:2,offset:0,size:4})})}),jr=Object.freeze({type:"native",identity:127,opcode:65,none:Ue(-2147483648),encode:No,link:Object.freeze({load:Object.freeze({opcode:40,align:2,offset:0,size:4}),store:Object.freeze({opcode:54,align:2,offset:0,size:4})})}),Pr=Object.freeze({type:"native",identity:127,opcode:65,none:Ue(-32768),encode:ur,link:Object.freeze({load:Object.freeze({opcode:40,align:2,offset:0,size:4}),store:Object.freeze({opcode:54,align:2,offset:0,size:4})})}),Ar=Object.freeze({type:"native",identity:127,opcode:65,encode:ir,none:Ue(-1),link:Object.freeze({load:Object.freeze({opcode:40,align:2,offset:0,size:4}),store:Object.freeze({opcode:54,align:2,offset:0,size:4})})}),Rr=Object.freeze({type:"native",identity:127,opcode:65,none:Ue(-128),encode:ar,decode:s=>new Int8Array([s])[0],link:Object.freeze({load:Object.freeze({opcode:44,align:0,offset:0,size:4}),store:Object.freeze({opcode:58,align:0,offset:0,size:4})})}),Cr=Object.freeze({type:"native",identity:127,opcode:65,none:Ue(-1),encode:rr,link:Object.freeze({load:Object.freeze({opcode:43,align:0,offset:0,size:4}),store:Object.freeze({opcode:58,align:0,offset:0,size:4})})}),st=Object.freeze({"Flogram.String":mr,"Flogram.Char":gr,"Flogram.Bool":xr,"Flogram.FP64":Tr,"Flogram.U64":yr,"Flogram.I64":Ir,"Flogram.FP32":zr,"Flogram.U32":Nr,"Flogram.I32":jr,"Flogram.I16":Pr,"Flogram.U16":Ar,"Flogram.I8":Rr,"Flogram.U8":Cr});var Sr=Object.freeze(["FP64","U64","I64","FP32","U32","I32","U16","I16","U8","I8","Bool","Char","Array","String","Link","Maybe"]),zt=Sr;var{TYPES_ASSIGN:Dr,TYPES_DRAW:Fr,TYPES_ARRAY:pe,TYPES_ARRAY_ASSIGNMENT:kr,TYPES_BRANCH_MATCH:Ur,TYPES_BRANCH_DEFAULT:Lr,TYPES_CONDITION:Gs,TYPES_LOOP:Yt,TYPES_WHILE:vr,TYPES_FOREACH:Vr,TYPES_DATA:wt,TYPES_GENERICS:np,TYPES_ENUMERATION:Ge,TYPES_EXPRESSION:ut,TYPES_INSTANCE:cp,TYPES_LINK:Ze,TYPES_LOCAL:_e,TYPES_CONCAT:Yr,TYPES_OBJECT:de,TYPES_PROCEDURE:ap,TYPES_RETURN:Hs,TYPES_SELECT:ft,TYPES_MEMBER:Nt,TYPES_STORE:wr,TYPES_BREAK:Mr,TYPES_LITERAL:we,TYPES_ARRAY_ACCESS:Po,TYPES_LINK_TO:Xs,TYPES_VALUE_AT:Mt,TYPES_SELF:rp,TYPES_DROP:Ao,TYPES_MAYBE:jt,TYPES_MOVE:Br,TYPES_NATIVE:me,TYPES_STRING:ye,TYPES_FREE:Kr,TYPES_BRANCH:Ro,TYPES_CONTINUE:Co,TYPES_DEFAULT_BLOCK:So,TYPES_BLOCK_END:at,TYPES_STATEMENT:Do,TYPES_DESTRUCTOR:Fo,TYPES_SIZE:$s,TYPES_WHILE_CONDITION:ko,TYPES_FOREACH_CONDITION:Uo,TYPES_FOREACH_END:Lo}=Ft,Pt=2,Bt=3,Kt=12,At=13,Z=16,Gt=26,C=65,vo=71,Gr=113,Hr=114,Js=70,Ie=32,Ht=33,ae=35,Pe=36,Xr=15,Ws=11,Vo=4,$r=5,He=64,Et=127,Xt=108,Jr=109,Te=106,Wr=107,Qe=54,qr=40,Xe=0,$e=2,Ae=0,Zr=1,Yo=2,wo=3,Qr=4,ei=5,ot=6,ti=999999,si=888888,oi=777777,re=0,je=1,ni=4,$t=8,ci="Flogram.draw",ai=new Set(["==","!=",">",">=","<","<=","!","&","|"]),{LEB128_ENCODE:k}=lt,qs,P=(s,t)=>`${t}.${s}`,Mo=(s,t,o)=>{let f=o.get(s);if(f&&f.length===1)return f[0];if(f&&f.length>1)return f[0];throw console.log(s),console.log(o),Error("No Callees were found")};function Jt(s,t,o,f){s?.description?.inputs.length>0?qs=s.description.inputs[0].data.name:s?.description?.outputs.length>0&&(qs=s.description.outputs[0].data.name);let e=[],w=(n=re)=>{e.push(C,0),e.push(Z,Ae),e.push(Pe,n)},U=()=>{e.push(ae,re),e.push(ae,je),e.push(Z,wo),e.push(ae,je),e.push(ae,re),e.push(Z,wo)},X=()=>{e.push(Z,Qr),e.push(Pe,je),e.push(Pe,re)},ge=()=>{e.push(Z,ei),e.push(Pe,je),e.push(Pe,re)},Ee=()=>{e.push(Z,Yo)},{description:Re}=s,{inputs:Me,locals:Fe,statements:_t}=Re,fe=new Map,q=new Map;{let n=0,a=r=>{for(let i of r){let{name:h,data:y}=i;switch(fe.set(h,n),q.set(h,i),y.type){case jt:case wt:{let{name:c,path:p}=y,b=P(c,p);switch(c){case ye:{n=n+2|0;break}default:{let m=t.get(b);switch(m.type){case me:{n=n+1|0;break}case Ge:{n=n+1|0;break}case de:{let{length:D}=m;n=n+2|0;break}}break}}break}case pe:{n=n+2|0;break}case Ze:{y.name===ye||y.name===pe?n=n+2|0:n=n+1|0;break}}}};a(Me),a(Fe)}let be=0,Be=[];for(let n of Fe){let{data:a}=n,r=()=>{Be.push(1,Et),be=be+1|0},i=()=>{Be.push(1,Et),be=be+1|0,Be.push(1,Et),be=be+1|0},h=()=>{Be.push(1,Et),be=be+1|0},y=p=>{let{identity:b}=p;Be.push(1,b),be=be+1|0},c=p=>{let{indivisibles:b}=p,{mapTrail:m}=b;for(let D of m.values()){let{data:te}=D;if(te.type===Ze){te.name===pe||te.name===ye?i():r();continue}if(te.type===pe){i();continue}let{name:le,path:W}=te,A=P(le,W),O=t.get(A);switch(O.type){case me:{y(O);break}case Ge:{h();break}}}};switch(a.type){case pe:{i();break}case Ze:{a.name===pe||a.name===ye?i():r();break}case jt:case wt:{let{name:p,path:b}=a;switch(p){case ye:{i();break}default:{let m=P(p,b),D=t.get(m);switch(D.type){case me:{y(D);break}case Ge:{h();break}case de:{i();break}}break}}break}}}((n,a)=>{for(let[r,i]of n)if(i.type==a){Be.push(1,Et),be=be+1|0;break}})(t,de);let ss=k(be);e.push(...ss,...Be);let et=n=>{if(typeof n!==de)return n;switch(n.type){case _e:return n.name;case Xs:return et(n.value);case Mt:return et(n.link);case Nt:return`${n.type}_${n.trail.join("_")}`}return null},dt=n=>{switch(n.type){case we:return n;case _e:return q.get(n.name)?.data;case $s:if(input.value.type===_e)return{name:"I32",path:"Flogram",type:"data"}}},J=(n,a=Hs)=>{let r=0,i=[],h=(A,O)=>{let S={type:"call",key:A,inputs:O};i.unshift(S)},y=A=>{let O={type:"value",value:A};i.unshift(O)},c=A=>{let O={type:Nt,member:A};i.unshift(O)},p=(A,O,S,F)=>{let L={key:null,stop:!1},d;if(A&&zt.includes(A.data.name)){let{data:ue}=A,{name:g}=ue;d=P(g.toLowerCase()+"."+ke(S),O),qs=g}else if(A){let{data:ue}=A,{name:g,path:se}=ue,_=P(g,se),l=t.get(_),{indivisibles:x}=l,{mapTrail:I}=x,j=I.size-1;for(let[B,z]of I){i.unshift({type:"compare",currentIndex:j,name:S}),d=P(z.data.name.toLowerCase()+"."+ke(S),z.data.path);let R=F.map(K=>({type:ft,value:{type:_e,name:K.name},trail:[z.trail]}));h(d,R);var Y=R.length-1|0;for(let K=Y;K>=0;K=K-1|0){let G=R[K];y(G)}j--}L.stop=!0}return L.key=d,L},b=A=>{let{inputs:O}=A;if(O.find(F=>F.type==ut)){let F=O.map(d=>{if(d.type===_e)return q.get(d.name);if(d.type===we)return{data:d};if(d.type===ut)return{data:{name:b(d)}}}),L=f.find(d=>d.description&&Array.isArray(d.description.inputs)?d.description.inputs.length!==F.length?!1:d.description.inputs.every((Y,ue)=>Y.data.name===F[ue].data.name):!1);return L?L.description.outputs[0].data.name:"unknown"}else{let F=O.map(d=>{if(d.type===_e)return q.get(d.name);if(d.type===we)return{data:d}}),L=f.find(d=>d.description&&Array.isArray(d.description.inputs)?d.description.inputs.length!==F.length?!1:d.description.inputs.every((Y,ue)=>Y.data.name===F[ue].data.name):!1);return L?L.description.outputs[0].data.name:"unknown"}},m=A=>{let{inputs:O,name:S,path:F}=A,L=P(S,F),d=[F],Y;if(typeof S===de){let g=S[0];if(Y=q.get(g),Y){d.push(Y.data.name);for(let _=1;_<=S.length-2;_++)g=S[_],Y=q.get(g),Y&&d.push(Y.data.name)}let se=S.length-1|0;L=P(S[se],d.join("."))}if(F==="Flogram"&&S!==Fr){let g=O.find(l=>l.type===ut),se=O.find(l=>l.type===we),_=O.map(l=>q.get(l.name)).find(Boolean);if(_){let l=p(_,F,S,O);if(L=l.key,l.stop)return}else if(se)L=P(`${se.name.toLowerCase()}.${ke(S)}`,F);else if(g)L=P(`${b(g).toLowerCase()}.${ke(S)}`,F);else{let l=f.find(x=>x.name===A.name&&x.path===A.path&&x.description.inputs.length===A.inputs.length);L=P(`${ai.has(l.name)?l.description.inputs[0]?.data.name.toLowerCase():l.description.outputs[0]?.data.name.toLowerCase()}.${ke(l.name)}`,F)}}if(h(L,O),typeof S===de){let g=Mo(L,O,o);if(g){let{procedure:se}=g,{description:_}=se,{self:l}=_,x=q.get(S[0]),I=P(x.data.name,x.data.path),j=t.get(I);if(j){let B=fe.get(S[0]),{indivisibles:z,members:R}=j,{mapTrail:K}=z;for(let G=l.length-1|0;G>=0;G--){let N=l[G];if(N.type===Nt){let $=N.trail.join(".");if(K.get($)){let{address:oe}=K.get($);c({index:B,address:oe})}else{let oe=JSON.parse(JSON.stringify(N.trail)),ne=j;for(;oe.length>0;){let it=oe.shift();if(oe.length>0){let no=ne.members.get(it),Go=P(no.name,no.path);ne=t.get(Go);continue}ne=ne.members.get(it)}let ee=P(ne.name,ne.path),ce=t.get(ee),{indivisibles:ze}=ce,{mapIndex:Ne,mapTrail:qe}=ze,Oe=Ne.get(0),Ye=`${$}.${Oe.trail}`,{address:Ke}=K.get(Ye),us={index:B,address:Ke-8};c(us)}}}}}}var ue=O.length-1|0;for(let g=ue;g>=0;g=g-1|0){let se=O[g];y(se)}},D=A=>{let{key:O,inputs:S}=A;if(O===ci){for(let d of S){let Y;d.type===we?Y=d:d.type===_e?Y=q.get(d.name)?.data:d.type===$s&&d.value.type===_e&&(Y={name:"I32",path:"Flogram",type:"data"}),Y?.name===ye?(e.push(C,...k(si)),e.push(Z,ot),J(d),e.push(Z,ot),e.push(Z,ot)):Y?.name===pe||Y?.layout===pe?(e.push(C,...k(ti)),e.push(Z,ot),J(d),e.push(Z,ot),e.push(Z,ot)):(J(d),e.push(Z,ot))}e.push(C,...k(oi)),e.push(Z,ot);return}let F=Mo(O,S,o);switch(F.type){case me:{let{body:d}=F;e.push(...d);break}case"artificial":{let{index:d}=F,Y=k(d);e.push(Z,...Y);break}}let{lengths:L}=F;r=r-L.inputs|0,r=r+L.outputs|0},te=A=>{let{value:O}=A,S=_=>{let l=0,x=et(_),I;if(_.type===ft){let{value:j,trail:B}=JSON.parse(JSON.stringify(_)),{name:z}=j,R=q.get(z),{data:K}=R,G=P(K.name,K.path),N=t.get(G),{indivisibles:$}=N,{mapTrail:oe}=$,ne=B.join("."),ee=JSON.parse(JSON.stringify(B)),ce=N;for(;ee.length>0;){let Ne=ee.shift();if(ee.length>0){let qe=ce.members.get(Ne),Oe=P(qe.name,qe.path);ce=t.get(Oe);continue}ce=ce.members.get(Ne)}let ze=P(ce.name,ce.path);I=t.get(ze)}else{let j=q.get(x),{data:B}=j,{name:z,path:R,segment:K}=B,G=P(z,R);I=t.get(G)}if(I){switch(I.type){case me:{te({value:_});let{link:j}=I,{load:B}=j;e.push(B.opcode,B.align,B.offset),l=l+1|0;break}case de:{let j=0,B=()=>{},z=N=>{te({value:_});let{link:$}=N,{load:oe}=$;e.push(oe.opcode,oe.align,oe.offset+j|0),l=l+1|0,j=j+oe.size|0},R=()=>{},{indivisibles:K}=I,{mapTrail:G}=K;for(let N of G.values()){if(N.type===Ze){R();continue}let{data:$}=N,{name:oe,path:ne}=$,ee=P(oe,ne),ce=t.get(ee);switch(ce.type){case me:{z(ce);break}case Ge:{B();break}}}break}}return l}},F=(_,l)=>{let x=0,{literal:I,name:j,path:B}=_,z=I.length;_.length&&(z=parseInt(_.length,10));let R=P(j,B),K=t.get(R);function G(N){let $=0,{literal:oe,name:ne,path:ee}=N,ce=oe.length;N.length&&(ce=parseInt(N.length,10));let ze=P(ne,ee),Ne=t.get(ze);w();for(let qe=0;qe<ce;qe++){let Oe=oe[qe];if(Oe)if(Oe.name===ye&&N.layout===pe||Oe.layout===pe){let Ye=[];if(Oe.layout===pe)Ye.push(Oe.literal),G(Oe);else{let Ke=Oe.literal.length;for(let it=0;it<Ke;it++)Ye.push({type:Oe.type,path:Oe.path,name:"I32",literal:Oe.literal[it].charCodeAt().toString()});let us={type:we,name:"I32",layout:pe,path:Oe.path,literal:Ye};G(us)}e.push(C,...k(4)),e.push(Z,Ae),e.push(ae,re),e.push(Qe,$e,Xe),e.push(C,...k(4)),e.push(Z,Ae),e.push(C,...k(Ye.length)),e.push(Qe,$e,Xe)}else switch(Ne.type){case me:{let{link:Ye}=Ne,{store:Ke}=Ye;e.push(C,...k(Ke.size)),e.push(Z,Ae),!Oe||Oe.type===we?e.push(Ne.opcode,...Ne.encode(Oe?.literal||0)):J(Oe),e.push(Ke.opcode,Ke.align,Ke.offset),Ee(),$=3;break}}}}return G(_),l?z:(e.push(ae,re),e.push(C,...k(z)),x=1,x)},L=(_,l,x=!0)=>{let I=t.get(l);w();let j=G=>{U(),ge(),e.push(ae,re),e.push(ae,je),e.push(ae,je),X(),e.push(ae,re),e.push(Qe,$e,Xe),e.push(C,...k(4)),e.push(Te),e.push(C,...k(G)),e.push(Qe,$e,Xe),e.push(Pe,re)};for(let[G,N]of I.members){if(!N)continue;e.push(C,0),e.push(Z,Ae),e.push(Pe,je);let $=_.find(ee=>ee.name===G),oe=P(N.name,N.path),ne=t.get(oe);if(N.type===pe){if(e.push(C,...k($t)),e.push(Z,Ae),e.push(Pe,je),$.value.type===_e){let ee=fe.get($.value.name);U();let ce=Y(N,ee);j(ce),Ee()}else{U();let ee=F($.value,!0);j(ee),Ee()}continue}switch(ne.type){case me:{let{link:ee}=ne,{store:ce}=ee;if(N.type===Ze)U(),e.push(C,...k(4)),e.push(Z,Ae),J($.value),e.push(ce.opcode,ce.align,ce.offset),X();else{e.push(C,...k(ce.size)),e.push(Z,Ae);let ze=JSON.parse(JSON.stringify($.value));ze.literal&&(ze.name!==N.name||ze.path!==N.path)&&(ze={...ze,name:N.name,path:N.path}),J(ze),e.push(ce.opcode,ce.align,ce.offset)}Ee();break}case de:{e.push(C,...k($t)),e.push(Z,Ae),e.push(Pe,je),U();let ee=L($.value.literal,oe,!1);j(ee),Ee();break}}}function B(G){let N=0;for(let $ of G.values())$.data.type===pe&&(N+=parseInt($.data.length,10)+1);return N}let z=Array.from(I.indivisibles.mapTrail.entries()).reduce((G,N)=>N[1].address>G[1].address?N:G,[null,{address:0}]),R=B(I.indivisibles.mapTrail),K=z[1].address/4+1+R;return x&&(e.push(ae,re),e.push(C,...k(K))),K},d=(_,l)=>{let x=0,I=q.get(l),j;if(I){let{data:z}=I,{name:R,path:K,segment:G}=z;j=P(R,K)}else{let z=R=>{if(R.type===we)return P(R.name,R.path);if(R.type===ut)return z(R.inputs[0]);if(R.type===Mt)return z(R.link);if(R.type===Xs)return z(R.value);if(R.type===_e){let K=q.get(R.name),{data:G}=K,{name:N,path:$,segment:oe}=G;return P(N,$)}else if(R.type===ft){let K=t.get(z(R.value)),{indivisibles:G}=K,{mapTrail:N}=G,$=R.trail.join("."),{data:oe}=N.get($),{name:ne,path:ee}=oe;return P(ne,ee)}};j=z(_)}let B=t.get(j);switch(B.type){case me:{let{link:z}=B,{store:R}=z;e.push(C,...k(R.size)),e.push(Z,Ae),e.push(Pe,re),e.push(ae,re),J(_),e.push(R.opcode,R.align,R.offset),e.push(ae,re),x=x+7|0;break}case de:{let z=0,R=()=>{},K=oe=>{J(_);let{link:ne}=oe,{load:ee}=ne;e.push(ee.opcode,ee.align,ee.offset+z|0),x=x+1|0,z=z+ee.size|0},G=()=>{},{indivisibles:N}=B,{mapTrail:$}=N;for(let oe of $.values()){if(oe.type===Ze){G();continue}let{data:ne}=oe,{name:ee,path:ce}=ne,ze=P(ee,ce),Ne=t.get(ze);switch(Ne.type){case me:{K(Ne);break}case Ge:{R();break}}}break}}return x},Y=(_,l=0)=>{let{name:x,path:I}=_,j=P(x,"Flogram"),B=t.get(j),{link:z}=B,{store:R,load:K}=z,G=Number(_.length);w();for(let N=0;N<G;N++){e.push(C,...k(R.size)),e.push(Z,Ae);let $=l;g($,$+1|0),e.push(C,...k(N)),e.push(C,K.size),e.push(Xt),e.push(Te),e.push(K.opcode,K.align,K.offset),e.push(R.opcode,R.align,R.offset),Ee()}return G},ue=(_,l)=>{let x=t.get(l),{opcode:I}=x,j=x.encode(_);e.push(I,...j)},g=(_,l)=>{for(;_<l;)e.push(Ie,_),_=_+1|0};switch(O.type){case ut:{m(O);break}case"instance":{let{path:_,members:l}=O;var se=l.length-1|0;for(let x=se;x>=0;x=x-1|0){let I=l[x],{path:j,value:B}=I;y(B)}break}case jt:{let{data:_}=O,{name:l,path:x}=_,I=P(l,x),j=t.get(I);O.layout==="NONE"?e.push(j.opcode,...j.none):J(O.value),r=r+1|0;break}case Mt:{let{link:_}=O,l=S(_);r=r+l|0;break}case Xs:{let{value:_}=O,l=et(_);if(q.get(l)?.data.type===pe){J({name:l,type:_e});return}let I=d(_,l);r=r+I|0;break}case $s:{let{value:_}=O;switch(_.type){case _e:{let l=fe.get(_.name);g(l+1|0,l+2|0);break}}break}case Yr:{let{values:_}=O;w(je);for(let l of _){let x=dt(l),I=P(x.name,x.path);if(x.name===ye||x.name===pe||x.layout===pe)J(l,"assignment"),e.push(Gt),e.push(Gt);else{let j=t.get(I),{link:B}=j,{store:z}=B;e.push(C,...k(z.size)),e.push(Z,Ae),J(l),e.push(z.opcode,z.align,z.offset)}Ee()}w(),e.push(ae,je),e.push(ae,re),e.push(ae,je),e.push(Wr),e.push(C,4),e.push(Jr),r=r+2|0;break}case we:{let{literal:_,name:l,path:x}=O,I=P(l,x),j=t.get(I);if(O.layout===pe){F(O),r=r+2|0;return}else if(l===ye){let B=[];for(let R of _)B.push({type:we,literal:R.charCodeAt(0).toString(),name:ye,path:"Flogram"});let z={...O,literal:B};F(z),r=r+2|0;return}j&&j.type===de?(L(_,I),r=r+2|0):(j||(console.log(O),console.log("NO SHAPE FOUND")),ue(_,I),r=r+1|0);break}case Po:{let{array:_,index:l}=O,{name:x}=_,{name:I}=l,j=fe.get(x),B=fe.get(I),z=q.get(x),R=P(z.data.name,z.data.path),K=t.get(R),{link:G}=K,{load:N}=G;switch(K.type){case me:{g(j,j+1|0),J(l),e.push(C,N.size),e.push(Xt),e.push(Te),e.push(N.opcode,N.align,N.offset),r=r+2|0;break}case de:{console.log("TO LOAD IS AN OBJECT");break}}break}case Br:{J(O.value);break}case _e:{let{name:_}=O,l=fe.get(_),x=q.get(_),{data:I}=x;switch(I.type){case Ze:{I.name===pe||I.name===ye?(g(l,l+2|0),r=r+2|0):(g(l,l+1|0),r=r+1|0);break}case pe:{if(a==="assignment"&&I.length){let j=Y(I,l);e.push(ae,re),e.push(C,...k(j))}else g(l,l+2|0),r=r+2|0;break}case jt:case wt:{let{name:j,path:B}=I,z=P(j,B),R=t.get(z);switch(I.layout){case pe:{g(l,l+2|0),r=r+2|0;break}default:{switch(R.type){case me:{if(j===ye){a==="assignment"?(e.push(C,0),e.push(Pe,re),e.push(Pt,He),e.push(Bt,He),e.push(C,4),e.push(Z,Ae),e.push(Ie,l),e.push(ae,re),e.push(C,4),e.push(Xt),e.push(Te),e.push(qr,$e,Xe),e.push(Qe,$e,Xe),e.push(ae,re),e.push(C,1),e.push(Te),e.push(Pe,re),e.push(Z,Yo),e.push(ae,re),e.push(Ie,l+1),e.push(Js),e.push(At,1),e.push(Kt,0),e.push(Ws),e.push(Ws),e.push(ae,re),e.push(Ie,l+1)):(g(l,l+2|0),r=r+2|0);break}else g(l,l+1|0);break}case Ge:{g(l,l+1|0),r=r+1|0;break}case de:{g(l,l+2|0),r=r+2|0;break}}break}}break}}break}case ft:{let{value:_,trail:l}=O,x=_.name||_.link||_.value,I=q.get(x),{data:j}=I,B=P(j.name,j.path),z=t.get(B),{indivisibles:R}=z,{mapTrail:K}=R,G=l.join("."),N=JSON.parse(JSON.stringify(l)),$=K.get(G),{address:oe}=$,ne=z;for(;N.length>0;){let Oe=N.shift();if(N.length>0){let Ye=ne.members.get(Oe),Ke=P(Ye.name,Ye.path);ne=t.get(Ke);continue}ne=ne.members.get(Oe)}let ee=P(ne.name,ne.path),ce=t.get(ee),{link:ze}=ce,{load:Ne}=ze,qe=fe.get(x);e.push(Ie,...k(qe)),e.push(C,...k(oe)),e.push(Te),e.push(Ne.opcode,Ne.align,Ne.offset);break}}},le=A=>{let{name:O,currentIndex:S}=A;if(S===0)e.push(Ht,fe.size+1);else if(e.push(Ie,fe.size+1),O==="==")e.push(Gr);else if(O==="!=")e.push(Hr);else throw new Error(`Unknown operator ${O} for objects`)},W=A=>{let{member:O}=A,{isObject:S,index:F,address:L}=O;if(S){e.push(Ie,...k(F)),e.push(C,...k(L)),e.push(Te),e.push(Ie,...k(F)),e.push(C,...k(L+4)),e.push(Te);return}e.push(Ie,...k(F)),e.push(C,...k(L)),e.push(Te)};for(y(n);i.length>0;){let A=i.shift();switch(A.type){case"call":{D(A);break}case"value":{te(A);break}case Nt:{W(A);break}case"compare":{le(A);break}}}return r},mt=n=>{let a=(i,h)=>{for(;i<h;)h=h-1|0,e.push(Ht,h)},r=(i,h)=>{switch(h.type){case Ze:{h.name===pe||h.name===ye?a(i,i+2|0):a(i,i+1|0);break}case ye:{a(i,i+2|0);break}case pe:{a(i,i+2|0);break}case jt:case wt:{let{name:y,path:c}=h,p=P(y,c),b=t.get(p);switch(y){case ye:{a(i,i+2|0);break}case pe:{a(i,i+Number(h.length)|0);break}default:{switch(b.type){case me:if(y===ye){a(i,i+2|0);break}case Ge:{a(i,i+1|0);break}case de:{let{length:m}=b;a(i,i+2|0);break}}break}}break}}};switch(n.type){case _e:{let{name:i}=n,h=fe.get(i),y=q.get(i),{data:c}=y;r(h,c);break}case ft:{let{value:i,trail:h}=n,{name:y}=i,c=q.get(y),{data:p}=c,b=P(p.name,p.path),m=t.get(b),{indivisibles:D}=m,{mapTrail:te}=D,le=h.join("."),W=JSON.parse(JSON.stringify(h)),A=te.get(le),{index:O}=A,S=m;for(;W.length>0;){let L=W.shift();S=S.members.get(L)}let F=fe.get(y);S.type==pe||S.type==ye?a(F+O|0,F+O+2|0):a(F+O|0,F+O+1|0);break}}},os=(n,a)=>{let{array:r,index:i}=n,h=0,y=fe.get(r.name),c=()=>{e.push(Ie,y)},p=q.get(r.name),{data:b}=p,{name:m,path:D,segment:te}=b,le=P(m,D),W=t.get(le);switch(W.type){case me:{c(),J(i);let{link:A}=W,{store:O}=A;e.push(C,O.size),e.push(Xt),e.push(Te),J(a),e.push(O.opcode,O.align,O.offset),h=h+4|0;break}case de:{let A=null,O=0;if(a.type===_e){let{name:g}=a;A=q.get(g),O=fe.get(g)}let S=0,F=()=>{},L=(g,se)=>{c();let{index:_}=se;e.push(Ie,O+_|0);let{link:l}=g,{store:x}=l;e.push(x.opcode,x.align,x.offset+S|0),h=h+1|0,S=S+x.size|0},d=()=>{},{indivisibles:Y}=W,{mapTrail:ue}=Y;for(let g of ue.values()){if(g.type===Ze){d();continue}let{data:se}=g,{name:_,path:l}=se,x=P(_,l),I=t.get(x);switch(I.type){case me:{L(I,g);break}case Ge:{F();break}}}break}}return h},ns=(n,a)=>{let{value:r,trail:i}=n,{name:h}=r,y=q.get(h),{data:c}=y,p=P(c.name,c.path),b=t.get(p),{indivisibles:m}=b,{mapTrail:D}=m,te=i.join("."),le=JSON.parse(JSON.stringify(i)),W=D.get(te),{address:A}=W,O=b;for(;le.length>0;){let L=le.shift();if(le.length>0){let d=O.members.get(L),Y=P(d.name,d.path);O=t.get(Y);continue}O=O.members.get(L)}let S=P(O.name,O.path),F=t.get(S);switch(F.type){case me:{let{link:L}=F,{store:d}=L,Y=fe.get(h);e.push(Ie,...k(Y)),e.push(C,...k(A)),e.push(Te),J(a),e.push(d.opcode,d.align,d.offset);break}}},cs=(n,a)=>{let{link:r}=n,i=0,h=et(r),y=q.get(h),{data:c}=y,{name:p,path:b,segment:m}=c,D=P(p,b),te=t.get(D);switch(te.type){case me:{J(r),J(a);let{link:le}=te,{store:W}=le;e.push(W.opcode,W.align,W.offset),i=i+1|0;break}case de:{let le=null,W=0,A=(g,se,_="")=>{let l=_?`${_}.${g.name}`:g.name,x=se.get(l);if(x){let{data:I}=x,j=P(I.name,I.path),B=t.get(j),{store:z}=B.link;J(r),e.push(C,...k(x.address)),e.push(Te),J(g.value),e.push(z.opcode,z.align,z.offset)}else if(g.value&&g.value.literal)for(let I of g.value.literal)A(I,se,l)};if(a.type===_e){let{name:g}=a;if(W=fe.get(g),n.link.name.startsWith(Nt)){let se=fe.get(n.link.name),{name:_,path:l}=q.get(g),x=P(_,l),I=t.get(x),{indivisibles:j}=I,{mapTrail:B}=j;for(let z of B){let{data:R}=z,K=P(R.name,R.path),G=t.get(K),{load:N,store:$}=G.link;e.push(C,...k(se)),e.push(C,...k(z.address)),e.push(Te),e.push(C,...k(W)),e.push(C,...k(z.address)),e.push(Te),e.push(N.opcode,N.align,N.offset),e.push($.opcode,$.align,$.offset)}return}return J(r),e.push(Ie,...k(W)),e.push(Qe,$e,Xe),J(r),e.push(C,...k(4)),e.push(Te),e.push(Ie,...k(W+1|0)),e.push(Qe,$e,Xe),i=i+2|0,i}let{literal:O,name:S,path:F}=a,L=P(S,F),d=t.get(L),{indivisibles:Y}=d,{mapTrail:ue}=Y;for(let g of O)A(g,ue)}}return i},as=(n,a)=>{let{link:r}=a,i=0,h=W=>{let A=Array.from(W.members.values()).reduce((d,Y)=>Y?d+1:d,0);w();let{indivisibles:O}=W,{mapTrail:S}=O,F=(d,Y)=>{let{store:ue,load:g}=d.link,{address:se}=S.get(Y);e.push(C,...k(ue.size)),e.push(Z,Ae),J(r),e.push(C,...k(se)),e.push(Te),e.push(g.opcode,g.align,g.offset),e.push(ue.opcode,ue.align,ue.offset)},L=(d,Y)=>{e.push(C,...k($t)),e.push(Z,Ae),e.push(Pe,je);for(let[g,se]of d.members){if(!se)continue;let _=P(se.name,se.path),l=t.get(_);if(l.type===de){U(),L(l,`${Y}.${g}`);continue}let x=`${Y}.${g}`;F(l,x)}e.push(ae,je),e.push(ae,je),e.push(C,...k($t)),e.push(Te),e.push(Qe,$e,Xe);let ue=Array.from(d.members.values()).reduce((g,se)=>se?g+1:g,0);e.push(ae,je),e.push(C,...k(ni)),e.push(Te),e.push(C,...k(ue)),e.push(Qe,$e,Xe),X()};for(let[d,Y]of W.members){if(!Y)continue;let ue=P(Y.name,Y.path),g=t.get(ue);if(g.type===de){L(g,d);continue}F(g,d)}e.push(ae,re),e.push(C,...k(A))},y=et(r),c=q.get(y),{data:p}=c,{name:b,path:m,segment:D}=p,te=P(b,m),le=t.get(te);switch(le.type){case me:case de:{if(n.type===_e)return h(le),mt(n),i;break}}return i},rs=(n,a,r)=>{let i=t.get(n),h=c=>{switch(c.type){case _e:{let{name:p}=c,b=fe.get(p);e.push(Ie,b);break}case we:{let{literal:p}=c,b=i.type===me?p:i.evaluate(p),m=k(b);e.push(C,...m);break}}},y=()=>{switch(i.type){case Ge:{e.push(vo),e.push(At,0);break}case me:{e.push(vo),e.push(At,0);break}}};switch(i.type){case Ge:{h(a),h(r),y();break}case me:{h(a),h(r),y();break}}},he=[],ve=n=>{let a={type:Do,statement:n};he.unshift(a)};he.unshift({type:at});let St=(n,a)=>{if(n.members)for(let[r,i]of n.members.entries()){let h=P(i?.name,i?.path),y=t.get(h);if(y&&y.type===de){let c=St(y,h,a);c&&gt.push(c)}}return n.members&&n.members.has(Fo)?a:null},gt=[];Fe.forEach(n=>{let a=P(n.data.name,n.data.path),r=t.get(a);if(r&&r.type===de){let i=St(r,a);i&&gt.push(i)}});let u=gt.map(n=>({type:Ao,expression:{type:ut,name:Fo,path:n,inputs:[]}}));for(let n of u)ve(n);var E=_t.length-1|0;for(let n=E;n>=0;n=n-1|0){let a=_t[n];ve(a)}let T=n=>{let{target:a,source:r}=n;if(a.type===wr){cs(a,r);return}if(a.type===kr){os(a,r);return}if(a.type===ft){ns(a,r);return}if(r.type===Mt){let i=q.get(a.name),{data:h}=i;if(h.path!=="Flogram"){let y=P(h.name,h.path);if(t.get(y).type===de){as(a,r);return}}}J(r,"assignment"),mt(a)},v=n=>{let{statements:a}=n;e.push(Pt,He),e.push(Bt,He);let r={type:at,layout:Yt};he.unshift(r),he.unshift(r),he.unshift({type:Co});var i=a.length-1|0;for(let h=i;h>=0;h=h-1|0){let y=a[h];ve(y)}},M=n=>{let{statements:a,condition:r}=n;e.push(Pt,He),e.push(Bt,He);let i={type:at,layout:Yt};he.unshift(i),he.unshift(i),he.unshift({type:ko,condition:r});var h=a.length-1|0;for(let y=h;y>=0;y=y-1|0){let c=a[y];ve(c)}},V=n=>{let{statements:a,collection:r,index:i,iterator:h}=n;e.push(C,0),i?e.push(Ht,fe.get(i)):e.push(Pe,re),e.push(Pt,He),e.push(Bt,He);let y={type:at,layout:Yt};he.unshift(y),he.unshift(y),he.unshift({type:Lo,index:i});var c=a.length-1|0;for(let p=c;p>=0;p=p-1|0){let b=a[p];ve(b)}he.unshift({type:Uo,collection:r,iterator:h,index:i})},Q=n=>{e.push(Kt,2)},H=n=>{let{branches:a}=n;he.unshift({type:at});for(let r=a.length-1;r>=0;r--){let i=a[r];switch(i.type){case Ur:{let{statements:h}=i,y=h.length;for(let p=y-1;p>=0;p--){let b=h[p];ve(b)}let c=h.find(p=>p.type===Hs);he.unshift({type:Gs,stop:c}),J(i.values[0]);break}case Lr:{let{statements:h}=i,y=h.length;for(let c=y-1;c>=0;c--){let p=h[c];ve(p)}he.unshift({type:So});break}}}},ie=n=>{let a=n,{branches:r,values:i}=a;if(r.length>0&&i.length===0)return H(n);e.push(Pt,He);let y={type:at};he.unshift(y);let c=[];for(let b of i)switch(b.type){case _e:{let{name:m}=b,D=q.get(m),{data:te}=D,{name:le,path:W}=te,A=P(le,W);c.push(A);break}}var p=r.length-1|0;for(let b=p;b>=0;b=b-1|0){let m=r[b],D={type:Ro,branch:m,condition:a,commonKeys:c};he.unshift(D)}},xe=n=>{let{expression:a}=n;var i=J(a)|0;for(let h=0;h<i;h=h+1|0)e.push(Gt)},Ce=n=>{let{value:a}=n;J(a),e.push(Z,Zr),e.push(C,0),mt(a)},Se=n=>{let{values:a}=n;for(let r of a)J(r);e.push(Xr)},We=n=>{e.push(Ws)},Ve=n=>{e.push(12,0)},is=n=>{e.push($r)},ps=n=>{n.stop?(e.push(Vo),e.push(Et)):(e.push(Vo),e.push(He))},rt=n=>{let{branch:a,commonKeys:r,condition:i}=n,{values:h}=a,{values:y}=i;var c=r.length|0;for(let m=0;m<c;m=m+1|0){let D=r[m],te=h[m],le=y[m];rs(D,te,le)}let{statements:p}=a;var b=p.length-1|0;for(let m=b;m>=0;m=m-1|0){let D=p[m];ve(D)}},ls=n=>{let{condition:a}=n;J(a),e.push(C,0),e.push(Js),e.push(At,1),e.push(Kt,0)},xt=n=>{let{collection:a,iterator:r,index:i}=n;J(a);let h=fe.get(i);i?e.push(Ie,h):e.push(ae,re),e.push(Js),e.push(At,1),e.push(Gt);let y=Object.freeze({type:Po,array:a,index:{type:_e,name:i}}),c=Object.freeze({type:_e,name:r}),p=Object.freeze({type:Dr,target:c,source:y});ve(p)},Dt=n=>{let{index:a}=n,r=fe.get(a);a?e.push(Ie,r):e.push(ae,re),e.push(C,1),e.push(Te),a?e.push(Ht,r):e.push(Pe,re),e.push(Kt,0)},Tt=n=>{let{statement:a}=n;switch(a.type){case"assign":{T(a);break}case Gs:{ie(a);break}case Yt:{v(a);break}case vr:{M(a);break}case Vr:{V(a);break}case Mr:{Q(a);break}case Ao:{xe(a);break}case Kr:{Ce(a);break}case Hs:{Se(a);break}}};for(;he.length>0;){let n=he.shift();switch(n.type){case at:{We(n);break}case Co:{Ve(n);break}case So:{is(n);break}case Gs:{ps(n);break}case Ro:{rt(n);break}case Do:{Tt(n);break}case ko:{ls(n);break}case Uo:{xt(n);break}case Lo:{Dt(n);break}default:break}}return e}var{HEX_ENCODE:Zs,LEB128_ENCODE:Je}=lt,{TYPES_ASSIGN:ri,TYPES_ARRAY:Rt,TYPES_DATA:Wt,TYPES_GENERICS:ii,TYPES_ENUMERATION:Ct,TYPES_EXPRESSION:pi,TYPES_LINK:qt,TYPES_LOCAL:bt,TYPES_OBJECT:Ot,TYPES_PROCEDURE:Qs,TYPES_RETURN:li,TYPES_SELECT:ui,TYPES_MEMBER:fi,TYPES_STORE:eo,TYPES_LITERAL:Ei,TYPES_LINK_TO:Zt,TYPES_VALUE_AT:Qt,TYPES_SELF:Bo,TYPES_NATIVE:ht,TYPES_STRING:es}=Ft,to="",De=(s,t)=>`${t}.${s}`,bi=s=>[">","<",">=","<=","!=","=="].includes(s),Oi=s=>["FP64","I64","U64","FP32","I32","U32","I16","U16","I8","U8","Bool"].includes(s),so=48,hi=Object.freeze([0,127]),_i=Object.freeze({}),di=Object.freeze([127]),Ko=0;var mi=2;var gi=10,xi=7,Ti=3,yi=2,Ii=1,zi=6,nt=96,ts=127,oo=Object.freeze([7,105,109,112,111,114,116,115]),Ni=Object.freeze([6,109,101,109,111,114,121]),ji=0;var Pi=65,Le=new Uint8Array(8),Ai=Object.freeze([0,97,115,109]),Ri=Object.freeze([1,0,0,0]),Ci=(s,t)=>{t=t??_i;let o={},{data:f,code:e}=s,w=e.filter(u=>!u.description.generics||u.description.generics.length===0),U=new Map,X=new Map,ge=u=>{let E=0;for(let T of u){let{data:v}=T;switch(v.type){case"Maybe":case Wt:{let{name:M,path:V}=v,Q=De(M,V),H=U.get(Q);if(H)switch(H.type){case ht:if(M===es){E=E+2|0;break}case Ct:{E=E+1|0;break}case Ot:{let{length:ie}=H;E=E+2|0;break}}break}case qt:{v.name===Rt||v.name===es?E=E+2|0:E=E+1|0;break}case Rt:{E=E+2|0;break}}}return E},Ee=u=>{let{labels:E}=u,T=new Map;var v=E.length|0;for(let H=0;H<v;H=H+1|0){let{name:ie}=E[H];T.set(ie,H)}return Object.freeze({type:Ct,encode:H=>{let ie=T.get(H);return typeof ie>"u"?di:Je(ie)},evaluate:H=>T.get(H),opcode:Pi,link:Object.freeze({load:Object.freeze({opcode:40,align:2,offset:0,size:4}),store:Object.freeze({opcode:54,align:2,offset:0,size:4})})})},Re=u=>{let E=[],T=[],v=0,M=()=>{let c=Object.freeze({type:"back"});E.unshift(c)},V=c=>{let p={type:Wt,data:c};E.unshift(p)},Q=c=>{let p={type:"name",name:c};E.unshift(p)},H=(c,p)=>{p&&(M(),V(p),Q(c))},ie=c=>f.find(p=>p.name===c),xe=(c,p)=>p.find(b=>b.name===c),Ce=(c,{inputs:p})=>p.find(b=>b.name===c),Se=(c,p)=>{let b=c;for(let m of p){let D=xe(m,b.description.members),te=ie(D.data.name);if(te&&te.type===Ot)b=te;else return D}return null},We=(c,p)=>{let b=c.trail,m=xe(b[0],p.members);if(!m)return null;if(b.length===1)return m.data;let D=ie(m.data.name);return Se(D,b.slice(1)).data},Ve=(c,p,b,m)=>{if(Ce(p,b.description))return;b.description.self.push(c);let D=Object.seal({name:p,data:{...We({trail:c.trail||c.value?.trail||c.link?.trail||[]},m),segment:"heap"}});c.type!==Zt&&(D.data.type=qt),b.description.inputs.push(D)},is=(c,p,b)=>{let m=c.inputs.map(D=>rt(D,p,b));return{...c,inputs:m}},ps=(c,p,b)=>{if(!(c.value.link===Bo||c.value.value===Bo))return console.log("THIS IS NOT HANDLED; HANGING"),c;let m=`${c.type}_${c.trail.join("_")}`;if(Ve(c,m,p,b),c.value.value)return{type:Zt,value:m};if(c.value.link)return{type:Qt,link:m}},rt=(c,p,b,m="")=>{switch(c.type){case bt:case Ei:return c;case fi:{let D=`${c.type}_${c.trail.join("_")}`;return Ve(c,D,p,b),m==="target"?{type:eo,link:{type:bt,name:D}}:{type:Qt,link:{type:bt,name:D}}}case Zt:{let D=`${c.value.type}_${c.value.trail.join("_")}`;return Ve(c,D,p,b),{type:Zt,value:{type:bt,name:D}}}case Qt:{let D=`${c.link.type}_${c.link.trail.join("_")}`;return Ve(c,D,p,b),{type:Qt,link:{type:bt,name:D}}}case eo:{let D=`${c.link.type}_${c.link.trail.join("_")}`;return Ve(c,D,p,b),{type:eo,link:{type:bt,name:D}}}case ui:return ps(c,p,b);case pi:return is(c,p,b);default:return console.log("THIS IS NOT HANDLED; HANGING"),console.log(c),c}},ls=(c,p)=>{let b=JSON.parse(JSON.stringify(c));b.description.self=[];for(let m of b.description.statements)m.type===ri?(m.target=rt(m.target,b,p,"target"),m.source=rt(m.source,b,p)):m.type===li&&(m.values=m.values.map(D=>rt(D,b,p)));w.push(b)},{members:xt}=u,Dt=new Map;for(let c of xt){let{name:p,data:b}=c;Dt.set(p,b)}var Tt=xt.length-1|0;for(let c=Tt;c>=0;c=c-1|0){let p=xt[c],{name:b,data:m}=p;if(p.type&&p.type===Qs){ls(p,u);continue}H(b,m)}let n=new Map,a=new Map,r=0;for(;E.length>0;){let c=E.shift();switch(c.type){case"back":{T.pop();break}case Wt:{let{data:p}=c,b=()=>{let W=T.join("."),A=De(p.name,p.path),O=U.get(A),{link:S}=O,{load:F}=S,L=Object.freeze({data:p,index:r,address:v,trail:W});v+=F.size,n.set(W,L),a.set(r,L),p.type===Rt?r=r+2|0:r=r+1|0};if(p.type===qt){b();break}let{name:m,path:D}=p,te=De(m,D),le=U.get(te);switch(le.type){case ht:case Ct:{b();break}case Ot:{let{members:W}=le,A=[...W];var Tt=A.length-1|0;v+=8;for(let S=Tt;S>=0;S=S-1|0){let[F,L]=A[S];H(F,L)}break}}break}case"name":{let{name:p}=c;T.push(p);break}}}let i=r|0,h=Object.freeze({mapTrail:n,mapIndex:a});return{type:Ot,length:i,members:Dt,indivisibles:h}},Me={};for(let u of f){let{path:E}=u;switch(u.type){case ht:{let{name:T,path:v}=u,M=De(T,v);if(Object.hasOwn(st,M)){let V=st[M];U.set(M,V);continue}break}case"import":{if(Object.hasOwn(st,E)){let T=st[E];U.set(E,T);continue}break}case ii:{let{name:T,path:v}=u,M=De(T,v),V=st["Flogram.FP32"];U.set(M,V);break}case Ct:{let{name:T,path:v,description:M}=u,V=De(T,v),Q=Ee(M);U.set(V,Q);break}case Ot:{let{name:T,path:v,description:M}=u,{generics:V}=M,Q=De(T,v);if(!V||V.length===0){let H=Re(M);U.set(Q,H)}break}}}o.structures=Me;let Fe=0;t.memory&&(Fe+=t.draws?7:6);let _t=(u,E)=>{let T=X.get(u);if(typeof T>"u"){X.set(u,[E]);return}(T.length==0||T.length>0&&T[0].body!==E.body)&&X.set(u,[E,...T])},fe=u=>{let{name:E,path:T}=u,v=De(E,T);switch(T==="Flogram"&&(Oi(E)?v=De(u.description.inputs[0]?.data?.name?.toLowerCase()+"."+ke(E),T):u.description.outputs&&u.description.outputs.length>=1&&!bi(u.name)?u.description.outputs[0]?.data?.name&&(v=De(u.description.outputs[0]?.data?.name?.toLowerCase()+"."+ke(E,u.description.inputs?.length),T)):(zt.includes(u.description.inputs[1]?.data?.name?.toUpperCase())&&(v=De(u.description.inputs[1]?.data?.name?.toUpperCase()+"."+ke(E),T),to=u.description.inputs[1]?.data?.name?.toUpperCase()),to&&(v=De(to.toLowerCase()+"."+ke(E),T)))),u.type){case ht:{if(Object.hasOwn(It,v)){let M=It[v];_t(v,M);return}break}case Qs:{let{description:M}=u,{inputs:V,outputs:Q}=M,H=De(E,T),ie={type:"artificial",index:Fe,procedure:u,lengths:Object.freeze({inputs:ge(V),outputs:ge(Q)})};_t(H,ie);break}}Fe=Fe+1|0},q=[],be=[];for(let u of w){if(u.description.generics?.length>0)continue;let{description:E}=u,{inputs:T,outputs:v}=E,M=[...T,...v];if(!(u.type===ht&&M.some(V=>!zt.includes(V.data.name))))switch(fe(u),u.type){case"import":{let{path:V}=u;if(Object.hasOwn(It,V))continue;q.push(u);break}case Qs:{be.push(u);break}}}let Be=u=>{let E=0,T=[];for(let v of u){let M=()=>{T.push(ts),E=E+1|0},V=Ce=>{let{identity:Se}=Ce;T.push(Se),E=E+1|0},Q=()=>{T.push(ts),E=E+1|0},H=()=>{T.push(ts),E=E+1|0,T.push(ts),E=E+1|0},{name:ie,data:xe}=v;switch(xe.type){case"Maybe":case Wt:{let{name:Ce,path:Se}=xe,We=De(Ce,Se),Ve=U.get(We);if(!Ve)V(st["Flogram.FP32"]);else switch(Ve.type){case ht:{Ce===es?H():V(Ve);break}case Ct:{M();break}case Ot:{H();break}}break}case qt:{xe.name===Rt||xe.name===es?H():Q();break}case Rt:{H();break}}}return[E,T]},ct=(u,E)=>{let T=E.length|0,v=Je(T);E.unshift(u,...v)},ss=()=>{let u=[],E=0,T=[...q,...be];t.memory&&(E=t.draws?7:6,u.push(nt,1,127,1,127),u.push(nt,1,127,0),u.push(nt,0,0),u.push(nt,2,127,127,0),u.push(nt,0,2,127,127),u.push(nt,0,2,127,127),t.draws&&u.push(nt,1,127,0));for(let V of T){let{description:Q}=V,{inputs:H,outputs:ie}=Q,[xe,Ce]=Be(H),[Se,We]=Be(ie);u.push(nt,xe,...Ce,Se,...We)}let v=T.length|0,M=Je(v+E);return u.unshift(...M),ct(Ii,u),u},et=()=>{let u=[];return u.push(2),u.push(127,1),u.push(65,0,11),u.push(127,1),u.push(65,0,11),ct(zi,u),u},dt=0,J=()=>{let u=[],E=0,T={};if(t.memory){let V=ie=>{let xe=[...ie].map(Ce=>Ce.charCodeAt(0));return[xe.length,...xe]},Q=[V("alloc"),V("dealloc"),V("merge"),V("save"),V("undo"),V("undoPenultimate")];t.draws&&Q.push(V("draw"));let H=t.draws?7:6;for(let ie=0;ie<H;ie++){Le.fill(so),Zs(E,Le);let xe=E|0;u.push(...oo,...Q[ie],Ko,xe),E=E+1|0}}for(let V of q){let{path:Q}=V;Le.fill(so),Zs(E,Le);let H=String.fromCodePoint(...Le);T[H]={path:V.path,description:V.description};let ie=E|0;u.push(...oo,Le.length|0,...Le,Ko,ie),E=E+1|0}dt=E|0,t.memory&&(u.push(...oo,...Ni,mi,...hi),E=E+1|0);let v=E|0,M=Je(v);return u.unshift(...M),ct(yi,u),o.imports=T,u},mt=()=>{let u=[];var E=be.length|0;for(let M=0;M<E;M=M+1|0){let V=M|0,Q=dt+V|0,H=Je(Q);u.push(...H)}let T=be.length|0,v=Je(T);return u.unshift(...v),ct(Ti,u),u},os=()=>{let u=[],E=0,T={};var v=be.length|0;for(let Q=0;Q<v;Q=Q+1|0){let H=Q+dt|0,ie=Je(H);Le.fill(so),Zs(E,Le);let{name:xe,path:Ce,description:Se}=be[Q];Se={inputs:Se.inputs,outputs:Se.outputs};let We=String.fromCodePoint(...Le);T[We]={name:xe,path:Ce,description:Se},u.push(Le.length|0,...Le,ji,...ie),E=E+1|0}let M=E|0,V=Je(M);return u.unshift(...V),ct(xi,u),o.procedures=T,u},ns=()=>{let u=[];for(let v of be){let M=Jt(v,U,X,w),V=M.length|0,Q=Je(V);u.push(...Q,...M)}let E=be.length|0,T=Je(E);return u.unshift(...T),ct(gi,u),u},cs=ss(),as=et(),rs=J(),he=mt(),ve=os(),St=ns(),gt=new Uint8Array([...Ai,...Ri,...cs,...rs,...he,...as,...ve,...St]);return[o,gt]},Si=Object.freeze({compile:Ci}),hp=Si;export{hp as default};
