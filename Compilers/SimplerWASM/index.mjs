var fn="as",En="=",hn="break",bn="else",On="enum",_n="export",dn="if",mn="import",gn="->",xn="is",Tn="loop",yn="mut",In="native",zn="object",Nn="fn",Pn="return",An="self",jn="template",Rn=Object.freeze({ALIAS:fn,ASSIGN:En,BREAK:hn,ELSE:bn,ENUMERATION:On,EXPORT:_n,IF:dn,IMPORT:mn,INTO:gn,IS:xn,LOOP:Tn,MUTABLE:yn,NATIVE:In,OBJECT:zn,PROCEDURE:Nn,RETURN:Pn,SELF:An,TEMPLATE:jn}),mo=Rn;var Cn="assign",Sn="array_assignment",Dn="branch-match",Fn="branch-default",kn="condition",Un="loop",Ln="data",vn="generics",Vn="enumeration",Yn="expression",wn="instance",Mn="Link",Bn="local",Kn="object",Gn="procedure",Hn="return",Xn="select",$n="member",Jn="store",Wn="break",Zn="literal",qn="array_access",Qn="valueLink",ec="linkValue",tc="self",sc="procedure-call",oc="Maybe",nc="native",cc="move",ac="String",rc="Array",ic="import",pc="library",lc="constructor",uc="destructor",fc="free",Ec="block-end",hc="default-block",bc="continue",Oc="branch",_c="statement",dc="draw",mc="size",gc="concatenation",xc="foreach",Tc="while",yc="while-condition",Ic="foreach-condition",zc="foreach-end",Nc="I32",Pc="FP32",Ac="FP64",jc=Object.freeze({TYPES_ASSIGN:Cn,TYPES_ARRAY:rc,TYPES_ARRAY_ASSIGNMENT:Sn,TYPES_BRANCH_MATCH:Dn,TYPES_BRANCH_DEFAULT:Fn,TYPES_CONDITION:kn,TYPES_LOOP:Un,TYPES_FOREACH_END:zc,TYPES_WHILE_CONDITION:yc,TYPES_FOREACH_CONDITION:Ic,TYPES_DATA:Ln,TYPES_GENERICS:vn,TYPES_ENUMERATION:Vn,TYPES_EXPRESSION:Yn,TYPES_INSTANCE:wn,TYPES_LINK:Mn,TYPES_IMPORT:ic,TYPES_LOCAL:Bn,TYPES_OBJECT:Kn,TYPES_PROCEDURE:Gn,TYPES_RETURN:Hn,TYPES_SELECT:Xn,TYPES_MEMBER:$n,TYPES_STORE:Jn,TYPES_BREAK:Wn,TYPES_LITERAL:Zn,TYPES_ARRAY_ACCESS:qn,TYPES_LINK_TO:Qn,TYPES_VALUE_AT:ec,TYPES_SELF:tc,TYPES_LIBRARY:pc,TYPES_DROP:sc,TYPES_MAYBE:oc,TYPES_NATIVE:nc,TYPES_MOVE:cc,TYPES_STRING:ac,TYPES_CONSTRUCTOR:lc,TYPES_FREE:fc,TYPES_DEFAULT_BLOCK:hc,TYPES_BLOCK_END:Ec,TYPES_CONTINUE:bc,TYPES_BRANCH:Oc,TYPES_STATEMENT:_c,TYPES_DESTRUCTOR:uc,TYPES_DRAW:dc,TYPES_SIZE:mc,TYPES_CONCAT:gc,TYPES_FOREACH:xc,TYPES_WHILE:Tc,TYPES_I32:Nc,TYPES_FP32:Pc,TYPES_FP64:Ac}),zs=jc;var Rc=Object.freeze({COLON:58,COMMA:44,DIGIT_ZERO:48,DIGIT_NINE:57,DOT:46,HASHTAG:35,HORIZONTAL_TAB:9,HYPHEN_MINUS:45,LEFT_CURLY_BRACKET:123,LEFT_PARENTHESIS:40,LEFT_SQUARE_BRACKET:91,LINE_BREAK:10,NULL:0,PLUS_SIGN:43,RIGHT_CURLY_BRACKET:125,RIGHT_PARENTHESIS:41,RIGHT_SQUARE_BRACKET:93,SEMICOLON:59,SPACE:32}),go=Rc;var Cc="assignment",Sc="Flogram",Dc=Object.freeze({K_ASSIGNMENT:Cc,K_FLOGRAM:Sc}),xo=Dc;var Fc=Object.freeze([]),kc=Object.freeze({}),Uc="",Lc="	",vc=`
`,Vc="UTF-8",Jt=zs,Yc=Object.freeze({EMPTY_ARRAY:Fc,EMPTY_OBJECT:kc,EMPTY_STRING:Uc,HORIZONTAL_TAB:Lc,LINE_BREAK:vc,UNICODE_TEXT:Vc,Codes:go,Keys:mo,Types:zs,Keywords:xo}),Wt=Yc;var{EMPTY_STRING:wc,UNICODE_TEXT:js}=Wt,Mc=44,Bc=48,Kc=57,Gc=46,Hc=45,Xc=43,$c=65,Jc=90,Wc=-1,Zc=1,qc=new TextDecoder(js),Qc=new TextEncoder,ea=(c,s,a=0,l=c.length|0,y=0,$=s.length|0)=>{for(y=y|0,a=a|0,$=$|0,l=l|0;;){let e=a>=l,Z=y>=$;if(e||Z)break;let fe=c[a],re=s[y];if(a=a+1|0,y=y+1|0,fe<re)return Wc;if(fe>re)return Zc}return 0},ta=(c,s,a=0,l=c.length|0,y=0,$=s.length|0)=>{for(y=y|0,a=a|0,$=$|0,l=l|0;;){let e=y>=$,Z=a>=l;if(e||Z)break;s[y]=c[a],y=y+1|0,a=a+1|0}},sa=(c,s,a=0,l=c.length|0,y=0,$=s.length|0)=>{a=a|0,y=y|0,l=l|0,$=$|0;let e=l-a|0,Z=$-y|0;if(e!==Z)return!1;for(;;){let ae=a>=l,fe=y>=$;if(ae||fe)break;let ye=c[a],Ue=s[y];if(a=a+1|0,y=y+1|0,ye!==Ue)return!1}return!0},oa=c=>{c=c>>>0;let s=0,a=0;for(;a=(a<<1|1)>>>0,!(a>c);)s=s+1|0;return s},Io=Object.freeze([48,49,50,51,52,53,54,55,56,57,97,98,99,100,101,102]),As=(c,s,a,l)=>{for(c=c>>>0,l=l??s.length|0,a=a|0,l=l|0;c>0&&l>a;)l=l-1|0,s[l]=Io[c&15],c=c>>>4},na=(c,s,a,l)=>{let y=a|0,$=a+l|0;if(l===0)return!1;let e=s[y];for((e===Xc||e===Hc)&&(y=y+1|0);y<$;){let Z=s[y];if(y=y+1|0,!(Bc<=Z&&Z<=Kc||(Gc===Z||Mc===Z)))return!1}return!0},ca=c=>{let s=c>=$c,a=c<=Jc;return s&&a},qt=128,Qt=127,zo=-1,gt=64,Rs=c=>{c=c|0;let s=[];for(;;){let a=c&Qt;c=c>>7;let l=c===0,y=(a&gt)===0,$=l&&y,e=c===-1,Z=(a&gt)!==0;if($||e&&Z){s.push(a);break}a=a|qt,s.push(a)}return s},aa=c=>{let s=[],a=!0;for(;a;){let l=c&Qt;c>>=7,c===0&&!(l&gt)||c===-1&&l&gt?a=!1:l|=qt,s.push(l)}return s},No=(c,s)=>{s=s|0;let a=0,l=0;for(;;){let y=c[s]|0;s=s+1|0;let $=(y&Qt)<<l;if(l=l+7|0,a=a|$,(y&qt)===0){let Z=(y&gt)!==0,ae=l<32;if(Z&&ae){let re=zo<<l;a=a|re}break}}return a},ra=(c,s)=>{s=s|0;let a=0,l=0;for(;;){let y=c[s]|0;s=s+1|0;let $=(y&Qt)<<l;if(l=l+7|0,a=a|$,!(y&qt)){if(y&gt){let e=zo<<l;a=a|e}break}}return a},ia=c=>qc.decode(c),pa=c=>Qc.encode(c),la=(c=wc)=>{let s=c.length|0,a=Rs(s),l=Buffer.from(c,js);return Object.freeze([...a,...l])},ua=(c,s)=>{s=s|0;let a=No(c,s),l=Rs(a).length;return s=s+l|0,c.subarray(s,s+a|0).toString(js)},fa=58,Ea=46,Ut=32,Ns=48,ha=67,lt=new Uint8Array(ha),To=lt.subarray(0,8),Zt=lt.subarray(10,49),yo=lt.subarray(51,68),Ps=16,ba=2;lt[8]=fa;lt[9]=Ut;lt[49]=Ut;lt[50]=Ut;var Oa=(c,s)=>{s=s??console.log;let a=32,l=126,y=c.length|0,$=0;for(;y>0;){To.fill(Ns),As($,To),Zt.fill(Ut),yo.fill(Ut);let e=y>=Ps?Ps:y;y=y-Ps|0;let Z=0,ae=0;for(let re=1;re<=e;re=re+1|0){let ye=c[$]&255;Zt[Z+0|0]=Ns,Zt[Z+1|0]=Ns,As(ye,Zt,Z,Z+2|0);let Ue=Ea;a<=ye&&ye<=l&&(Ue=ye),yo[ae]=Ue,$=$+1|0,Z=Z+2|0,ae=ae+1|0,re%ba===0&&(Z=Z+1|0)}let fe=String.fromCodePoint(...lt);s(fe)}},_a=function*(c,s){let a=c.length|0,l=s.length|0,y=0;for(;y<a&&y<l;){let $=c[y],e=s[y];yield[$,e],y=y+1|0}},da=function*(c,s,a){let l=c.length|0,y=s.length|0,$=a.length|0,e=0;for(;e<l&&e<y&&e<$;){let Z=c[e],ae=s[e],fe=a[e];yield[Z,ae,fe],e=e+1|0}},ma=Object.freeze({ARRAY_COMPARE:ea,ARRAY_COPY:ta,ARRAY_EQUAL:sa,BIT_DEPTH:oa,HEX_DIGITS:Io,HEX_ENCODE:As,IS_NUMBER:na,IS_UPPERCASE:ca,LEB128_DECODE:No,LEB128_DECODE_SIGNED:ra,LEB128_ENCODE:Rs,LEB128_ENCODE_SIGNED:aa,UTF8_DECODE:ia,UTF8_ENCODE:pa,WASM_STRING_ENCODE:la,WASM_STRING_DECODE:ua,XXD_DUMP_HEX:Oa,ZIP2:_a,ZIP3:da}),xt=ma;var He=(c,s=2)=>{let a="";switch(c){case"+":a="add";break;case"-":a=s===2?"sub":"neg";break;case"*":a="mul";break;case"/":a="div";break;case"%":a="rem";break;case"==":a="eq";break;case">":a="gt";break;case"<":a="lt";break;case">=":a="ge";break;case"<=":a="le";break;case"!=":a="ne";break;case"&":a="and";break;case"|":a="or";break;case"^":a="xor";break;case"not":a="not";break;case"I32":a="toi32";break;case"U32":a="tou32";break;case"I64":a="toi64";break;case"U64":a="tou64";break;case"FP64":a="tofp64";break;case"FP32":a="tofp32";break}return a};var ga=Object.freeze({type:"native",body:Object.freeze([160]),lengths:Object.freeze({inputs:2,outputs:1})}),xa=Object.freeze({type:"native",body:Object.freeze([163]),lengths:Object.freeze({inputs:2,outputs:1})}),Ta=Object.freeze({type:"native",body:Object.freeze([162]),lengths:Object.freeze({inputs:2,outputs:1})}),ya=Object.freeze({type:"native",body:Object.freeze([68,0,0,0,0,0,0,240,191,162]),lengths:Object.freeze({inputs:1,outputs:1})}),Ia=Object.freeze({type:"native",body:Object.freeze([161]),lengths:Object.freeze({inputs:2,outputs:1})}),za=Object.freeze({type:"native",body:Object.freeze([124]),lengths:Object.freeze({inputs:2,outputs:1})}),Na=Object.freeze({type:"native",body:Object.freeze([128]),lengths:Object.freeze({inputs:2,outputs:1})}),Pa=Object.freeze({type:"native",body:Object.freeze([126]),lengths:Object.freeze({inputs:2,outputs:1})}),Aa=Object.freeze({type:"native",body:Object.freeze([66,255,255,255,255,255,255,255,255,126]),lengths:Object.freeze({inputs:1,outputs:1})}),ja=Object.freeze({type:"native",body:Object.freeze([125]),lengths:Object.freeze({inputs:2,outputs:1})}),Ra=Object.freeze({type:"native",body:Object.freeze([124]),lengths:Object.freeze({inputs:2,outputs:1})}),Ca=Object.freeze({type:"native",body:Object.freeze([127]),lengths:Object.freeze({inputs:2,outputs:1})}),Sa=Object.freeze({type:"native",body:Object.freeze([126]),lengths:Object.freeze({inputs:2,outputs:1})}),Op=Object.freeze({type:"native",body:Object.freeze([66,255,255,255,255,255,255,255,255,126]),lengths:Object.freeze({inputs:2,outputs:1})}),Da=Object.freeze({type:"native",body:Object.freeze([125]),lengths:Object.freeze({inputs:2,outputs:1})}),Po=Object.freeze({type:"native",body:Object.freeze([146]),lengths:Object.freeze({inputs:2,outputs:1})}),Ao=Object.freeze({type:"native",body:Object.freeze([149]),lengths:Object.freeze({inputs:2,outputs:1})}),jo=Object.freeze({type:"native",body:Object.freeze([148]),lengths:Object.freeze({inputs:2,outputs:1})}),Fa=Object.freeze({type:"native",body:Object.freeze([67,0,0,128,191,148]),lengths:Object.freeze({inputs:2,outputs:1})}),Ro=Object.freeze({type:"native",body:Object.freeze([140]),lengths:Object.freeze({inputs:2,outputs:1})}),Cs=Object.freeze({type:"native",body:Object.freeze([106]),lengths:Object.freeze({inputs:2,outputs:1})}),Ss=Object.freeze({type:"native",body:Object.freeze([110]),lengths:Object.freeze({inputs:2,outputs:1})}),Ds=Object.freeze({type:"native",body:Object.freeze([108]),lengths:Object.freeze({inputs:2,outputs:1})}),Fs=Object.freeze({type:"native",body:Object.freeze([107]),lengths:Object.freeze({inputs:2,outputs:1})}),ks=Object.freeze({type:"native",body:Object.freeze([106]),lengths:Object.freeze({inputs:2,outputs:1})}),Us=Object.freeze({type:"native",body:Object.freeze([109]),lengths:Object.freeze({inputs:2,outputs:1})}),Ls=Object.freeze({type:"native",body:Object.freeze([108]),lengths:Object.freeze({inputs:2,outputs:1})}),vs=Object.freeze({type:"native",body:Object.freeze([65,1,0,0,0,108]),lengths:Object.freeze({inputs:1,outputs:1})}),Vs=Object.freeze({type:"native",body:Object.freeze([107]),lengths:Object.freeze({inputs:2,outputs:1})}),ka=Object.freeze({type:"native",body:Object.freeze([130]),lengths:Object.freeze({inputs:2,outputs:1})}),Ua=Object.freeze({type:"native",body:Object.freeze([129]),lengths:Object.freeze({inputs:2,outputs:1})}),Ys=Object.freeze({type:"native",body:Object.freeze([112]),lengths:Object.freeze({inputs:2,outputs:1})}),ws=Object.freeze({type:"native",body:Object.freeze([111]),lengths:Object.freeze({inputs:2,outputs:1})}),La=Object.freeze({type:"native",body:Object.freeze([86]),lengths:Object.freeze({inputs:2,outputs:1})}),va=Object.freeze({type:"native",body:Object.freeze([85]),lengths:Object.freeze({inputs:2,outputs:1})}),Va=Object.freeze({type:"native",body:Object.freeze([100]),lengths:Object.freeze({inputs:2,outputs:1})}),Ms=Object.freeze({type:"native",body:Object.freeze([75]),lengths:Object.freeze({inputs:2,outputs:1})}),Bs=Object.freeze({type:"native",body:Object.freeze([74]),lengths:Object.freeze({inputs:2,outputs:1})}),Ya=Object.freeze({type:"native",body:Object.freeze([94]),lengths:Object.freeze({inputs:2,outputs:1})}),wa=Object.freeze({type:"native",body:Object.freeze([84]),lengths:Object.freeze({inputs:2,outputs:1})}),Ma=Object.freeze({type:"native",body:Object.freeze([83]),lengths:Object.freeze({inputs:2,outputs:1})}),Ba=Object.freeze({type:"native",body:Object.freeze([99]),lengths:Object.freeze({inputs:2,outputs:1})}),Ks=Object.freeze({type:"native",body:Object.freeze([73]),lengths:Object.freeze({inputs:2,outputs:1})}),Gs=Object.freeze({type:"native",body:Object.freeze([72]),lengths:Object.freeze({inputs:2,outputs:1})}),Ka=Object.freeze({type:"native",body:Object.freeze([93]),lengths:Object.freeze({inputs:2,outputs:1})}),Ga=Object.freeze({type:"native",body:Object.freeze([87]),lengths:Object.freeze({inputs:2,outputs:1})}),Ha=Object.freeze({type:"native",body:Object.freeze([88]),lengths:Object.freeze({inputs:2,outputs:1})}),Xa=Object.freeze({type:"native",body:Object.freeze([101]),lengths:Object.freeze({inputs:2,outputs:1})}),Hs=Object.freeze({type:"native",body:Object.freeze([76]),lengths:Object.freeze({inputs:2,outputs:1})}),Xs=Object.freeze({type:"native",body:Object.freeze([77]),lengths:Object.freeze({inputs:2,outputs:1})}),$a=Object.freeze({type:"native",body:Object.freeze([95]),lengths:Object.freeze({inputs:2,outputs:1})}),Ja=Object.freeze({type:"native",body:Object.freeze([89]),lengths:Object.freeze({inputs:2,outputs:1})}),Wa=Object.freeze({type:"native",body:Object.freeze([90]),lengths:Object.freeze({inputs:2,outputs:1})}),Za=Object.freeze({type:"native",body:Object.freeze([102]),lengths:Object.freeze({inputs:2,outputs:1})}),$s=Object.freeze({type:"native",body:Object.freeze([78]),lengths:Object.freeze({inputs:2,outputs:1})}),Js=Object.freeze({type:"native",body:Object.freeze([79]),lengths:Object.freeze({inputs:2,outputs:1})}),qa=Object.freeze({type:"native",body:Object.freeze([96]),lengths:Object.freeze({inputs:2,outputs:1})}),Qa=Object.freeze({type:"native",body:Object.freeze([81]),lengths:Object.freeze({inputs:2,outputs:1})}),er=Object.freeze({type:"native",body:Object.freeze([81]),lengths:Object.freeze({inputs:2,outputs:1})}),tr=Object.freeze({type:"native",body:Object.freeze([97]),lengths:Object.freeze({inputs:2,outputs:1})}),Ws=Object.freeze({type:"native",body:Object.freeze([70]),lengths:Object.freeze({inputs:2,outputs:1})}),Zs=Object.freeze({type:"native",body:Object.freeze([70]),lengths:Object.freeze({inputs:2,outputs:1})}),sr=Object.freeze({type:"native",body:Object.freeze([91]),lengths:Object.freeze({inputs:2,outputs:1})}),or=Object.freeze({type:"native",body:Object.freeze([82]),lengths:Object.freeze({inputs:2,outputs:1})}),nr=Object.freeze({type:"native",body:Object.freeze([82]),lengths:Object.freeze({inputs:2,outputs:1})}),cr=Object.freeze({type:"native",body:Object.freeze([98]),lengths:Object.freeze({inputs:2,outputs:1})}),qs=Object.freeze({type:"native",body:Object.freeze([71]),lengths:Object.freeze({inputs:2,outputs:1})}),Qs=Object.freeze({type:"native",body:Object.freeze([71]),lengths:Object.freeze({inputs:2,outputs:1})}),ar=Object.freeze({type:"native",body:Object.freeze([92]),lengths:Object.freeze({inputs:2,outputs:1})}),rr=Object.freeze({type:"native",body:Object.freeze([113]),lengths:Object.freeze({inputs:2,outputs:1})}),ir=Object.freeze({type:"native",body:Object.freeze([114]),lengths:Object.freeze({inputs:2,outputs:1})}),pr=Object.freeze({type:"native",body:Object.freeze([115]),lengths:Object.freeze({inputs:2,outputs:1})}),lr=Object.freeze({type:"native",body:Object.freeze([69]),lengths:Object.freeze({inputs:1,outputs:1})}),Co=Object.freeze({type:"native",body:Object.freeze([167]),lengths:Object.freeze({inputs:1,outputs:1})}),So=Object.freeze({type:"native",body:Object.freeze([167]),lengths:Object.freeze({inputs:1,outputs:1})}),ur=Object.freeze({type:"native",body:Object.freeze([170]),lengths:Object.freeze({inputs:1,outputs:1})}),fr=Object.freeze({type:"native",body:Object.freeze([171]),lengths:Object.freeze({inputs:1,outputs:1})}),Er=Object.freeze({type:"native",body:Object.freeze([168]),lengths:Object.freeze({inputs:1,outputs:1})}),hr=Object.freeze({type:"native",body:Object.freeze([169]),lengths:Object.freeze({inputs:1,outputs:1})}),Do=Object.freeze({type:"native",body:Object.freeze([]),lengths:Object.freeze({inputs:1,outputs:1})}),es=Object.freeze({type:"native",body:Object.freeze([193]),lengths:Object.freeze({inputs:1,outputs:1})}),ts=Object.freeze({type:"native",body:Object.freeze([192]),lengths:Object.freeze({inputs:1,outputs:1})}),br=Object.freeze({type:"native",body:Object.freeze([]),lengths:Object.freeze({inputs:1,outputs:1})}),Or=Object.freeze({type:"native",body:Object.freeze([]),lengths:Object.freeze({inputs:1,outputs:1})}),_r=Object.freeze({type:"native",body:Object.freeze([176]),lengths:Object.freeze({inputs:1,outputs:1})}),dr=Object.freeze({type:"native",body:Object.freeze([177]),lengths:Object.freeze({inputs:1,outputs:1})}),mr=Object.freeze({type:"native",body:Object.freeze([175]),lengths:Object.freeze({inputs:1,outputs:1})}),gr=Object.freeze({type:"native",body:Object.freeze([174]),lengths:Object.freeze({inputs:1,outputs:1})}),xr=Object.freeze({type:"native",body:Object.freeze([196]),lengths:Object.freeze({inputs:1,outputs:1})}),Tr=Object.freeze({type:"native",body:Object.freeze([196]),lengths:Object.freeze({inputs:1,outputs:1})}),yr=Object.freeze({type:"native",body:Object.freeze([196]),lengths:Object.freeze({inputs:1,outputs:1})}),Ir=Object.freeze({type:"native",body:Object.freeze([196]),lengths:Object.freeze({inputs:1,outputs:1})}),Fo=Object.freeze({type:"native",body:Object.freeze([195]),lengths:Object.freeze({inputs:1,outputs:1})}),ko=Object.freeze({type:"native",body:Object.freeze([195]),lengths:Object.freeze({inputs:1,outputs:1})}),Uo=Object.freeze({type:"native",body:Object.freeze([194]),lengths:Object.freeze({inputs:1,outputs:1})}),Lo=Object.freeze({type:"native",body:Object.freeze([194]),lengths:Object.freeze({inputs:1,outputs:1})}),zr=Object.freeze({type:"native",body:Object.freeze([185]),lengths:Object.freeze({inputs:1,outputs:1})}),Nr=Object.freeze({type:"native",body:Object.freeze([186]),lengths:Object.freeze({inputs:1,outputs:1})}),eo=Object.freeze({type:"native",body:Object.freeze([183]),lengths:Object.freeze({inputs:1,outputs:1})}),to=Object.freeze({type:"native",body:Object.freeze([184]),lengths:Object.freeze({inputs:1,outputs:1})}),Pr=Object.freeze({type:"native",body:Object.freeze([187]),lengths:Object.freeze({inputs:1,outputs:1})}),Ar=Object.freeze({type:"native",body:Object.freeze([180]),lengths:Object.freeze({inputs:1,outputs:1})}),jr=Object.freeze({type:"native",body:Object.freeze([181]),lengths:Object.freeze({inputs:1,outputs:1})}),so=Object.freeze({type:"native",body:Object.freeze([178]),lengths:Object.freeze({inputs:1,outputs:1})}),oo=Object.freeze({type:"native",body:Object.freeze([179]),lengths:Object.freeze({inputs:1,outputs:1})}),Rr=Object.freeze({type:"native",body:Object.freeze([182]),lengths:Object.freeze({inputs:1,outputs:1})}),Lt=Object.freeze(Object.assign({"Flogram./":Ao,"Flogram.*":jo,"Flogram.+":Po,"Flogram.-":Ro},{"Flogram.fp64.div":xa,"Flogram.fp64.mul":Ta,"Flogram.fp64.add":ga,"Flogram.fp64.sub":Ia,"Flogram.fp64.neg":ya,"Flogram.fp64.gt":Va,"Flogram.fp64.lt":Ba,"Flogram.fp64.le":Xa,"Flogram.fp64.ge":Za,"Flogram.fp64.ne":cr,"Flogram.fp64.eq":tr,"Flogram.fp64.toi32":ur,"Flogram.fp64.tou32":fr,"Flogram.fp64.tou64":dr,"Flogram.fp64.toi64":_r,"Flogram.fp64.tofp32":Rr},{"Flogram.u64.add":za,"Flogram.u64.sub":ja,"Flogram.u64.mul":Pa,"Flogram.u64.div":Na,"Flogram.u64.rem":ka,"Flogram.u64.gt":La,"Flogram.u64.lt":wa,"Flogram.u64.le":Ha,"Flogram.u64.ge":Wa,"Flogram.u64.ne":nr,"Flogram.u64.eq":er,"Flogram.u64.toi32":So,"Flogram.u64.tou32":So,"Flogram.u64.toi64":br,"Flogram.u64.tofp32":jr,"Flogram.u64.tofp64":Nr},{"Flogram.i64.add":Ra,"Flogram.i64.sub":Da,"Flogram.i64.neg":Aa,"Flogram.i64.mul":Sa,"Flogram.i64.div":Ca,"Flogram.i64.rem":Ua,"Flogram.i64.gt":va,"Flogram.i64.lt":Ma,"Flogram.i64.le":Ga,"Flogram.i64.ge":Ja,"Flogram.i64.ne":or,"Flogram.i64.eq":Qa,"Flogram.i64.toi32":Co,"Flogram.i64.tou32":Co,"Flogram.i64.tou64":Or,"Flogram.i64.tofp32":Ar,"Flogram.i64.tofp64":zr},{"Flogram.fp32.div":Ao,"Flogram.fp32.mul":jo,"Flogram.fp32.add":Po,"Flogram.fp32.sub":Ro,"Flogram.fp32.neg":Fa,"Flogram.fp32.gt":Ya,"Flogram.fp32.lt":Ka,"Flogram.fp32.le":$a,"Flogram.fp32.ge":qa,"Flogram.fp32.ne":ar,"Flogram.fp32.eq":sr,"Flogram.fp32.toi32":Er,"Flogram.fp32.tou32":hr,"Flogram.fp32.tou64":mr,"Flogram.fp32.toi64":gr,"Flogram.fp32.tofp64":Pr},{"Flogram.u32.add":Cs,"Flogram.u32.sub":Fs,"Flogram.u32.mul":Ds,"Flogram.u32.div":Ss,"Flogram.u32.rem":Ys,"Flogram.u32.gt":Ms,"Flogram.u32.lt":Ks,"Flogram.u32.le":Xs,"Flogram.u32.ge":Js,"Flogram.u32.ne":Qs,"Flogram.u32.eq":Zs,"Flogram.u32.toi32":Do,"Flogram.u32.toi64":yr,"Flogram.u32.tou64":Ir,"Flogram.u32.tofp32":oo,"Flogram.u32.tofp64":to},{"Flogram.i32.add":ks,"Flogram.i32.sub":Vs,"Flogram.i32.neg":vs,"Flogram.i32.mul":Ls,"Flogram.i32.div":Us,"Flogram.i32.rem":ws,"Flogram.i32.gt":Bs,"Flogram.i32.lt":Gs,"Flogram.i32.le":Hs,"Flogram.i32.ge":$s,"Flogram.i32.ne":qs,"Flogram.i32.eq":Ws,"Flogram.i32.toi64":xr,"Flogram.i32.tou64":Tr,"Flogram.i32.tou32":Do,"Flogram.i32.tofp32":so,"Flogram.i32.tofp64":eo},{"Flogram.i16.add":ks,"Flogram.i16.sub":Vs,"Flogram.i16.neg":vs,"Flogram.i16.mul":Ls,"Flogram.i16.div":Us,"Flogram.i16.rem":ws,"Flogram.i16.gt":Bs,"Flogram.i16.lt":Gs,"Flogram.i16.le":Hs,"Flogram.i16.ge":$s,"Flogram.i16.ne":qs,"Flogram.i16.eq":Ws,"Flogram.i16.toi32":es,"Flogram.i16.tou32":es,"Flogram.i16.toi64":Fo,"Flogram.i16.tou64":ko,"Flogram.i16.tofp32":so,"Flogram.i16.tofp64":eo},{"Flogram.u16.add":Cs,"Flogram.u16.sub":Fs,"Flogram.u16.mul":Ds,"Flogram.u16.div":Ss,"Flogram.u16.rem":Ys,"Flogram.u16.gt":Ms,"Flogram.u16.lt":Ks,"Flogram.u16.le":Xs,"Flogram.u16.ge":Js,"Flogram.u16.ne":Qs,"Flogram.u16.eq":Zs,"Flogram.u16.toi32":es,"Flogram.u16.tou32":es,"Flogram.u16.toi64":Fo,"Flogram.u16.tou64":ko,"Flogram.u16.tofp32":oo,"Flogram.u16.tofp64":to},{"Flogram.i8.add":ks,"Flogram.i8.sub":Vs,"Flogram.i16.neg":vs,"Flogram.i8.mul":Ls,"Flogram.i8.div":Us,"Flogram.i8.rem":ws,"Flogram.i8.gt":Bs,"Flogram.i8.lt":Gs,"Flogram.i8.le":Hs,"Flogram.i8.ge":$s,"Flogram.i8.ne":qs,"Flogram.i8.eq":Ws,"Flogram.i8.toi32":ts,"Flogram.i8.tou32":ts,"Flogram.i8.toi64":Uo,"Flogram.i8.tou64":Lo,"Flogram.i8.tofp32":so,"Flogram.i8.tofp64":eo},{"Flogram.u8.add":Cs,"Flogram.u8.sub":Fs,"Flogram.u8.mul":Ds,"Flogram.u8.div":Ss,"Flogram.u8.rem":Ys,"Flogram.u8.gt":Ms,"Flogram.u8.lt":Ks,"Flogram.u8.le":Xs,"Flogram.u8.ge":Js,"Flogram.u8.ne":Qs,"Flogram.u8.eq":Zs,"Flogram.u8.toi32":ts,"Flogram.u8.tou32":ts,"Flogram.u8.toi64":Uo,"Flogram.u8.tou64":Lo,"Flogram.u8.tofp32":oo,"Flogram.u8.tofp64":to},{"Flogram.bool.and":rr,"Flogram.bool.or":ir,"Flogram.bool.xor":pr,"Flogram.bool.not":lr}));var{LEB128_ENCODE:Xe}=xt,mp=new Int8Array(1),gp=new Uint8Array(1),Cr=c=>{let s=[],a=!0;for(;a;){let l=c&127;c>>=7,c===0&&!(l&64)||c===-1&&l&64?a=!1:l|=128,s.push(l)}return new Uint8Array(s)},Sr=c=>{let s=[],a=!0;for(;a;){let l=c&127;c>>=7,c===0?a=!1:l|=128,s.push(l)}return new Uint8Array(s)},Dr=c=>{let s=[];for(;c>=128;)s.push(c&127|128),c>>>=7;return s.push(c),new Uint8Array(s)},Fr=128,kr=127,vo=64,Ur=c=>{c=c<<16>>16;let s=[];for(;;){let a=c&kr;c=c>>7;let l=c===0,y=(a&vo)===0,$=l&&y,e=c===-1,Z=(a&vo)!==0;if($||e&&Z){s.push(a);break}a=a|Fr,s.push(a)}return s};var Lr=c=>{let s=new Float32Array(1);return s[0]=parseFloat(c),new Uint8Array(s.buffer)},Vo=c=>{let s=[],a=!0;for(;a;){let l=c&127;c>>=7,c===0&&!(l&64)||c===-1&&l&64?a=!1:l|=128,s.push(l)}return new Uint8Array(s)},vr=c=>Xe(c),Vr=c=>{let s=new Float64Array(1);return s[0]=c,new Uint8Array(s.buffer)},Yr=c=>{let s=[];for(;c>=128;)s.push(c&127|128),c>>>=7;return s.push(c),new Uint8Array(s)},wr=c=>{let s=[],a=!0;for(;a;){let l=c&127;c>>=7,c===0&&!(l&64)||c===-1&&l&64?a=!1:l|=128,s.push(l)}return new Uint8Array(s)},Mr=c=>{let s=new Uint8Array(1);return s[0]=c==="TRUE"?1:c==="FALSE"?0:c,s},Br=c=>{let s=c.charCodeAt(0);return Xe(s)},Yo=()=>{let c=new ArrayBuffer(4);return new Float32Array(c)[0]=-0,[...new Uint8Array(c)]},Kr=Object.freeze({type:"native",identity:127,opcode:65,encode:Vo,link:Object.freeze({load:Object.freeze({opcode:40,align:2,offset:0,size:4}),store:Object.freeze({opcode:54,align:2,offset:0,size:4})})}),Gr=Object.freeze({type:"native",identity:127,opcode:65,none:Xe(-1),encode:Br,link:Object.freeze({load:Object.freeze({opcode:44,align:2,offset:0,size:4}),store:Object.freeze({opcode:54,align:2,offset:0,size:4})})}),Hr=Object.freeze({type:"native",identity:127,opcode:65,none:Xe(-1),encode:Mr,link:Object.freeze({load:Object.freeze({opcode:40,align:2,offset:0,size:4}),store:Object.freeze({opcode:54,align:2,offset:0,size:4}),values:{TRUE:1,FALSE:0}})}),Xr=Object.freeze({type:"native",identity:124,opcode:68,none:Yo(),encode:Vr,link:Object.freeze({load:Object.freeze({opcode:43,align:3,offset:0,size:8}),store:Object.freeze({opcode:57,align:3,offset:0,size:8})})}),$r=Object.freeze({type:"native",identity:126,opcode:66,none:Xe(-1),encode:Yr,link:Object.freeze({load:Object.freeze({opcode:43,align:3,offset:0,size:8}),store:Object.freeze({opcode:57,align:3,offset:0,size:8})})}),Jr=Object.freeze({type:"native",identity:126,opcode:66,none:Xe(-9223372036854776e3),encode:wr,link:Object.freeze({load:Object.freeze({opcode:43,align:3,offset:0,size:8}),store:Object.freeze({opcode:57,align:3,offset:0,size:8})})}),Wr=Object.freeze({type:"native",identity:125,opcode:67,none:Yo(),encode:Lr,link:Object.freeze({load:Object.freeze({opcode:42,align:2,offset:0,size:4}),store:Object.freeze({opcode:56,align:2,offset:0,size:4})})}),Zr=Object.freeze({type:"native",identity:127,opcode:65,none:Xe(-1),encode:vr,link:Object.freeze({load:Object.freeze({opcode:40,align:2,offset:0,size:4}),store:Object.freeze({opcode:54,align:2,offset:0,size:4})})}),qr=Object.freeze({type:"native",identity:127,opcode:65,none:Xe(-2147483648),encode:Vo,link:Object.freeze({load:Object.freeze({opcode:40,align:2,offset:0,size:4}),store:Object.freeze({opcode:54,align:2,offset:0,size:4})})}),Qr=Object.freeze({type:"native",identity:127,opcode:65,none:Xe(-32768),encode:Ur,link:Object.freeze({load:Object.freeze({opcode:40,align:2,offset:0,size:4}),store:Object.freeze({opcode:54,align:2,offset:0,size:4})})}),ei=Object.freeze({type:"native",identity:127,opcode:65,encode:Dr,none:Xe(-1),link:Object.freeze({load:Object.freeze({opcode:40,align:2,offset:0,size:4}),store:Object.freeze({opcode:54,align:2,offset:0,size:4})})}),ti=Object.freeze({type:"native",identity:127,opcode:65,none:Xe(-128),encode:Cr,decode:c=>new Int8Array([c])[0],link:Object.freeze({load:Object.freeze({opcode:44,align:0,offset:0,size:4}),store:Object.freeze({opcode:58,align:0,offset:0,size:4})})}),si=Object.freeze({type:"native",identity:127,opcode:65,none:Xe(-1),encode:Sr,link:Object.freeze({load:Object.freeze({opcode:43,align:0,offset:0,size:4}),store:Object.freeze({opcode:58,align:0,offset:0,size:4})})}),ut=Object.freeze({"Flogram.String":Kr,"Flogram.Char":Gr,"Flogram.Bool":Hr,"Flogram.FP64":Xr,"Flogram.U64":$r,"Flogram.I64":Jr,"Flogram.FP32":Wr,"Flogram.U32":Zr,"Flogram.I32":qr,"Flogram.I16":Qr,"Flogram.U16":ei,"Flogram.I8":ti,"Flogram.U8":si});var oi=Object.freeze(["FP64","U64","I64","FP32","U32","I32","U16","I16","U8","I8","Bool","Char","Array","String","Link","Maybe"]),vt=oi;var{TYPES_ASSIGN:ni,TYPES_DRAW:ci,TYPES_ARRAY:te,TYPES_ARRAY_ASSIGNMENT:ai,TYPES_BRANCH_MATCH:ri,TYPES_BRANCH_DEFAULT:ii,TYPES_CONDITION:no,TYPES_LOOP:ss,TYPES_WHILE:pi,TYPES_FOREACH:li,TYPES_DATA:os,TYPES_ENUMERATION:ft,TYPES_EXPRESSION:Tt,TYPES_LINK:ht,TYPES_LOCAL:Se,TYPES_CONCAT:wo,TYPES_OBJECT:de,TYPES_RETURN:co,TYPES_SELECT:ot,TYPES_MEMBER:Vt,TYPES_STORE:Mo,TYPES_BREAK:ui,TYPES_LITERAL:tt,TYPES_ARRAY_ACCESS:ns,TYPES_LINK_TO:cs,TYPES_VALUE_AT:Yt,TYPES_DROP:Bo,TYPES_MAYBE:wt,TYPES_MOVE:fi,TYPES_NATIVE:Pe,TYPES_STRING:ue,TYPES_FREE:Ei,TYPES_BRANCH:Ko,TYPES_CONTINUE:Go,TYPES_DEFAULT_BLOCK:Ho,TYPES_BLOCK_END:bt,TYPES_STATEMENT:Xo,TYPES_DESTRUCTOR:$o,TYPES_SIZE:Jo,TYPES_WHILE_CONDITION:Wo,TYPES_FOREACH_CONDITION:Zo,TYPES_FOREACH_END:qo,TYPES_FP32:hi,TYPES_FP64:bi}=Jt,{K_ASSIGNMENT:as,K_FLOGRAM:Qo}=Wt.Keywords,Mt=2,rs=3,is=12,Bt=13,Be=16,rt=26,f=65,en=71,Oi=113,_i=114,ao=70,Fe=32,Kt=33,G=35,Ae=36,di=15,ro=11,tn=4,mi=5,nt=64,yt=127,$e=108,gi=109,se=106,xi=107,Ke=54,It=40,je=0,Re=2,Ti="alloc",yi="dealloc",sn="merge",on="save",Ii="undo",zi="undoPenultimate",Ni="draw",Pi="drawI64",Ai="drawFP32",ji="drawFP64",Ri=999999,nn=888888,Ci=777777,L=0,Ge=1,Si=4,Gt=8,cn=8,an="Flogram.draw",ps=new Set(["==","!=",">",">=","<","<=","!","&","|"]),{LEB128_ENCODE:_}=xt,io,j=(c,s)=>`${s}.${c}`,rn=(c,s,a)=>{let l=a.get(c);if(l&&l.length===1)return l[0];if(l&&l.length>1)return l[0];throw console.log(c),console.log(a),Error("No Callees were found")};function ls(c,s,a,l,y){c?.description?.inputs.length>0?io=c.description.inputs[0].data.name:c?.description?.outputs.length>0&&(io=c.description.outputs[0].data.name);let $=t=>{Qe(t.collection).length},e=[],Z=new Set,ae=!1,fe=t=>{Z.add(t)},re=()=>{e.push(Be,Ti),fe("alloc")},ye=t=>{t===hi?(e.push(Be,Ai),fe("drawFP32")):t===bi?(e.push(Be,ji),fe("drawFP64")):t?.includes("64")?(e.push(Be,Pi),fe("drawI64")):(e.push(Be,Ni),fe("draw"))},Ue=(t=L)=>{e.push(f,0),re(),e.push(Ae,t)},We=()=>{e.push(G,L),e.push(G,Ge),e.push(Be,on),e.push(G,Ge),e.push(G,L),e.push(Be,on),fe("save")},jt=()=>{e.push(Be,Ii),e.push(Ae,Ge),e.push(Ae,L),fe("undo")},Rt=()=>{e.push(Be,zi),e.push(Ae,Ge),e.push(Ae,L),fe("undoPenultimate")},De=()=>{e.push(Be,sn),fe("merge")},Ot=(t,o=!1)=>{let n=t.path===Qo&&t.name!==ue&&t.layout!==te;return o?n&&t.mutable:n},{description:it}=c,{inputs:Os,locals:Ct,statements:_t}=it,xe=new Map,pe=new Map,pt=new Map,bo=new Map;{let t=0,o=n=>{for(let r of n){let{name:b,data:z}=r;switch(xe.set(b,t),pe.set(b,r),z.type){case wt:case os:{let{name:F,path:v}=z,K=j(F,v);switch(F){case ue:{t=t+2|0;break}default:{let k=s.get(K);switch(k.type){case Pe:{t=t+1|0;break}case ft:{t=t+1|0;break}case de:{let{length:oe}=k;t=t+2|0;break}}break}}break}case te:{t=t+2|0;break}case ht:{z.name===ue||z.name===te?t=t+2|0:t=t+1|0;break}}}};o(Os),o(Ct)}let Le=0,Ze=[];for(let t of Ct){let{data:o}=t,n=()=>{Ze.push(1,yt),Le=Le+1|0},r=()=>{Ze.push(1,yt),Le=Le+1|0,Ze.push(1,yt),Le=Le+1|0},b=()=>{Ze.push(1,yt),Le=Le+1|0},z=F=>{let{identity:v}=F;Ze.push(1,v),Le=Le+1|0};if(Ot(o,!0)){n();continue}switch(o.type){case te:{r();break}case ht:{o.name===te||o.name===ue?r():n();break}case wt:case os:{let{name:F,path:v}=o;switch(F){case ue:{r();break}default:{let K=j(F,v),k=s.get(K);switch(k.type){case Pe:{z(k);break}case ft:{b();break}case de:{r();break}}break}}break}}}((t,o)=>{for(let[n,r]of t)if(r.type==o){Ze.push(1,yt),Le=Le+1|0;break}})(s,de);let _s=_(Le);e.push(..._s,...Ze);let qe=t=>{if(typeof t!==de)return t;switch(t.type){case Se:return t.name;case cs:return qe(t.value);case Yt:return qe(t.link);case Vt:return`${t.type}_${t.trail.join("_")}`;case ns:return t.array.name;case ot:return qe(t.value);case Mo:return qe(t.link)}return null},Qe=t=>{switch(t.type){case tt:return t;case Se:return pe.get(t.name)?.data;case Yt:return Qe(t.link);case cs:return Qe(t.value);case Jo:{if(input.value.type===Se)return{name:"I32",path:"Flogram",type:"data"};break}case ns:return pe.get(qe(t));case ot:{let{value:o,trail:n}=JSON.parse(JSON.stringify(t)),{name:r}=o,b=pe.get(r||qe(o)),{data:z}=b,F=j(z.name,z.path),v=s.get(F),{indivisibles:K}=v,k=JSON.parse(JSON.stringify(n)),oe=v;for(;k.length>0;){let ze=k.shift();if(k.length>0){let Ie=oe.members.get(ze),Ne=j(Ie.name,Ie.path);oe=s.get(Ne);continue}oe=oe.members.get(ze)}return oe}}},H=(t,o=co)=>{let n=0,r=[],b=(Y,u)=>{let S={type:"call",key:Y,inputs:u};r.unshift(S)},z=Y=>{let u={type:"value",value:Y};r.unshift(u)},F=Y=>{let u={type:Vt,member:Y};r.unshift(u)},v=(Y,u,S,U)=>{let g={key:null,stop:!1},I;if(Y&&vt.includes(Y.data.name)){let{data:Te}=Y,{name:V}=Te;I=j(V.toLowerCase()+"."+He(S),u),io=V}else if(Y){let{data:Te}=Y,{name:V,path:me}=Te,h=j(V,me),i=s.get(h),{indivisibles:m}=i,{mapTrail:N}=m,d=N.size-1;for(let[w,R]of N){r.unshift({type:"compare",currentIndex:d,name:S}),I=j(R.data.name.toLowerCase()+"."+He(S),R.data.path);let x=U.map(C=>({type:ot,value:{type:Se,name:C.name},trail:[R.trail]}));b(I,x);var W=x.length-1|0;for(let C=W;C>=0;C=C-1|0){let J=x[C];z(J)}d--}g.stop=!0}return g.key=I,g},K=Y=>{let{inputs:u}=Y,S=u.find(U=>U.type==Tt);if(ps.has(Y.name))return"Bool";if(S){let U=u.map(I=>{if(I.type===Se)return pe.get(I.name);if(I.type===tt)return{data:I};if(I.type===Tt)return{data:{name:K(I)}}}),g=l.find(I=>I.description&&Array.isArray(I.description.inputs)?I.description.inputs.length!==U.length?!1:I.description.inputs.every((W,Te)=>W.data.name===U[Te].data.name):!1);return g?ps.has(g.name)?g.description.inputs[0].data.name:g.description.outputs[0].data.name:"unknown"}else{let U=u.map(I=>({data:Qe(I)})),g=l.find(I=>I.description&&Array.isArray(I.description.inputs)?I.description.inputs.length!==U.length?!1:I.description.inputs.every((W,Te)=>W.data.name===U[Te].data.name):!1);return g?ps.has(g.name)?g.description.inputs[0].data.name:g.description.outputs[0].data.name:"unknown"}},k=Y=>{let{inputs:u,name:S,path:U}=Y,g=j(S,U),I=[U],W;if(typeof S===de){let V=S[0];if(W=pe.get(V),W){I.push(W.data.name);for(let h=1;h<=S.length-2;h++)V=S[h],W=pe.get(V),W&&I.push(W.data.name)}let me=S.length-1|0;g=j(S[me],I.join("."))}if(U==="Flogram"&&S!==ci){let V=u.find(i=>i.type===Tt),me=u.find(i=>i.type===tt),h=u.map(i=>pe.get(i.name)).find(Boolean);if(h){let i=v(h,U,S,u);if(g=i.key,i.stop)return}else if(me)g=j(`${me.name.toLowerCase()}.${He(S)}`,U);else if(V)g=j(`${K(V).toLowerCase()}.${He(S)}`,U);else{let i=l.find(m=>m.name===Y.name&&m.path===Y.path&&m.description.inputs.length===Y.inputs.length);g=j(`${ps.has(i.name)?i.description.inputs[0]?.data.name.toLowerCase():i.description.outputs[0]?.data.name.toLowerCase()}.${He(i.name)}`,U)}}if(b(g,u),typeof S===de){let V=rn(g,u,a);if(V){let{procedure:me}=V,{description:h}=me,{self:i}=h,m=pe.get(S[0]),N=j(m.data.name,m.data.path),d=s.get(N);if(d){let w=xe.get(S[0]),{indivisibles:R,members:x}=d,{mapTrail:C}=R;for(let J=i.length-1|0;J>=0;J--){let Q=i[J];if(Q.type===Vt){let B=Q.trail.join(".");if(C.get(B)){let{address:ie}=C.get(B);F({index:w,address:ie})}else{let ie=JSON.parse(JSON.stringify(Q.trail)),ee=d;for(;ie.length>0;){let Ce=ie.shift();if(ie.length>0){let mt=ee.members.get(Ce),kt=j(mt.name,mt.path);ee=s.get(kt);continue}ee=ee.members.get(Ce)}let le=j(ee.name,ee.path),Oe=s.get(le),{indivisibles:et}=Oe,{mapIndex:ne,mapTrail:we}=et,ve=ne.get(0),ge=`${B}.${ve.trail}`,{address:ce}=C.get(ge),Me={index:w,address:ce-8};F(Me)}}}}}}if(g!==an){var Te=u.length-1|0;for(let V=Te;V>=0;V=V-1|0){let me=u[V];z(me)}}},oe=Y=>{let{key:u,inputs:S}=Y;if(u===an){for(let I of S){let W=Qe(I);I.type===ot?W?.name===ue?(e.push(f,..._(nn)),ye(),H(I),e.push(Ae,L),e.push(It,Re,je),ye(),e.push(G,L),e.push(It,Re,je),ye()):(H(I),ye(W?.name)):W?.name===ue||I.type===wo?(e.push(f,..._(nn)),ye(),H(I),ye(),ye()):W?.name===te||W?.layout===te?(e.push(f,..._(Ri)),ye(),H(I),ye(),ye()):(H(I),ye(W?.name))}e.push(f,..._(Ci)),ye(),n=n-S.length|0;return}let U=rn(u,S,a);switch(U.type){case Pe:{let{body:I}=U;e.push(...I);break}case"artificial":{let{index:I}=U;e.push(Be,I);break}}let{lengths:g}=U;n=n-g.inputs|0,n=n+g.outputs|0},ze=Y=>{let{value:u}=Y,S=h=>{let i=0;ae=!0;let m=qe(h),N;if(h.type===ot){let{value:d,trail:w}=JSON.parse(JSON.stringify(h)),{name:R}=d,x=pe.get(R),{data:C}=x,J=j(C.name,C.path),Q=s.get(J),{indivisibles:B}=Q,{mapTrail:ie}=B,ee=w.join("."),le=JSON.parse(JSON.stringify(w)),Oe=Q;for(;le.length>0;){let ne=le.shift();if(le.length>0){let we=Oe.members.get(ne),ve=j(we.name,we.path);Oe=s.get(ve);continue}Oe=Oe.members.get(ne)}let et=j(Oe.name,Oe.path);N=s.get(et)}else{let d=pe.get(m),{data:w}=d,{name:R,path:x,segment:C}=w,J=j(R,x);N=s.get(J)}if(N){switch(N.type){case Pe:{ze({value:h});let{link:d}=N,{load:w}=d;e.push(w.opcode,w.align,w.offset),i=i+1|0;break}case de:{let d=0,w=()=>{},R=Q=>{ze({value:h});let{link:B}=Q,{load:ie}=B;e.push(ie.opcode,ie.align,ie.offset+d|0),i=i+1|0,d=d+ie.size|0},x=()=>{},{indivisibles:C}=N,{mapTrail:J}=C;for(let Q of J.values()){if(Q.type===ht){x();continue}let{data:B}=Q,{name:ie,path:ee}=B,le=j(ie,ee),Oe=s.get(le);switch(Oe.type){case Pe:{R(Oe);break}case ft:{w();break}}}break}}return i}},U=(h,i)=>{let m=0;ae=!0;let{literal:N,name:d,path:w,size:R}=h,x=R||N.length;h.length&&!R&&(x=parseInt(h.length,10));let C=j(d,w),J=s.get(C);function Q(B){let ie=0,{literal:ee,name:le,path:Oe,vSize:et}=B,ne=et||ee.length;B.length&&!et&&(ne=parseInt(B.length,10));let we=j(le,Oe),ve=s.get(we);Ue(),(ve.type===de||le===ue&&B.layout===te||B.contains===te)&&(e.push(f,..._(ne*4*2|0)),re(),e.push(Kt,L),We());for(let ge=0;ge<ne;ge++){let ce=ee[ge];if(ce)if(ce.name===ue&&B.layout===te||ce.layout===te&&ve.type!==de){let Me=[];if(ce.layout===te){let Ce=ce.size||ce.literal.length;e.push(G,L),e.push(G,L),e.push(G,L),e.push(f,..._(ge)),e.push(f,..._(8)),e.push($e),e.push(se),Me.push(ce.literal),Q(ce),e.push(G,L),e.push(Ke,Re,je),e.push(f,..._(4)),e.push(f,..._(ge)),e.push(f,..._(8)),e.push($e),e.push(se),e.push(se),e.push(f,Ce),e.push(Ke,Re,je),e.push(Ae,L)}else{let Ce=ce.size||ce.literal.length;for(let kt=0;kt<Ce;kt++)Me.push({type:ce.type,path:ce.path,name:"I32",literal:ce.literal[kt].charCodeAt().toString()});let mt={type:tt,name:"I32",layout:te,path:ce.path,literal:Me};e.push(G,L),e.push(G,L),e.push(G,L),e.push(f,..._(ge)),e.push(f,..._(8)),e.push($e),e.push(se),Q(mt),e.push(G,L),e.push(Ke,Re,je),e.push(f,..._(4)),e.push(f,..._(ge)),e.push(f,..._(8)),e.push($e),e.push(se),e.push(se),e.push(f,Ce),e.push(Ke,Re,je),e.push(Ae,L)}}else switch(ve.type){case Pe:{let{link:Me}=ve,{store:Ce}=Me;e.push(f,..._(Ce.size)),re(),!ce||ce.type===tt?e.push(ve.opcode,...ve.encode(ce?.literal||0)):H(ce),e.push(Ce.opcode,Ce.align,Ce.offset),De(),ie=3;break}case de:{e.push(G,L),e.push(G,L),e.push(f,..._(ge)),e.push(f,..._(8)),e.push($e),e.push(se),H(ce),e.push(Ae,Ge),e.push(Ke,Re,je),e.push(Ae,L),e.push(G,L),e.push(f,..._(4)),e.push(f,..._(ge)),e.push(f,..._(8)),e.push($e),e.push(se),e.push(se),e.push(G,Ge),e.push(Ke,Re,je);break}}}}return Q(h),i?x:(e.push(G,L),e.push(f,..._(x)),m=1,m)},g=(h,i,m=!0)=>{let N=s.get(i);Ue();let d=(x,C)=>{We(),Rt(),e.push(G,L),e.push(G,L),e.push(G,L),jt(),e.push(f,..._(C)),e.push(se),e.push(G,L),e.push(Ke,Re,je),e.push(f,..._(C)),e.push(f,..._(4)),e.push(se),e.push(se),e.push(f,..._(x)),e.push(Ke,Re,je),e.push(Ae,L)},w=[];for(let[x,C]of N.members){if(!C)continue;let J=h.find(ie=>ie.name===x)||{name:x,value:C.value},Q=j(C.name,C.path),B=s.get(Q);if(C.type===te){e.push(f,..._(Gt)),re(),e.push(rt),w.push({data:{keyName:x,keyData:C},literal:J});continue}switch(B.type){case Pe:{let{link:ie}=B,{store:ee}=ie;if(C.type===ht)We(),e.push(f,..._(4)),re(),H(J.value),e.push(ee.opcode,ee.align,ee.offset),jt();else if(C.name===ue)e.push(f,..._(Gt)),re(),e.push(rt),w.push({data:{keyName:x,keyData:C},literal:J});else{e.push(f,..._(ee.size)),re();let le=JSON.parse(JSON.stringify(J.value));le.literal&&(le.name!==C.name||le.path!==C.path)&&(le={...le,name:C.name,path:C.path}),H(le),e.push(ee.opcode,ee.align,ee.offset)}De();break}case de:{e.push(f,..._(Gt)),re(),e.push(rt),w.push({data:{keyName:x,keyData:C},literal:J});break}}}if(w.length>0){let x=w[0],{data:C,literal:J}=x,{keyName:Q,keyData:B}=C,{type:ie,name:ee,layout:le,path:Oe}=B,ne=(ge=>{let ce=N.indivisibles.mapTrail;if(ce.has(ge))return ce.get(ge).address;let Me=Array.from(ce.entries()).filter(([Ce])=>Ce.startsWith(`${ge}.`));return Me.length?(Me.sort((Ce,mt)=>Ce[1].address-mt[1].address),Me[0][1].address-8):null})(Q),we=j(ee,Oe),ve=s.get(we);if(ee===ue)We(),H(J.value),e.push(rt,rt),d(J.value.size||J.value.literal.length,ne),De();else if(ie===te||le===te)if(J.value.type===Se){let ge=xe.get(J.value.name);We();let ce=W(B,ge);d(ce,ne),De()}else{We();let ge=U(J.value,!0);d(ge,ne),De()}else if(ve.type===de){We();let ge=g(J.value.literal,we,!1);d(ge,ne),De()}else console.log("we failed here.......")}let R=N.indivisibles.mapTrail.size+w.length;return m&&(e.push(G,L),e.push(f,..._(R))),R},I=(h,i)=>{let m=0;ae=!0;let N=pe.get(i),d;if(N){let{data:R}=N,{name:x,path:C,segment:J}=R;d=j(x,C)}else{let R=x=>{if(x.type===tt)return j(x.name,x.path);if(x.type===Tt)return R(x.inputs[0]);if(x.type===Yt)return R(x.link);if(x.type===cs)return R(x.value);if(x.type===Se){let C=pe.get(x.name),{data:J}=C,{name:Q,path:B,segment:ie}=J;return j(Q,B)}else if(x.type===ot){let C=s.get(R(x.value)),{indivisibles:J}=C,{mapTrail:Q}=J,B=x.trail.join("."),{data:ie}=Q.get(B),{name:ee,path:le}=ie;return j(ee,le)}};d=R(h)}let w=s.get(d);switch(w.type){case Pe:{let{link:R}=w,{store:x}=R;e.push(f,..._(x.size)),re(),e.push(Ae,L),e.push(G,L),H(h),e.push(x.opcode,x.align,x.offset),e.push(G,L),m=m+7|0;break}case de:{let R=0,x=()=>{},C=ee=>{H(h);let{link:le}=ee,{load:Oe}=le;e.push(Oe.opcode,Oe.align,Oe.offset+R|0),m=m+1|0,R=R+Oe.size|0},J=()=>{},{indivisibles:Q}=w,{mapTrail:B}=Q;console.log(h);let ie=h.trail.join(".");switch(console.log(Q),console.log(B),h.type){case ot:{let ee=B.get(ie);if(ee&&Ot(ee.data)){let le=j(ee.data.name,ee.data.path),Oe=s.get(le),{link:et}=Oe,{store:ne}=et;e.push(f,..._(ne.size)),re(),e.push(Ae,L),e.push(G,L),H(h),e.push(ne.opcode,ne.align,ne.offset),e.push(G,L);break}}default:{H(h);break}}break}}return m},W=(h,i=0)=>{let{name:m,path:N}=h,d=j(m,"Flogram"),w=s.get(d),{link:R}=w,{store:x,load:C}=R,J=Number(h.length);Ue();for(let Q=0;Q<J;Q++){e.push(f,..._(x.size)),re();let B=i;V(B,B+1|0),e.push(f,..._(Q)),e.push(f,C.size),e.push($e),e.push(se),e.push(C.opcode,C.align,C.offset),e.push(x.opcode,x.align,x.offset),De()}return J},Te=(h,i)=>{let m=s.get(i),{opcode:N}=m,d=m.encode(h);e.push(N,...d)},V=(h,i)=>{for(;h<i;)e.push(Fe,h),h=h+1|0};switch(u.type){case Tt:{k(u);break}case"instance":{let{path:h,members:i}=u;var me=i.length-1|0;for(let m=me;m>=0;m=m-1|0){let N=i[m],{path:d,value:w}=N;z(w)}break}case wt:{let{data:h}=u,{name:i,path:m}=h,N=j(i,m),d=s.get(N);u.layout==="NONE"?e.push(d.opcode,...d.none):H(u.value),n=n+1|0;break}case Yt:{let{link:h}=u;y.optimization;let i=S(h);n=n+i|0;break}case cs:{let{value:h}=u,i=qe(h);if(pe.get(i)?.data.type===te){H({name:i,type:Se});return}let N=I(h,i);n=n+N|0;break}case Jo:{let{value:h}=u;switch(h.type){case Se:{if(pt.get(h.name)&&y.optimization){let i=pt.get(h.name),m=i.source.length;typeof i.source.literal===ue.toLowerCase()&&(m=literal.value.literal.length),e.push(f,..._(m))}else{let i=xe.get(h.name);V(i+1|0,i+2|0)}break}}break}case wo:{let{values:h}=u;Ue(Ge);for(let i of h){let m=Qe(i),N=j(m.name,m.path);if(m.name===ue||m.type===te||m.layout===te)H(i,as),e.push(rt),e.push(rt);else{let d=s.get(N),{link:w}=d,{store:R}=w;e.push(f,..._(R.size)),re(),H(i),e.push(R.opcode,R.align,R.offset)}De()}Ue(),e.push(G,Ge),e.push(G,L),e.push(G,Ge),e.push(xi),e.push(f,4),e.push(gi),n=n+2|0;break}case tt:{let{literal:h,name:i,path:m}=u,N=j(i,m),d=s.get(N);if(u.layout===te){U(u),n=n+2|0;return}else if(i===ue){let w=[];for(let x of h)w.push({type:tt,literal:x.charCodeAt(0).toString(),name:ue,path:"Flogram"});let R={...u,literal:w};U(R),n=n+2|0;return}d&&d.type===de?(g(h,N),n=n+2|0):(d||console.log(u,"NO SHAPE FOUND!!!!!!!!!"),Te(h,N),n=n+1|0);break}case ns:{let{array:h,index:i}=u,{name:m}=h,N=xe.get(m),d=pe.get(m),w=j(d.data.name,d.data.path);ae=!0;let R=s.get(w);switch(R.type){case Pe:if(!(d.data.contains===te||d.data?.type===te&&d.data?.layout===te||d.data?.name===ue)){let{link:x}=R,{load:C}=x;V(N,N+1|0),H(i),e.push(f,C.size),e.push($e),e.push(se),e.push(C.opcode,C.align,C.offset),n=n+2|0;break}case de:{V(N,N+1|0),H(i),d.data?.type===te&&d.data?.name!==ue&&!d.data?.contains?e.push(f,4):e.push(f,..._(cn)),e.push($e),e.push(se),e.push(It,Re,je),V(N,N+1|0),e.push(f,..._(4)),H(i),d.data?.type===te&&d.data?.name!==ue&&!d.data.contains?e.push(f,4):e.push(f,..._(cn)),e.push($e),e.push(se),e.push(se),e.push(It,Re,je),n=n+2|0;break}}break}case fi:{H(u.value);break}case Se:{let{name:h}=u,i=xe.get(h),m=pe.get(h);if(y.optimization){let d=pt.get(m.name);if(d){let w=R=>R.name==="Bool"?R.literal==="FALSE"||R.literal=="0"?0:1:parseInt(d.source.literal,10);if(d.source.name!==ue&&d.source.layout!==te){let R=w(d.source);e.push(f,..._(R));return}}}let{data:N}=m;switch(N.type){case ht:{N.name===te||N.name===ue?(V(i,i+2|0),n=n+2|0):(V(i,i+1|0),n=n+1|0);break}case te:{if(o===as&&N.length){let d=W(N,i);e.push(G,L),e.push(f,..._(d))}else V(i,i+2|0),n=n+2|0;break}case wt:case os:{let{name:d,path:w}=N,R=j(d,w),x=s.get(R);switch(N.layout){case te:{V(i,i+2|0),n=n+2|0;break}default:{switch(x.type){case Pe:{if(d===ue){o===as?(e.push(f,0),e.push(Ae,L),e.push(Mt,nt),e.push(rs,nt),e.push(f,4),re(),e.push(Fe,i),e.push(G,L),e.push(f,4),e.push($e),e.push(se),e.push(It,Re,je),e.push(Ke,Re,je),e.push(G,L),e.push(f,1),e.push(se),e.push(Ae,L),e.push(Be,sn),fe("merge"),e.push(G,L),e.push(Fe,i+1),e.push(ao),e.push(Bt,1),e.push(is,0),e.push(ro),e.push(ro),e.push(G,L),e.push(Fe,i+1)):(V(i,i+2|0),n=n+2|0);break}else V(i,i+1|0);break}case ft:{V(i,i+1|0),n=n+1|0;break}case de:{V(i,i+2|0),n=n+2|0;break}}break}}break}}break}case ot:{let{value:h,trail:i}=u,m=h.name||h.link||h.value,N;ae=!0;let d=pe.get(m);if(d){let{data:ne}=d,we=j(ne.name,ne.path);N=s.get(we)}else{let ne=Qe(h);N=s.get(j(ne.data?.name,ne.data?.path))}let{indivisibles:w}=N,{mapTrail:R}=w,x=JSON.parse(JSON.stringify(i)),C=R.get(i[0]),{address:J}=C,Q=[J],B=N;for(;x.length>0;){let ne=x.shift();if(x.length>0){let we=B.members.get(ne),ve=j(we.name,we.path);if(B=s.get(ve),B.indivisibles){let{indivisibles:ge}=B,{mapTrail:ce}=ge,Me=ce.get(x[0]),{address:Ce}=Me;Q.push(Ce)}continue}B=B.members.get(ne)}let ie=j(B.name,B.path),ee=s.get(ie),{link:le}=ee,{load:Oe}=le,et=xe.get(m);for(e.push(Fe,..._(et));Q.length>1;){let ne=Q.shift();e.push(f,..._(ne)),e.push(se),e.push(It,Re,je)}e.push(f,..._(Q[0])),e.push(se),B.name===ue||B.type===te||B.layout===te?(e.push(Ae,L),e.push(G,L),e.push(f,4),e.push(se),e.push(G,L)):e.push(Oe.opcode,Oe.align,Oe.offset);break}}},Ie=Y=>{let{name:u,currentIndex:S}=Y;if(S===0)e.push(Kt,xe.size+1);else if(e.push(Fe,xe.size+1),u==="==")e.push(Oi);else if(u==="!=")e.push(_i);else throw new Error(`Unknown operator ${u} for objects`)},Ne=Y=>{let{member:u}=Y,{isObject:S,index:U,address:g}=u;if(S){e.push(Fe,..._(U)),e.push(f,..._(g)),e.push(se),e.push(Fe,..._(U)),e.push(f,..._(g+4)),e.push(se);return}e.push(Fe,..._(U)),e.push(f,..._(g)),e.push(se)};for(z(t);r.length>0;){let Y=r.shift();switch(Y.type){case"call":{oe(Y);break}case"value":{ze(Y);break}case Vt:{Ne(Y);break}case"compare":{Ie(Y);break}}}return n},St=t=>{let o=(r,b)=>{for(;r<b;)b=b-1|0,e.push(Kt,b)},n=(r,b)=>{if(Ot(b,!0)){o(r,r+1|0);return}switch(b.type){case ht:{b.name===te||b.name===ue?o(r,r+2|0):o(r,r+1|0);break}case ue:{o(r,r+2|0);break}case te:{o(r,r+2|0);break}case wt:case os:{let{name:z,path:F}=b,v=j(z,F),K=s.get(v);switch(z){case ue:{o(r,r+2|0);break}case te:{o(r,r+Number(b.length)|0);break}default:{switch(K.type){case Pe:if(z===ue){o(r,r+2|0);break}case ft:{o(r,r+1|0);break}case de:{let{length:k}=K;o(r,r+2|0);break}}break}}break}}};switch(t.type){case Se:{let{name:r}=t,b=xe.get(r),z=pe.get(r),{data:F}=z;n(b,F);break}case ot:{let{value:r,trail:b}=t,{name:z}=r,F=pe.get(z),{data:v}=F,K=j(v.name,v.path),k=s.get(K),{indivisibles:oe}=k,{mapTrail:ze}=oe,Ie=b.join("."),Ne=JSON.parse(JSON.stringify(b)),Y=ze.get(Ie),{index:u}=Y,S=k;for(;Ne.length>0;){let g=Ne.shift();S=S.members.get(g)}let U=xe.get(z);S.type==te||S.type==ue?o(U+u|0,U+u+2|0):o(U+u|0,U+u+1|0);break}}},ds=(t,o)=>{let{array:n,index:r}=t;ae=!0;let b=0,z=xe.get(n.name),F=()=>{e.push(Fe,z)},v=pe.get(n.name),{data:K}=v,{name:k,path:oe,segment:ze}=K,Ie=j(k,oe),Ne=s.get(Ie);switch(Ne.type){case Pe:{F(),H(r);let{link:Y}=Ne,{store:u}=Y;e.push(f,u.size),e.push($e),e.push(se),H(o),e.push(u.opcode,u.align,u.offset),b=b+4|0;break}case de:{let Y=null,u=0;if(o.type===Se){let{name:V}=o;Y=pe.get(V),u=xe.get(V)}let S=0,U=()=>{},g=(V,me)=>{F();let{index:h}=me;e.push(Fe,u+h|0);let{link:i}=V,{store:m}=i;e.push(m.opcode,m.align,m.offset+S|0),b=b+1|0,S=S+m.size|0},I=()=>{},{indivisibles:W}=Ne,{mapTrail:Te}=W;for(let V of Te.values()){if(V.type===ht){I();continue}let{data:me}=V,{name:h,path:i}=me,m=j(h,i),N=s.get(m);switch(N.type){case Pe:{g(N,V);break}case ft:{U();break}}}break}}return b},E=(t,o)=>{let{value:n,trail:r}=t,{name:b}=n;ae=!0;let z=pe.get(b),{data:F}=z,v=j(F.name,F.path),K=s.get(v),{indivisibles:k}=K,{mapTrail:oe}=k,ze=r.join("."),Ie=JSON.parse(JSON.stringify(r)),Ne=oe.get(ze),{address:Y}=Ne,u=K;for(;Ie.length>0;){let g=Ie.shift();if(Ie.length>0){let I=u.members.get(g),W=j(I.name,I.path);u=s.get(W);continue}u=u.members.get(g)}let S=j(u.name,u.path),U=s.get(S);switch(U.type){case Pe:{let{link:g}=U,{store:I}=g,W=xe.get(b);e.push(Fe,..._(W)),e.push(f,..._(Y)),e.push(se),H(o),e.push(I.opcode,I.align,I.offset);break}}},p=(t,o)=>{let{link:n}=t;ae=!0;let r=0,{name:b,path:z,segment:F}=Qe(n),v=j(b,z),K=s.get(v);switch(K.type){case Pe:{H(n),H(o);let{link:k}=K,{store:oe}=k;e.push(oe.opcode,oe.align,oe.offset),r=r+1|0;break}case de:{let k=0,oe=(g,I,W="")=>{let Te=W?`${W}.${g.name}`:g.name,V=I.get(Te);if(V){let{data:me}=V,h=j(me.name,me.path),i=s.get(h),{store:m}=i.link;H(n),e.push(f,..._(V.address)),e.push(se),H(g.value),e.push(m.opcode,m.align,m.offset)}else if(g.value&&g.value.literal)for(let me of g.value.literal)oe(me,I,Te)};if(o.type===Se){let{name:g}=o;if(k=xe.get(g),t.link.name.startsWith(Vt)){let I=xe.get(t.link.name),{name:W,path:Te}=pe.get(g),V=j(W,Te),me=s.get(V),{indivisibles:h}=me,{mapTrail:i}=h;for(let m of i){let{data:N}=m,d=j(N.name,N.path),w=s.get(d),{load:R,store:x}=w.link;e.push(f,..._(I)),e.push(f,..._(m.address)),e.push(se),e.push(f,..._(k)),e.push(f,..._(m.address)),e.push(se),e.push(R.opcode,R.align,R.offset),e.push(x.opcode,x.align,x.offset)}return}return H(n),e.push(Fe,..._(k)),e.push(Ke,Re,je),H(n),e.push(f,..._(4)),e.push(se),e.push(Fe,..._(k+1|0)),e.push(Ke,Re,je),r=r+2|0,r}let{literal:ze,name:Ie,path:Ne}=o,Y=j(Ie,Ne),u=s.get(Y),{indivisibles:S}=u,{mapTrail:U}=S;for(let g of ze)oe(g,U)}}return r},T=(t,o)=>{let{link:n}=o,r=0,b=k=>{let oe=Array.from(k.members.values()).reduce((u,S)=>S?u+1:u,0);Ue();let{indivisibles:ze}=k,{mapTrail:Ie}=ze,Ne=(u,S)=>{let{store:U,load:g}=u.link,{address:I}=Ie.get(S);e.push(f,..._(U.size)),re(),H(n),e.push(f,..._(I)),e.push(se),e.push(g.opcode,g.align,g.offset),e.push(U.opcode,U.align,U.offset)},Y=(u,S)=>{e.push(f,..._(Gt)),re(),e.push(Ae,Ge);for(let[g,I]of u.members){if(!I)continue;let W=j(I.name,I.path),Te=s.get(W);if(Te.type===de){We(),Y(Te,`${S}.${g}`);continue}let V=`${S}.${g}`;Ne(Te,V)}e.push(G,Ge),e.push(G,Ge),e.push(f,..._(Gt)),e.push(se),e.push(Ke,Re,je);let U=Array.from(u.members.values()).reduce((g,I)=>I?g+1:g,0);e.push(G,Ge),e.push(f,..._(Si)),e.push(se),e.push(f,..._(U)),e.push(Ke,Re,je),jt()};for(let[u,S]of k.members){if(!S)continue;let U=j(S.name,S.path),g=s.get(U);if(g.type===de){Y(g,u);continue}Ne(g,u)}e.push(G,L),e.push(f,..._(oe))},{name:z,path:F}=Qe(n),v=j(z,F),K=s.get(v);switch(K.type){case Pe:case de:{if(t.type===Se)return b(K),St(t),r;break}}return r},D=(t,o,n)=>{let r=s.get(t),b=F=>{switch(F.type){case Se:{let{name:v}=F,K=xe.get(v);e.push(Fe,K);break}case tt:{let{literal:v}=F,K=r.type===Pe?v:r.evaluate(v),k=_(K);e.push(f,...k);break}}},z=()=>{switch(r.type){case ft:{e.push(en),e.push(Bt,0);break}case Pe:{e.push(en),e.push(Bt,0);break}}};switch(r.type){case ft:{b(o),b(n),z();break}case Pe:{b(o),b(n),z();break}}},P=[],X=t=>{let o={type:Xo,statement:t};P.unshift(o)};P.unshift({type:bt});let q=(t,o)=>{if(t.members)for(let[n,r]of t.members.entries()){let b=j(r?.name,r?.path),z=s.get(b);if(z&&z.type===de){let F=q(z,b,o);F&&M.push(F)}}return t.members&&t.members.has($o)?o:null},M=[];Ct.forEach(t=>{let o=j(t.data.name,t.data.path),n=s.get(o);if(n&&n.type===de){let r=q(n,o);r&&M.push(r)}});let Ee=M.map(t=>({type:Bo,expression:{type:Tt,name:$o,path:t,inputs:[]}}));for(let t of Ee)X(t);var _e=_t.length-1|0;for(let t=_e;t>=0;t=t-1|0){let o=_t[t];X(o)}let he=t=>{let{target:o,source:n}=t;if(y.optimization){if(n.type===tt&&n.path===Qo){let r=qe(o);r&&pt.set(r,{target:o,source:n})}n.type!==tt&&pt.get(o.name||"")&&pt.delete(o.name)}if(o.type===Mo){p(o,n);return}if(o.type===ai){ds(o,n);return}if(o.type===ot){E(o,n);return}if(n.type===Yt){let r=pe.get(o.name),{data:b}=r;if(b.path!=="Flogram"){let z=j(b.name,b.path);if(s.get(z).type===de){T(o,n);return}}}H(n,as),St(o)},be=t=>{let{statements:o}=t;e.push(Mt,nt),e.push(rs,nt);let n={type:bt,layout:ss};P.unshift(n),P.unshift(n),P.unshift({type:Go});var r=o.length-1|0;for(let b=r;b>=0;b=b-1|0){let z=o[b];X(z)}},Ye=t=>{let{statements:o,condition:n}=t;e.push(Mt,nt),e.push(rs,nt);let r={type:bt,layout:ss};P.unshift(r),P.unshift(r),P.unshift({type:Wo,condition:n});var b=o.length-1|0;for(let z=b;z>=0;z=z-1|0){let F=o[z];X(F)}},ke=t=>{let{statements:o,collection:n,index:r,iterator:b}=t;$(t),e.push(f,0),r?e.push(Kt,xe.get(r)):e.push(Ae,L),e.push(Mt,nt),e.push(rs,nt);let z={type:bt,layout:ss};P.unshift(z),P.unshift(z),P.unshift({type:qo,index:r});var F=o.length-1|0;for(let v=F;v>=0;v=v-1|0){let K=o[v];X(K)}P.unshift({type:Zo,collection:n,iterator:b,index:r})},ms=t=>{e.push(is,2)},gs=t=>{let{branches:o}=t;P.unshift({type:bt});for(let n=o.length-1;n>=0;n--){let r=o[n];switch(r.type){case ri:{let{statements:b}=r,z=b.length;for(let v=z-1;v>=0;v--){let K=b[v];X(K)}let F=b.find(v=>v.type===co);P.unshift({type:no,stop:F}),H(r.values[0]);break}case ii:{let{statements:b}=r,z=b.length;for(let F=z-1;F>=0;F--){let v=b[F];X(v)}P.unshift({type:Ho});break}}}},dt=t=>{let o=t,{branches:n,values:r}=o;if(n.length>0&&r.length===0)return gs(t);e.push(Mt,nt);let z={type:bt};P.unshift(z);let F=[];for(let K of r)switch(K.type){case Se:{let{name:k}=K,oe=pe.get(k),{data:ze}=oe,{name:Ie,path:Ne}=ze,Y=j(Ie,Ne);F.push(Y);break}}var v=n.length-1|0;for(let K=v;K>=0;K=K-1|0){let k=n[K],oe={type:Ko,branch:k,condition:o,commonKeys:F};P.unshift(oe)}},xs=t=>{let{expression:o}=t;var r=H(o)|0;for(let b=0;b<r;b=b+1|0)e.push(rt)},Dt=t=>{let{value:o}=t;H(o),e.push(Be,yi),fe("dealloc"),e.push(f,0),St(o)},Ft=t=>{let{values:o}=t;for(let n of o)H(n);e.push(di)},Ts=t=>{e.push(ro)},Xt=t=>{e.push(12,0)},$t=t=>{e.push(mi)},at=t=>{t.stop?(e.push(tn),e.push(yt)):(e.push(tn),e.push(nt))},ys=t=>{let{branch:o,commonKeys:n,condition:r}=t,{values:b}=o,{values:z}=r;var F=n.length|0;for(let k=0;k<F;k=k+1|0){let oe=n[k],ze=b[k],Ie=z[k];D(oe,ze,Ie)}let{statements:v}=o;var K=v.length-1|0;for(let k=K;k>=0;k=k-1|0){let oe=v[k];X(oe)}},Is=t=>{let{condition:o}=t;H(o),e.push(f,0),e.push(ao),e.push(Bt,1),e.push(is,0)},_o=t=>{let{collection:o,iterator:n,index:r}=t;H(o),ae=!0;let b=xe.get(r);r?e.push(Fe,b):e.push(G,L),e.push(ao),e.push(Bt,1),e.push(rt);let z=Object.freeze({type:ns,array:o,index:{type:Se,name:r}}),F=Object.freeze({type:Se,name:n}),v=Object.freeze({type:ni,target:F,source:z});X(v)},O=t=>{let{index:o}=t,n=xe.get(o);o?e.push(Fe,n):e.push(G,L),e.push(f,1),e.push(se),o?e.push(Kt,n):e.push(Ae,L),e.push(is,0)},A=t=>{let{statement:o}=t;switch(o.type){case"assign":{he(o);break}case no:{dt(o);break}case ss:{be(o);break}case pi:{Ye(o);break}case li:{ke(o);break}case ui:{ms(o);break}case Bo:{xs(o);break}case Ei:{Dt(o);break}case co:{Ft(o);break}}};for(;P.length>0;){let t=P.shift();switch(t.type){case bt:{Ts(t);break}case Go:{Xt(t);break}case Ho:{$t(t);break}case no:{at(t);break}case Ko:{ys(t);break}case Xo:{A(t);break}case Wo:{Is(t);break}case Zo:{_o(t);break}case qo:{O(t);break}default:break}}return{totalOctets:e,nativeImports:Z,loads:ae}}var{HEX_ENCODE:po,LEB128_ENCODE:ct}=xt,{TYPES_ASSIGN:Di,TYPES_ARRAY:Et,TYPES_DATA:us,TYPES_GENERICS:Fi,TYPES_ENUMERATION:Ht,TYPES_EXPRESSION:ki,TYPES_LINK:fs,TYPES_LOCAL:zt,TYPES_OBJECT:Nt,TYPES_PROCEDURE:lo,TYPES_RETURN:Ui,TYPES_SELECT:Li,TYPES_MEMBER:vi,TYPES_STORE:uo,TYPES_LITERAL:pn,TYPES_LINK_TO:Es,TYPES_VALUE_AT:hs,TYPES_SELF:ln,TYPES_NATIVE:Pt,TYPES_STRING:At}=Jt,fo="",Ve=(c,s)=>`${s}.${c}`,Vi=c=>[">","<",">=","<=","!=","=="].includes(c),Yi=c=>["FP64","I64","U64","FP32","I32","U32","I16","U16","I8","U8","Bool"].includes(c),Eo=48,wi=Object.freeze([0,127]),Mi=Object.freeze({}),Bi=Object.freeze([127]),un=0;var Ki=2;var Gi=10,Hi=7,Xi=3,$i=2,Ji=1,Wi=6,st=96,bs=127,ho=Object.freeze([7,105,109,112,111,114,116,115]),Zi=Object.freeze([6,109,101,109,111,114,121]),qi=0;var Qi=65,Je=new Uint8Array(8),ep=Object.freeze([0,97,115,109]),tp=Object.freeze([1,0,0,0]),sp=(c,s)=>{s=s??Mi;let a={},{data:l,code:y}=c,$=y.filter(E=>!E.description.generics||E.description.generics.length===0),e=new Map,Z=new Map,ae=E=>{let p=0;for(let T of E){let{data:D}=T;switch(D.type){case"Maybe":case us:{let{name:P,path:X}=D,q=Ve(P,X),M=e.get(q);if(M)switch(M.type){case Pt:if(P===At){p=p+2|0;break}case Ht:{p=p+1|0;break}case Nt:{let{length:Ee}=M;p=p+2|0;break}}break}case fs:{D.name===Et||D.name===At?p=p+2|0:p=p+1|0;break}case Et:{p=p+2|0;break}}}return p},fe=E=>{let{labels:p}=E,T=new Map;var D=p.length|0;for(let M=0;M<D;M=M+1|0){let{name:Ee}=p[M];T.set(Ee,M)}return Object.freeze({type:Ht,encode:M=>{let Ee=T.get(M);return typeof Ee>"u"?Bi:ct(Ee)},evaluate:M=>T.get(M),opcode:Qi,link:Object.freeze({load:Object.freeze({opcode:40,align:2,offset:0,size:4}),store:Object.freeze({opcode:54,align:2,offset:0,size:4})})})},re=E=>{let p=[],T=[],D=0,P=()=>{let O=Object.freeze({type:"back"});p.unshift(O)},X=O=>{let A={type:us,data:O};p.unshift(A)},q=O=>{let A={type:"name",name:O};p.unshift(A)},M=(O,A)=>{A&&(P(),X(A),q(O))},Ee=O=>l.find(A=>A.name===O),_e=(O,A)=>A.find(t=>t.name===O),he=(O,{inputs:A})=>A.find(t=>t.name===O),be=(O,A)=>{let t=O;for(let o of A){let n=_e(o,t.description.members),r=Ee(n.data.name);if(r&&r.type===Nt)t=r;else return n}return null},Ye=(O,A)=>{let t=O.trail,o=_e(t[0],A.members);if(!o)return null;if(t.length===1)return o.data;let n=Ee(o.data.name);return be(n,t.slice(1)).data},ke=(O,A,t,o)=>{if(he(A,t.description))return;t.description.self.push(O);let n=Object.seal({name:A,data:{...Ye({trail:O.trail||O.value?.trail||O.link?.trail||[]},o),segment:"heap"}});O.type!==Es&&(n.data.type=fs),t.description.inputs.push(n)},ms=(O,A,t)=>{let o=O.inputs.map(n=>dt(n,A,t));return{...O,inputs:o}},gs=(O,A,t)=>{if(!(O.value.link===ln||O.value.value===ln))return console.log("THIS IS NOT HANDLED; HANGING"),O;let o=`${O.type}_${O.trail.join("_")}`;if(ke(O,o,A,t),O.value.value)return{type:Es,value:o};if(O.value.link)return{type:hs,link:o}},dt=(O,A,t,o="")=>{switch(O.type){case zt:case pn:return O;case vi:{let n=`${O.type}_${O.trail.join("_")}`;return ke(O,n,A,t),o==="target"?{type:uo,link:{type:zt,name:n}}:{type:hs,link:{type:zt,name:n}}}case Es:{if(O.value.type===pn)return O.value;{let n=`${O.value.type}_${O.value.trail.join("_")}`;return ke(O,n,A,t),{type:Es,value:{type:zt,name:n}}}}case hs:{let n=`${O.link.type}_${O.link.trail.join("_")}`;return ke(O,n,A,t),{type:hs,link:{type:zt,name:n}}}case uo:{let n=`${O.link.type}_${O.link.trail.join("_")}`;return ke(O,n,A,t),{type:uo,link:{type:zt,name:n}}}case Li:return gs(O,A,t);case ki:return ms(O,A,t);default:return console.log("THIS IS NOT HANDLED; HANGING"),console.log(O),O}},xs=(O,A)=>{let t=JSON.parse(JSON.stringify(O));t.description.self=[];for(let o of t.description.statements)o.type===Di?(o.target=dt(o.target,t,A,"target"),o.source=dt(o.source,t,A)):o.type===Ui&&(o.values=o.values.map(n=>dt(n,t,A)));$.push(t)},{members:Dt}=E,Ft=new Map;for(let O of Dt){let{name:A,data:t,value:o}=O;Ft.set(A,t),o&&Ft.set(A,{...t,value:o})}var Ts=Dt.length-1|0;for(let O=Ts;O>=0;O=O-1|0){let A=Dt[O],{name:t,data:o}=A;if(A.type&&A.type===lo){xs(A,E);continue}M(t,o)}let Xt=new Map,$t=new Map,at=0;for(;p.length>0;){let O=p.shift();switch(O.type){case"back":{T.pop();break}case us:{let{data:A}=O,t=()=>{let z=T.join("."),F=Ve(A.name,A.path),v=e.get(F),{link:K}=v,k=Object.freeze({data:A,index:at,address:D,trail:z});A.type===Et||A.layout===Et||A.name===At?D+=8:D+=K?.load.size||8,Xt.set(z,k),$t.set(at,k),A.type===Et||A.name===At||A.layout===Et?at=at+2|0:at=at+1|0};if(A.type===fs){t();break}let{name:o,path:n}=A,r=Ve(o,n);switch(e.get(r).type){case Pt:case Ht:{t();break}case Nt:{t();break}}break}case"name":{let{name:A}=O;T.push(A);break}}}let ys=at|0,Is=Object.freeze({mapTrail:Xt,mapIndex:$t});return{type:Nt,length:ys,members:Ft,indivisibles:Is}},ye={};for(let E of l){let{path:p}=E;switch(E.type){case Pt:{let{name:T,path:D}=E,P=Ve(T,D);if(Object.hasOwn(ut,P)){let X=ut[P];e.set(P,X);continue}break}case"import":{if(Object.hasOwn(ut,p)){let T=ut[p];e.set(p,T);continue}break}case Fi:{let{name:T,path:D}=E,P=Ve(T,D),X=ut["Flogram.FP32"];e.set(P,X);break}case Ht:{let{name:T,path:D,description:P}=E,X=Ve(T,D),q=fe(P);e.set(X,q);break}case Nt:{let{name:T,path:D,description:P}=E,{generics:X}=P,q=Ve(T,D);if(!X||X.length===0){let M=re(P);e.set(q,M)}break}}}a.structures=ye;let Ue=0,We=(E,p)=>{let T=Z.get(E);if(typeof T>"u"){Z.set(E,[p]);return}(T.length==0||T.length>0&&T[0].body!==p.body)&&Z.set(E,[p,...T])},jt=E=>{let{name:p,path:T}=E,D=Ve(p,T);switch(T==="Flogram"&&(Yi(p)?D=Ve(E.description.inputs[0]?.data?.name?.toLowerCase()+"."+He(p),T):E.description.outputs&&E.description.outputs.length>=1&&!Vi(E.name)?E.description.outputs[0]?.data?.name&&(D=Ve(E.description.outputs[0]?.data?.name?.toLowerCase()+"."+He(p,E.description.inputs?.length),T)):(vt.includes(E.description.inputs[1]?.data?.name?.toUpperCase())&&(D=Ve(E.description.inputs[1]?.data?.name?.toUpperCase()+"."+He(p),T),fo=E.description.inputs[1]?.data?.name?.toUpperCase()),fo&&(D=Ve(fo.toLowerCase()+"."+He(p),T)))),E.type){case Pt:{if(Object.hasOwn(Lt,D)){let P=Lt[D];We(D,P);return}break}case lo:{let{description:P}=E,{inputs:X,outputs:q}=P,M=Ve(p,T),Ee={type:"artificial",index:"artificial"+Ue,procedure:E,lengths:Object.freeze({inputs:ae(X),outputs:ae(q)})};We(M,Ee);break}}Ue=Ue+1|0},Rt=[],De=[];for(let E of $){if(E.description.generics?.length>0)continue;let{description:p}=E,{inputs:T,outputs:D}=p,P=[...T,...D];if(!(E.type===Pt&&P.some(X=>!vt.includes(X.data.name))))switch(jt(E),E.type){case"import":{let{path:X}=E;if(Object.hasOwn(Lt,X))continue;Rt.push(E);break}case lo:{De.push(E);break}}}let Ot=E=>{let p=0,T=[];for(let D of E){let P=()=>{T.push(bs),p=p+1|0},X=he=>{let{identity:be}=he;T.push(be),p=p+1|0},q=()=>{T.push(bs),p=p+1|0},M=()=>{T.push(bs),p=p+1|0,T.push(bs),p=p+1|0},{name:Ee,data:_e}=D;switch(_e.type){case"Maybe":case us:{let{name:he,path:be}=_e,Ye=Ve(he,be),ke=e.get(Ye);if(!ke)X(ut["Flogram.FP32"]);else switch(ke.type){case Pt:{he===At?M():X(ke);break}case Ht:{P();break}case Nt:{M();break}}break}case fs:{_e.name===Et||_e.name===At?M():q();break}case Et:{M();break}}}return[p,T]},it=(E,p)=>{let T=p.length|0,D=ct(T);p.unshift(E,...D)},Os=E=>{let p=[],T=[...Rt,...De],D=new Map([["alloc",[st,1,127,1,127]],["dealloc",[st,1,127,0]],["merge",[st,0,0]],["save",[st,2,127,127,0]],["undo",[st,0,2,127,127]],["undoPenultimate",[st,0,2,127,127]],["draw",[st,1,127,0]],["drawI64",[st,1,126,0]],["drawFP32",[st,1,125,0]],["drawFP64",[st,1,124,0]]]);for(let q of E)if(D.has(q))p.push(...D.get(q));else throw new Error("Procedure not found:",q);for(let q of T){let{description:M}=q,{inputs:Ee,outputs:_e}=M,[he,be]=Ot(Ee),[Ye,ke]=Ot(_e);p.push(st,he,...be,Ye,...ke)}let P=T.length|0,X=ct(P+E.size);return p.unshift(...X),it(Ji,p),p},Ct=E=>{let p=[];return E&&E.size>0&&(p.push(2),p.push(127,1),p.push(65,0,11),p.push(127,1),p.push(65,0,11),it(Wi,p)),p},_t=0,xe=(E,p)=>{let T=[],D=0,P={};if(s.memory){let M=he=>{let be=[...he].map(Ye=>Ye.charCodeAt(0));return[be.length,...be]},Ee=[];(p||E.size>0)&&(P.memory={path:"memory",description:{inputs:[],outputs:[]}});for(let he of E)Ee.push(M(he)),P[he]={path:he,description:{inputs:[],outputs:[]}};let _e=Array.from(E);for(let he of E)Je.fill(Eo),po(D,Je),T.push(...ho,...Ee[_e.indexOf(he)],un,_e.indexOf(he)),D=D+1|0}for(let M of Rt){Je.fill(Eo),po(D,Je);let Ee=String.fromCodePoint(...Je);P[Ee]={path:M.path,description:M.description};let _e=D|0;T.push(...ho,Je.length|0,...Je,un,_e),D=D+1|0}_t=D|0,(p||E.size>0)&&(T.push(...ho,...Zi,Ki,...wi),D=D+1|0);let X=D|0,q=ct(X);return T.unshift(...q),it($i,T),a.imports=P,T},pe=()=>{let E=[];var p=De.length|0;for(let P=0;P<p;P=P+1|0){let X=P|0,q=_t+X|0,M=ct(q);E.push(...M)}let T=De.length|0,D=ct(T);return E.unshift(...D),it(Xi,E),E},pt=()=>{let E=[],p=0,T={};var D=De.length|0;for(let q=0;q<D;q=q+1|0){let M=q+_t|0,Ee=ct(M);Je.fill(Eo),po(p,Je);let{name:_e,path:he,description:be}=De[q];be={inputs:be.inputs,outputs:be.outputs};let Ye=String.fromCodePoint(...Je);T[Ye]={name:_e,path:he,description:be},E.push(Je.length|0,...Je,qi,...Ee),p=p+1|0}let P=p|0,X=ct(P);return E.unshift(...X),it(Hi,E),a.procedures=T,E},bo=()=>{let E=[],p=new Set,T=!1;for(let q of De){let{totalOctets:M,nativeImports:Ee,loads:_e}=ls(q,e,Z,$,s);p=new Set([...p,...Ee]),_e&&!T&&(T=_e);let he=M.length|0,be=ct(he);E.push(...be,...M)}let D=De.length|0,P=ct(D);return E.unshift(...P),it(Gi,E),E=((q,M,Ee)=>{let _e=Array.from(Ee),he="artificial";return q.map(be=>{if(typeof be=="string"){if(be.startsWith(he)){let Ye=be.slice(he.length),ke=parseInt(Ye,10);if(!isNaN(ke))return ke+M}if(_e.includes(be))return _e.indexOf(be)}return be})})(E,p.size,p),{totalOctets:E,allImports:p,loads:T}},{totalOctets:Le,allImports:Ze,loads:Oo}=bo(),_s=Os(Ze),qe=xe(Ze,Oo),Qe=pe(),H=Ct(Ze),St=pt(),ds=new Uint8Array([...ep,...tp,..._s,...qe,...Qe,...H,...St,...Le]);return[a,ds]},op=Object.freeze({compile:sp}),Vp=op;export{Vp as default};
