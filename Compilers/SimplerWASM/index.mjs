var no="as",oo="=",co="break",ao="else",ro="enum",io="export",po="if",lo="import",uo="->",fo="is",Eo="loop",ho="mut",bo="native",Oo="object",_o="fn",mo="return",go="self",xo="template",To=Object.freeze({ALIAS:no,ASSIGN:oo,BREAK:co,ELSE:ao,ENUMERATION:ro,EXPORT:io,IF:po,IMPORT:lo,INTO:uo,IS:fo,LOOP:Eo,MUTABLE:ho,NATIVE:bo,OBJECT:Oo,PROCEDURE:_o,RETURN:mo,SELF:go,TEMPLATE:xo}),En=To;var yo="assign",Io="array_assignment",zo="branch-match",No="branch-default",jo="condition",Po="loop",Ao="data",Ro="generics",Co="enumeration",So="expression",Do="instance",Fo="Link",ko="local",Uo="object",Lo="procedure",vo="return",Vo="select",Yo="member",wo="store",Mo="break",Bo="literal",Ko="array_access",Go="valueLink",Ho="linkValue",Xo="self",$o="procedure-call",Jo="Maybe",Wo="native",Zo="move",qo="String",Qo="Array",ec="import",tc="library",sc="constructor",nc="destructor",oc="free",cc="block-end",ac="default-block",rc="continue",ic="branch",pc="statement",lc="draw",uc="size",fc="concatenation",Ec="foreach",hc="while",bc="while-condition",Oc="foreach-condition",_c="foreach-end",dc="I32",mc=Object.freeze({TYPES_ASSIGN:yo,TYPES_ARRAY:Qo,TYPES_ARRAY_ASSIGNMENT:Io,TYPES_BRANCH_MATCH:zo,TYPES_BRANCH_DEFAULT:No,TYPES_CONDITION:jo,TYPES_LOOP:Po,TYPES_FOREACH_END:_c,TYPES_WHILE_CONDITION:bc,TYPES_FOREACH_CONDITION:Oc,TYPES_DATA:Ao,TYPES_GENERICS:Ro,TYPES_ENUMERATION:Co,TYPES_EXPRESSION:So,TYPES_INSTANCE:Do,TYPES_LINK:Fo,TYPES_IMPORT:ec,TYPES_LOCAL:ko,TYPES_OBJECT:Uo,TYPES_PROCEDURE:Lo,TYPES_RETURN:vo,TYPES_SELECT:Vo,TYPES_MEMBER:Yo,TYPES_STORE:wo,TYPES_BREAK:Mo,TYPES_LITERAL:Bo,TYPES_ARRAY_ACCESS:Ko,TYPES_LINK_TO:Go,TYPES_VALUE_AT:Ho,TYPES_SELF:Xo,TYPES_LIBRARY:tc,TYPES_DROP:$o,TYPES_MAYBE:Jo,TYPES_NATIVE:Wo,TYPES_MOVE:Zo,TYPES_STRING:qo,TYPES_CONSTRUCTOR:sc,TYPES_FREE:oc,TYPES_DEFAULT_BLOCK:ac,TYPES_BLOCK_END:cc,TYPES_CONTINUE:rc,TYPES_BRANCH:ic,TYPES_STATEMENT:pc,TYPES_DESTRUCTOR:nc,TYPES_DRAW:lc,TYPES_SIZE:uc,TYPES_CONCAT:fc,TYPES_FOREACH:Ec,TYPES_WHILE:hc,TYPES_I32:dc}),xs=mc;var gc=Object.freeze({COLON:58,COMMA:44,DIGIT_ZERO:48,DIGIT_NINE:57,DOT:46,HASHTAG:35,HORIZONTAL_TAB:9,HYPHEN_MINUS:45,LEFT_CURLY_BRACKET:123,LEFT_PARENTHESIS:40,LEFT_SQUARE_BRACKET:91,LINE_BREAK:10,NULL:0,PLUS_SIGN:43,RIGHT_CURLY_BRACKET:125,RIGHT_PARENTHESIS:41,RIGHT_SQUARE_BRACKET:93,SEMICOLON:59,SPACE:32}),hn=gc;var xc=Object.freeze([]),Tc=Object.freeze({}),yc="",Ic="	",zc=`
`,Nc="UTF-8",Gt=xs,jc=Object.freeze({EMPTY_ARRAY:xc,EMPTY_OBJECT:Tc,EMPTY_STRING:yc,HORIZONTAL_TAB:Ic,LINE_BREAK:zc,UNICODE_TEXT:Nc,Codes:hn,Keys:En,Types:xs}),bn=jc;var{EMPTY_STRING:Pc,UNICODE_TEXT:zs}=bn,Ac=44,Rc=48,Cc=57,Sc=46,Dc=45,Fc=43,kc=65,Uc=90,Lc=-1,vc=1,Vc=new TextDecoder(zs),Yc=new TextEncoder,wc=(o,s,a=0,E=o.length|0,z=0,e=s.length|0)=>{for(z=z|0,a=a|0,e=e|0,E=E|0;;){let B=a>=E,Y=z>=e;if(B||Y)break;let oe=o[a],fe=s[z];if(a=a+1|0,z=z+1|0,oe<fe)return Lc;if(oe>fe)return vc}return 0},Mc=(o,s,a=0,E=o.length|0,z=0,e=s.length|0)=>{for(z=z|0,a=a|0,e=e|0,E=E|0;;){let B=z>=e,Y=a>=E;if(B||Y)break;s[z]=o[a],z=z+1|0,a=a+1|0}},Bc=(o,s,a=0,E=o.length|0,z=0,e=s.length|0)=>{a=a|0,z=z|0,E=E|0,e=e|0;let B=E-a|0,Y=e-z|0;if(B!==Y)return!1;for(;;){let ie=a>=E,oe=z>=e;if(ie||oe)break;let De=o[a],Re=s[z];if(a=a+1|0,z=z+1|0,De!==Re)return!1}return!0},Kc=o=>{o=o>>>0;let s=0,a=0;for(;a=(a<<1|1)>>>0,!(a>o);)s=s+1|0;return s},dn=Object.freeze([48,49,50,51,52,53,54,55,56,57,97,98,99,100,101,102]),Is=(o,s,a,E)=>{for(o=o>>>0,E=E??s.length|0,a=a|0,E=E|0;o>0&&E>a;)E=E-1|0,s[E]=dn[o&15],o=o>>>4},Gc=(o,s,a,E)=>{let z=a|0,e=a+E|0;if(E===0)return!1;let B=s[z];for((B===Fc||B===Dc)&&(z=z+1|0);z<e;){let Y=s[z];if(z=z+1|0,!(Rc<=Y&&Y<=Cc||(Sc===Y||Ac===Y)))return!1}return!0},Hc=o=>{let s=o>=kc,a=o<=Uc;return s&&a},Xt=128,$t=127,mn=-1,Ot=64,Ns=o=>{o=o|0;let s=[];for(;;){let a=o&$t;o=o>>7;let E=o===0,z=(a&Ot)===0,e=E&&z,B=o===-1,Y=(a&Ot)!==0;if(e||B&&Y){s.push(a);break}a=a|Xt,s.push(a)}return s},Xc=o=>{let s=[],a=!0;for(;a;){let E=o&$t;o>>=7,o===0&&!(E&Ot)||o===-1&&E&Ot?a=!1:E|=Xt,s.push(E)}return s},gn=(o,s)=>{s=s|0;let a=0,E=0;for(;;){let z=o[s]|0;s=s+1|0;let e=(z&$t)<<E;if(E=E+7|0,a=a|e,(z&Xt)===0){let Y=(z&Ot)!==0,ie=E<32;if(Y&&ie){let fe=mn<<E;a=a|fe}break}}return a},$c=(o,s)=>{s=s|0;let a=0,E=0;for(;;){let z=o[s]|0;s=s+1|0;let e=(z&$t)<<E;if(E=E+7|0,a=a|e,!(z&Xt)){if(z&Ot){let B=mn<<E;a=a|B}break}}return a},Jc=o=>Vc.decode(o),Wc=o=>Yc.encode(o),Zc=(o=Pc)=>{let s=o.length|0,a=Ns(s),E=Buffer.from(o,zs);return Object.freeze([...a,...E])},qc=(o,s)=>{s=s|0;let a=gn(o,s),E=Ns(a).length;return s=s+E|0,o.subarray(s,s+a|0).toString(zs)},Qc=58,ea=46,Rt=32,Ts=48,ta=67,rt=new Uint8Array(ta),On=rt.subarray(0,8),Ht=rt.subarray(10,49),_n=rt.subarray(51,68),ys=16,sa=2;rt[8]=Qc;rt[9]=Rt;rt[49]=Rt;rt[50]=Rt;var na=(o,s)=>{s=s??console.log;let a=32,E=126,z=o.length|0,e=0;for(;z>0;){On.fill(Ts),Is(e,On),Ht.fill(Rt),_n.fill(Rt);let B=z>=ys?ys:z;z=z-ys|0;let Y=0,ie=0;for(let fe=1;fe<=B;fe=fe+1|0){let De=o[e]&255;Ht[Y+0|0]=Ts,Ht[Y+1|0]=Ts,Is(De,Ht,Y,Y+2|0);let Re=ea;a<=De&&De<=E&&(Re=De),_n[ie]=Re,e=e+1|0,Y=Y+2|0,ie=ie+1|0,fe%sa===0&&(Y=Y+1|0)}let oe=String.fromCodePoint(...rt);s(oe)}},oa=function*(o,s){let a=o.length|0,E=s.length|0,z=0;for(;z<a&&z<E;){let e=o[z],B=s[z];yield[e,B],z=z+1|0}},ca=function*(o,s,a){let E=o.length|0,z=s.length|0,e=a.length|0,B=0;for(;B<E&&B<z&&B<e;){let Y=o[B],ie=s[B],oe=a[B];yield[Y,ie,oe],B=B+1|0}},aa=Object.freeze({ARRAY_COMPARE:wc,ARRAY_COPY:Mc,ARRAY_EQUAL:Bc,BIT_DEPTH:Kc,HEX_DIGITS:dn,HEX_ENCODE:Is,IS_NUMBER:Gc,IS_UPPERCASE:Hc,LEB128_DECODE:gn,LEB128_DECODE_SIGNED:$c,LEB128_ENCODE:Ns,LEB128_ENCODE_SIGNED:Xc,UTF8_DECODE:Jc,UTF8_ENCODE:Wc,WASM_STRING_ENCODE:Zc,WASM_STRING_DECODE:qc,XXD_DUMP_HEX:na,ZIP2:oa,ZIP3:ca}),_t=aa;var Ke=(o,s=2)=>{let a="";switch(o){case"+":a="add";break;case"-":a=s===2?"sub":"neg";break;case"*":a="mul";break;case"/":a="div";break;case"%":a="rem";break;case"==":a="eq";break;case">":a="gt";break;case"<":a="lt";break;case">=":a="ge";break;case"<=":a="le";break;case"!=":a="ne";break;case"&":a="and";break;case"|":a="or";break;case"^":a="xor";break;case"not":a="not";break;case"I32":a="toi32";break;case"U32":a="tou32";break;case"I64":a="toi64";break;case"U64":a="tou64";break;case"FP64":a="tofp64";break;case"FP32":a="tofp32";break}return a};var ra=Object.freeze({type:"native",body:Object.freeze([160]),lengths:Object.freeze({inputs:2,outputs:1})}),ia=Object.freeze({type:"native",body:Object.freeze([163]),lengths:Object.freeze({inputs:2,outputs:1})}),pa=Object.freeze({type:"native",body:Object.freeze([162]),lengths:Object.freeze({inputs:2,outputs:1})}),la=Object.freeze({type:"native",body:Object.freeze([68,0,0,0,0,0,0,240,191,162]),lengths:Object.freeze({inputs:1,outputs:1})}),ua=Object.freeze({type:"native",body:Object.freeze([161]),lengths:Object.freeze({inputs:2,outputs:1})}),fa=Object.freeze({type:"native",body:Object.freeze([124]),lengths:Object.freeze({inputs:2,outputs:1})}),Ea=Object.freeze({type:"native",body:Object.freeze([128]),lengths:Object.freeze({inputs:2,outputs:1})}),ha=Object.freeze({type:"native",body:Object.freeze([126]),lengths:Object.freeze({inputs:2,outputs:1})}),ba=Object.freeze({type:"native",body:Object.freeze([66,255,255,255,255,255,255,255,255,126]),lengths:Object.freeze({inputs:1,outputs:1})}),Oa=Object.freeze({type:"native",body:Object.freeze([125]),lengths:Object.freeze({inputs:2,outputs:1})}),_a=Object.freeze({type:"native",body:Object.freeze([124]),lengths:Object.freeze({inputs:2,outputs:1})}),da=Object.freeze({type:"native",body:Object.freeze([127]),lengths:Object.freeze({inputs:2,outputs:1})}),ma=Object.freeze({type:"native",body:Object.freeze([126]),lengths:Object.freeze({inputs:2,outputs:1})}),Zi=Object.freeze({type:"native",body:Object.freeze([66,255,255,255,255,255,255,255,255,126]),lengths:Object.freeze({inputs:2,outputs:1})}),ga=Object.freeze({type:"native",body:Object.freeze([125]),lengths:Object.freeze({inputs:2,outputs:1})}),xn=Object.freeze({type:"native",body:Object.freeze([146]),lengths:Object.freeze({inputs:2,outputs:1})}),Tn=Object.freeze({type:"native",body:Object.freeze([149]),lengths:Object.freeze({inputs:2,outputs:1})}),yn=Object.freeze({type:"native",body:Object.freeze([148]),lengths:Object.freeze({inputs:2,outputs:1})}),xa=Object.freeze({type:"native",body:Object.freeze([67,0,0,128,191,148]),lengths:Object.freeze({inputs:2,outputs:1})}),In=Object.freeze({type:"native",body:Object.freeze([140]),lengths:Object.freeze({inputs:2,outputs:1})}),js=Object.freeze({type:"native",body:Object.freeze([106]),lengths:Object.freeze({inputs:2,outputs:1})}),Ps=Object.freeze({type:"native",body:Object.freeze([110]),lengths:Object.freeze({inputs:2,outputs:1})}),As=Object.freeze({type:"native",body:Object.freeze([108]),lengths:Object.freeze({inputs:2,outputs:1})}),Rs=Object.freeze({type:"native",body:Object.freeze([107]),lengths:Object.freeze({inputs:2,outputs:1})}),Cs=Object.freeze({type:"native",body:Object.freeze([106]),lengths:Object.freeze({inputs:2,outputs:1})}),Ss=Object.freeze({type:"native",body:Object.freeze([109]),lengths:Object.freeze({inputs:2,outputs:1})}),Ds=Object.freeze({type:"native",body:Object.freeze([108]),lengths:Object.freeze({inputs:2,outputs:1})}),Fs=Object.freeze({type:"native",body:Object.freeze([65,1,0,0,0,108]),lengths:Object.freeze({inputs:1,outputs:1})}),ks=Object.freeze({type:"native",body:Object.freeze([107]),lengths:Object.freeze({inputs:2,outputs:1})}),Ta=Object.freeze({type:"native",body:Object.freeze([130]),lengths:Object.freeze({inputs:2,outputs:1})}),ya=Object.freeze({type:"native",body:Object.freeze([129]),lengths:Object.freeze({inputs:2,outputs:1})}),Us=Object.freeze({type:"native",body:Object.freeze([112]),lengths:Object.freeze({inputs:2,outputs:1})}),Ls=Object.freeze({type:"native",body:Object.freeze([111]),lengths:Object.freeze({inputs:2,outputs:1})}),Ia=Object.freeze({type:"native",body:Object.freeze([86]),lengths:Object.freeze({inputs:2,outputs:1})}),za=Object.freeze({type:"native",body:Object.freeze([85]),lengths:Object.freeze({inputs:2,outputs:1})}),Na=Object.freeze({type:"native",body:Object.freeze([100]),lengths:Object.freeze({inputs:2,outputs:1})}),vs=Object.freeze({type:"native",body:Object.freeze([75]),lengths:Object.freeze({inputs:2,outputs:1})}),Vs=Object.freeze({type:"native",body:Object.freeze([74]),lengths:Object.freeze({inputs:2,outputs:1})}),ja=Object.freeze({type:"native",body:Object.freeze([94]),lengths:Object.freeze({inputs:2,outputs:1})}),Pa=Object.freeze({type:"native",body:Object.freeze([84]),lengths:Object.freeze({inputs:2,outputs:1})}),Aa=Object.freeze({type:"native",body:Object.freeze([83]),lengths:Object.freeze({inputs:2,outputs:1})}),Ra=Object.freeze({type:"native",body:Object.freeze([99]),lengths:Object.freeze({inputs:2,outputs:1})}),Ys=Object.freeze({type:"native",body:Object.freeze([73]),lengths:Object.freeze({inputs:2,outputs:1})}),ws=Object.freeze({type:"native",body:Object.freeze([72]),lengths:Object.freeze({inputs:2,outputs:1})}),Ca=Object.freeze({type:"native",body:Object.freeze([93]),lengths:Object.freeze({inputs:2,outputs:1})}),Sa=Object.freeze({type:"native",body:Object.freeze([87]),lengths:Object.freeze({inputs:2,outputs:1})}),Da=Object.freeze({type:"native",body:Object.freeze([88]),lengths:Object.freeze({inputs:2,outputs:1})}),Fa=Object.freeze({type:"native",body:Object.freeze([101]),lengths:Object.freeze({inputs:2,outputs:1})}),Ms=Object.freeze({type:"native",body:Object.freeze([76]),lengths:Object.freeze({inputs:2,outputs:1})}),Bs=Object.freeze({type:"native",body:Object.freeze([77]),lengths:Object.freeze({inputs:2,outputs:1})}),ka=Object.freeze({type:"native",body:Object.freeze([95]),lengths:Object.freeze({inputs:2,outputs:1})}),Ua=Object.freeze({type:"native",body:Object.freeze([89]),lengths:Object.freeze({inputs:2,outputs:1})}),La=Object.freeze({type:"native",body:Object.freeze([90]),lengths:Object.freeze({inputs:2,outputs:1})}),va=Object.freeze({type:"native",body:Object.freeze([102]),lengths:Object.freeze({inputs:2,outputs:1})}),Ks=Object.freeze({type:"native",body:Object.freeze([78]),lengths:Object.freeze({inputs:2,outputs:1})}),Gs=Object.freeze({type:"native",body:Object.freeze([79]),lengths:Object.freeze({inputs:2,outputs:1})}),Va=Object.freeze({type:"native",body:Object.freeze([96]),lengths:Object.freeze({inputs:2,outputs:1})}),Ya=Object.freeze({type:"native",body:Object.freeze([81]),lengths:Object.freeze({inputs:2,outputs:1})}),wa=Object.freeze({type:"native",body:Object.freeze([81]),lengths:Object.freeze({inputs:2,outputs:1})}),Ma=Object.freeze({type:"native",body:Object.freeze([97]),lengths:Object.freeze({inputs:2,outputs:1})}),Hs=Object.freeze({type:"native",body:Object.freeze([70]),lengths:Object.freeze({inputs:2,outputs:1})}),Xs=Object.freeze({type:"native",body:Object.freeze([70]),lengths:Object.freeze({inputs:2,outputs:1})}),Ba=Object.freeze({type:"native",body:Object.freeze([91]),lengths:Object.freeze({inputs:2,outputs:1})}),Ka=Object.freeze({type:"native",body:Object.freeze([82]),lengths:Object.freeze({inputs:2,outputs:1})}),Ga=Object.freeze({type:"native",body:Object.freeze([82]),lengths:Object.freeze({inputs:2,outputs:1})}),Ha=Object.freeze({type:"native",body:Object.freeze([98]),lengths:Object.freeze({inputs:2,outputs:1})}),$s=Object.freeze({type:"native",body:Object.freeze([71]),lengths:Object.freeze({inputs:2,outputs:1})}),Js=Object.freeze({type:"native",body:Object.freeze([71]),lengths:Object.freeze({inputs:2,outputs:1})}),Xa=Object.freeze({type:"native",body:Object.freeze([92]),lengths:Object.freeze({inputs:2,outputs:1})}),$a=Object.freeze({type:"native",body:Object.freeze([113]),lengths:Object.freeze({inputs:2,outputs:1})}),Ja=Object.freeze({type:"native",body:Object.freeze([114]),lengths:Object.freeze({inputs:2,outputs:1})}),Wa=Object.freeze({type:"native",body:Object.freeze([115]),lengths:Object.freeze({inputs:2,outputs:1})}),Za=Object.freeze({type:"native",body:Object.freeze([69]),lengths:Object.freeze({inputs:1,outputs:1})}),zn=Object.freeze({type:"native",body:Object.freeze([167]),lengths:Object.freeze({inputs:1,outputs:1})}),Nn=Object.freeze({type:"native",body:Object.freeze([167]),lengths:Object.freeze({inputs:1,outputs:1})}),qa=Object.freeze({type:"native",body:Object.freeze([170]),lengths:Object.freeze({inputs:1,outputs:1})}),Qa=Object.freeze({type:"native",body:Object.freeze([171]),lengths:Object.freeze({inputs:1,outputs:1})}),er=Object.freeze({type:"native",body:Object.freeze([168]),lengths:Object.freeze({inputs:1,outputs:1})}),tr=Object.freeze({type:"native",body:Object.freeze([169]),lengths:Object.freeze({inputs:1,outputs:1})}),jn=Object.freeze({type:"native",body:Object.freeze([]),lengths:Object.freeze({inputs:1,outputs:1})}),Jt=Object.freeze({type:"native",body:Object.freeze([193]),lengths:Object.freeze({inputs:1,outputs:1})}),Wt=Object.freeze({type:"native",body:Object.freeze([192]),lengths:Object.freeze({inputs:1,outputs:1})}),sr=Object.freeze({type:"native",body:Object.freeze([]),lengths:Object.freeze({inputs:1,outputs:1})}),nr=Object.freeze({type:"native",body:Object.freeze([]),lengths:Object.freeze({inputs:1,outputs:1})}),or=Object.freeze({type:"native",body:Object.freeze([176]),lengths:Object.freeze({inputs:1,outputs:1})}),cr=Object.freeze({type:"native",body:Object.freeze([177]),lengths:Object.freeze({inputs:1,outputs:1})}),ar=Object.freeze({type:"native",body:Object.freeze([175]),lengths:Object.freeze({inputs:1,outputs:1})}),rr=Object.freeze({type:"native",body:Object.freeze([174]),lengths:Object.freeze({inputs:1,outputs:1})}),ir=Object.freeze({type:"native",body:Object.freeze([196]),lengths:Object.freeze({inputs:1,outputs:1})}),pr=Object.freeze({type:"native",body:Object.freeze([196]),lengths:Object.freeze({inputs:1,outputs:1})}),lr=Object.freeze({type:"native",body:Object.freeze([196]),lengths:Object.freeze({inputs:1,outputs:1})}),ur=Object.freeze({type:"native",body:Object.freeze([196]),lengths:Object.freeze({inputs:1,outputs:1})}),Pn=Object.freeze({type:"native",body:Object.freeze([195]),lengths:Object.freeze({inputs:1,outputs:1})}),An=Object.freeze({type:"native",body:Object.freeze([195]),lengths:Object.freeze({inputs:1,outputs:1})}),Rn=Object.freeze({type:"native",body:Object.freeze([194]),lengths:Object.freeze({inputs:1,outputs:1})}),Cn=Object.freeze({type:"native",body:Object.freeze([194]),lengths:Object.freeze({inputs:1,outputs:1})}),fr=Object.freeze({type:"native",body:Object.freeze([185]),lengths:Object.freeze({inputs:1,outputs:1})}),Er=Object.freeze({type:"native",body:Object.freeze([186]),lengths:Object.freeze({inputs:1,outputs:1})}),Ws=Object.freeze({type:"native",body:Object.freeze([183]),lengths:Object.freeze({inputs:1,outputs:1})}),Zs=Object.freeze({type:"native",body:Object.freeze([184]),lengths:Object.freeze({inputs:1,outputs:1})}),hr=Object.freeze({type:"native",body:Object.freeze([187]),lengths:Object.freeze({inputs:1,outputs:1})}),br=Object.freeze({type:"native",body:Object.freeze([180]),lengths:Object.freeze({inputs:1,outputs:1})}),Or=Object.freeze({type:"native",body:Object.freeze([181]),lengths:Object.freeze({inputs:1,outputs:1})}),qs=Object.freeze({type:"native",body:Object.freeze([178]),lengths:Object.freeze({inputs:1,outputs:1})}),Qs=Object.freeze({type:"native",body:Object.freeze([179]),lengths:Object.freeze({inputs:1,outputs:1})}),_r=Object.freeze({type:"native",body:Object.freeze([182]),lengths:Object.freeze({inputs:1,outputs:1})}),Ct=Object.freeze(Object.assign({"Flogram./":Tn,"Flogram.*":yn,"Flogram.+":xn,"Flogram.-":In},{"Flogram.fp64.div":ia,"Flogram.fp64.mul":pa,"Flogram.fp64.add":ra,"Flogram.fp64.sub":ua,"Flogram.fp64.neg":la,"Flogram.fp64.gt":Na,"Flogram.fp64.lt":Ra,"Flogram.fp64.le":Fa,"Flogram.fp64.ge":va,"Flogram.fp64.ne":Ha,"Flogram.fp64.eq":Ma,"Flogram.fp64.toi32":qa,"Flogram.fp64.tou32":Qa,"Flogram.fp64.tou64":cr,"Flogram.fp64.toi64":or,"Flogram.fp64.tofp32":_r},{"Flogram.u64.add":fa,"Flogram.u64.sub":Oa,"Flogram.u64.mul":ha,"Flogram.u64.div":Ea,"Flogram.u64.rem":Ta,"Flogram.u64.gt":Ia,"Flogram.u64.lt":Pa,"Flogram.u64.le":Da,"Flogram.u64.ge":La,"Flogram.u64.ne":Ga,"Flogram.u64.eq":wa,"Flogram.u64.toi32":Nn,"Flogram.u64.tou32":Nn,"Flogram.u64.toi64":sr,"Flogram.u64.tofp32":Or,"Flogram.u64.tofp64":Er},{"Flogram.i64.add":_a,"Flogram.i64.sub":ga,"Flogram.i64.neg":ba,"Flogram.i64.mul":ma,"Flogram.i64.div":da,"Flogram.i64.rem":ya,"Flogram.i64.gt":za,"Flogram.i64.lt":Aa,"Flogram.i64.le":Sa,"Flogram.i64.ge":Ua,"Flogram.i64.ne":Ka,"Flogram.i64.eq":Ya,"Flogram.i64.toi32":zn,"Flogram.i64.tou32":zn,"Flogram.i64.tou64":nr,"Flogram.i64.tofp32":br,"Flogram.i64.tofp64":fr},{"Flogram.fp32.div":Tn,"Flogram.fp32.mul":yn,"Flogram.fp32.add":xn,"Flogram.fp32.sub":In,"Flogram.fp32.neg":xa,"Flogram.fp32.gt":ja,"Flogram.fp32.lt":Ca,"Flogram.fp32.le":ka,"Flogram.fp32.ge":Va,"Flogram.fp32.ne":Xa,"Flogram.fp32.eq":Ba,"Flogram.fp32.toi32":er,"Flogram.fp32.tou32":tr,"Flogram.fp32.tou64":ar,"Flogram.fp32.toi64":rr,"Flogram.fp32.tofp64":hr},{"Flogram.u32.add":js,"Flogram.u32.sub":Rs,"Flogram.u32.mul":As,"Flogram.u32.div":Ps,"Flogram.u32.rem":Us,"Flogram.u32.gt":vs,"Flogram.u32.lt":Ys,"Flogram.u32.le":Bs,"Flogram.u32.ge":Gs,"Flogram.u32.ne":Js,"Flogram.u32.eq":Xs,"Flogram.u32.toi32":jn,"Flogram.u32.toi64":lr,"Flogram.u32.tou64":ur,"Flogram.u32.tofp32":Qs,"Flogram.u32.tofp64":Zs},{"Flogram.i32.add":Cs,"Flogram.i32.sub":ks,"Flogram.i32.neg":Fs,"Flogram.i32.mul":Ds,"Flogram.i32.div":Ss,"Flogram.i32.rem":Ls,"Flogram.i32.gt":Vs,"Flogram.i32.lt":ws,"Flogram.i32.le":Ms,"Flogram.i32.ge":Ks,"Flogram.i32.ne":$s,"Flogram.i32.eq":Hs,"Flogram.i32.toi64":ir,"Flogram.i32.tou64":pr,"Flogram.i32.tou32":jn,"Flogram.i32.tofp32":qs,"Flogram.i32.tofp64":Ws},{"Flogram.i16.add":Cs,"Flogram.i16.sub":ks,"Flogram.i16.neg":Fs,"Flogram.i16.mul":Ds,"Flogram.i16.div":Ss,"Flogram.i16.rem":Ls,"Flogram.i16.gt":Vs,"Flogram.i16.lt":ws,"Flogram.i16.le":Ms,"Flogram.i16.ge":Ks,"Flogram.i16.ne":$s,"Flogram.i16.eq":Hs,"Flogram.i16.toi32":Jt,"Flogram.i16.tou32":Jt,"Flogram.i16.toi64":Pn,"Flogram.i16.tou64":An,"Flogram.i16.tofp32":qs,"Flogram.i16.tofp64":Ws},{"Flogram.u16.add":js,"Flogram.u16.sub":Rs,"Flogram.u16.mul":As,"Flogram.u16.div":Ps,"Flogram.u16.rem":Us,"Flogram.u16.gt":vs,"Flogram.u16.lt":Ys,"Flogram.u16.le":Bs,"Flogram.u16.ge":Gs,"Flogram.u16.ne":Js,"Flogram.u16.eq":Xs,"Flogram.u16.toi32":Jt,"Flogram.u16.tou32":Jt,"Flogram.u16.toi64":Pn,"Flogram.u16.tou64":An,"Flogram.u16.tofp32":Qs,"Flogram.u16.tofp64":Zs},{"Flogram.i8.add":Cs,"Flogram.i8.sub":ks,"Flogram.i16.neg":Fs,"Flogram.i8.mul":Ds,"Flogram.i8.div":Ss,"Flogram.i8.rem":Ls,"Flogram.i8.gt":Vs,"Flogram.i8.lt":ws,"Flogram.i8.le":Ms,"Flogram.i8.ge":Ks,"Flogram.i8.ne":$s,"Flogram.i8.eq":Hs,"Flogram.i8.toi32":Wt,"Flogram.i8.tou32":Wt,"Flogram.i8.toi64":Rn,"Flogram.i8.tou64":Cn,"Flogram.i8.tofp32":qs,"Flogram.i8.tofp64":Ws},{"Flogram.u8.add":js,"Flogram.u8.sub":Rs,"Flogram.u8.mul":As,"Flogram.u8.div":Ps,"Flogram.u8.rem":Us,"Flogram.u8.gt":vs,"Flogram.u8.lt":Ys,"Flogram.u8.le":Bs,"Flogram.u8.ge":Gs,"Flogram.u8.ne":Js,"Flogram.u8.eq":Xs,"Flogram.u8.toi32":Wt,"Flogram.u8.tou32":Wt,"Flogram.u8.toi64":Rn,"Flogram.u8.tou64":Cn,"Flogram.u8.tofp32":Qs,"Flogram.u8.tofp64":Zs},{"Flogram.bool.and":$a,"Flogram.bool.or":Ja,"Flogram.bool.xor":Wa,"Flogram.bool.not":Za}));var{LEB128_ENCODE:Ge}=_t,ep=new Int8Array(1),tp=new Uint8Array(1),dr=o=>{let s=[],a=!0;for(;a;){let E=o&127;o>>=7,o===0&&!(E&64)||o===-1&&E&64?a=!1:E|=128,s.push(E)}return new Uint8Array(s)},mr=o=>{let s=[],a=!0;for(;a;){let E=o&127;o>>=7,o===0?a=!1:E|=128,s.push(E)}return new Uint8Array(s)},gr=o=>{let s=[];for(;o>=128;)s.push(o&127|128),o>>>=7;return s.push(o),new Uint8Array(s)},xr=128,Tr=127,Sn=64,yr=o=>{o=o<<16>>16;let s=[];for(;;){let a=o&Tr;o=o>>7;let E=o===0,z=(a&Sn)===0,e=E&&z,B=o===-1,Y=(a&Sn)!==0;if(e||B&&Y){s.push(a);break}a=a|xr,s.push(a)}return s};var Ir=o=>{let s=new Float32Array(1);return s[0]=parseFloat(o),new Uint8Array(s.buffer)},Dn=o=>{let s=[],a=!0;for(;a;){let E=o&127;o>>=7,o===0&&!(E&64)||o===-1&&E&64?a=!1:E|=128,s.push(E)}return new Uint8Array(s)},zr=o=>Ge(o),Nr=o=>{let s=new Float64Array(1);return s[0]=o,new Uint8Array(s.buffer)},jr=o=>{let s=[];for(;o>=128;)s.push(o&127|128),o>>>=7;return s.push(o),new Uint8Array(s)},Pr=o=>{let s=[],a=!0;for(;a;){let E=o&127;o>>=7,o===0&&!(E&64)||o===-1&&E&64?a=!1:E|=128,s.push(E)}return new Uint8Array(s)},Ar=o=>{let s=new Uint8Array(1);return s[0]=o==="TRUE"?1:o==="FALSE"?0:o,s},Rr=o=>{let s=o.charCodeAt(0);return Ge(s)},Fn=()=>{let o=new ArrayBuffer(4);return new Float32Array(o)[0]=-0,[...new Uint8Array(o)]},Cr=Object.freeze({type:"native",identity:127,opcode:65,encode:Dn,link:Object.freeze({load:Object.freeze({opcode:40,align:2,offset:0,size:4}),store:Object.freeze({opcode:54,align:2,offset:0,size:4})})}),Sr=Object.freeze({type:"native",identity:127,opcode:65,none:Ge(-1),encode:Rr,link:Object.freeze({load:Object.freeze({opcode:44,align:2,offset:0,size:4}),store:Object.freeze({opcode:54,align:2,offset:0,size:4})})}),Dr=Object.freeze({type:"native",identity:127,opcode:65,none:Ge(-1),encode:Ar,link:Object.freeze({load:Object.freeze({opcode:40,align:2,offset:0,size:4}),store:Object.freeze({opcode:54,align:2,offset:0,size:4}),values:{TRUE:1,FALSE:0}})}),Fr=Object.freeze({type:"native",identity:124,opcode:68,none:Fn(),encode:Nr,link:Object.freeze({load:Object.freeze({opcode:43,align:3,offset:0,size:8}),store:Object.freeze({opcode:57,align:3,offset:0,size:8})})}),kr=Object.freeze({type:"native",identity:126,opcode:66,none:Ge(-1),encode:jr,link:Object.freeze({load:Object.freeze({opcode:43,align:3,offset:0,size:8}),store:Object.freeze({opcode:57,align:3,offset:0,size:8})})}),Ur=Object.freeze({type:"native",identity:126,opcode:66,none:Ge(-9223372036854776e3),encode:Pr,link:Object.freeze({load:Object.freeze({opcode:43,align:3,offset:0,size:8}),store:Object.freeze({opcode:57,align:3,offset:0,size:8})})}),Lr=Object.freeze({type:"native",identity:125,opcode:67,none:Fn(),encode:Ir,link:Object.freeze({load:Object.freeze({opcode:42,align:2,offset:0,size:4}),store:Object.freeze({opcode:56,align:2,offset:0,size:4})})}),vr=Object.freeze({type:"native",identity:127,opcode:65,none:Ge(-1),encode:zr,link:Object.freeze({load:Object.freeze({opcode:40,align:2,offset:0,size:4}),store:Object.freeze({opcode:54,align:2,offset:0,size:4})})}),Vr=Object.freeze({type:"native",identity:127,opcode:65,none:Ge(-2147483648),encode:Dn,link:Object.freeze({load:Object.freeze({opcode:40,align:2,offset:0,size:4}),store:Object.freeze({opcode:54,align:2,offset:0,size:4})})}),Yr=Object.freeze({type:"native",identity:127,opcode:65,none:Ge(-32768),encode:yr,link:Object.freeze({load:Object.freeze({opcode:40,align:2,offset:0,size:4}),store:Object.freeze({opcode:54,align:2,offset:0,size:4})})}),wr=Object.freeze({type:"native",identity:127,opcode:65,encode:gr,none:Ge(-1),link:Object.freeze({load:Object.freeze({opcode:40,align:2,offset:0,size:4}),store:Object.freeze({opcode:54,align:2,offset:0,size:4})})}),Mr=Object.freeze({type:"native",identity:127,opcode:65,none:Ge(-128),encode:dr,decode:o=>new Int8Array([o])[0],link:Object.freeze({load:Object.freeze({opcode:44,align:0,offset:0,size:4}),store:Object.freeze({opcode:58,align:0,offset:0,size:4})})}),Br=Object.freeze({type:"native",identity:127,opcode:65,none:Ge(-1),encode:mr,link:Object.freeze({load:Object.freeze({opcode:43,align:0,offset:0,size:4}),store:Object.freeze({opcode:58,align:0,offset:0,size:4})})}),it=Object.freeze({"Flogram.String":Cr,"Flogram.Char":Sr,"Flogram.Bool":Dr,"Flogram.FP64":Fr,"Flogram.U64":kr,"Flogram.I64":Ur,"Flogram.FP32":Lr,"Flogram.U32":vr,"Flogram.I32":Vr,"Flogram.I16":Yr,"Flogram.U16":wr,"Flogram.I8":Mr,"Flogram.U8":Br});var Kr=Object.freeze(["FP64","U64","I64","FP32","U32","I32","U16","I16","U8","I8","Bool","Char","Array","String","Link","Maybe"]),St=Kr;var{TYPES_ASSIGN:Gr,TYPES_DRAW:Hr,TYPES_ARRAY:J,TYPES_ARRAY_ASSIGNMENT:Xr,TYPES_BRANCH_MATCH:$r,TYPES_BRANCH_DEFAULT:Jr,TYPES_CONDITION:en,TYPES_LOOP:Zt,TYPES_WHILE:Wr,TYPES_FOREACH:Zr,TYPES_DATA:qt,TYPES_GENERICS:fp,TYPES_ENUMERATION:ct,TYPES_EXPRESSION:dt,TYPES_INSTANCE:Ep,TYPES_LINK:pt,TYPES_LOCAL:Pe,TYPES_CONCAT:kn,TYPES_OBJECT:he,TYPES_PROCEDURE:hp,TYPES_RETURN:tn,TYPES_SELECT:qe,TYPES_MEMBER:Dt,TYPES_STORE:qr,TYPES_BREAK:Qr,TYPES_LITERAL:at,TYPES_ARRAY_ACCESS:Qt,TYPES_LINK_TO:es,TYPES_VALUE_AT:Ft,TYPES_SELF:bp,TYPES_DROP:Un,TYPES_MAYBE:kt,TYPES_MOVE:ei,TYPES_NATIVE:Ie,TYPES_STRING:be,TYPES_FREE:ti,TYPES_BRANCH:Ln,TYPES_CONTINUE:vn,TYPES_DEFAULT_BLOCK:Vn,TYPES_BLOCK_END:ft,TYPES_STATEMENT:Yn,TYPES_DESTRUCTOR:wn,TYPES_SIZE:Mn,TYPES_WHILE_CONDITION:Bn,TYPES_FOREACH_CONDITION:Kn,TYPES_FOREACH_END:Gn}=Gt,Ut=2,ts=3,ss=12,Lt=13,Qe=16,Je=26,O=65,Hn=71,si=113,ni=114,sn=70,Ce=32,vt=33,G=35,Ae=36,oi=15,nn=11,Xn=4,ci=5,et=64,mt=127,He=108,ai=109,W=106,ri=107,we=54,gt=40,ze=0,Ne=2,ii="alloc",pi="dealloc",$n="merge",Jn="save",li="undo",ui="undoPenultimate",fi="draw",Ei=999999,Wn=888888,hi=777777,L=0,Me=1,bi=4,Vt=8,Zn=8,qn="Flogram.draw",ns=new Set(["==","!=",">",">=","<","<=","!","&","|"]),{LEB128_ENCODE:m}=_t,on,P=(o,s)=>`${s}.${o}`,Qn=(o,s,a)=>{let E=a.get(o);if(E&&E.length===1)return E[0];if(E&&E.length>1)return E[0];throw console.log(o),console.log(a),Error("No Callees were found")};function os(o,s,a,E){o?.description?.inputs.length>0?on=o.description.inputs[0].data.name:o?.description?.outputs.length>0&&(on=o.description.outputs[0].data.name);let z=c=>{Le(c.collection).length},e=[],B=new Set,Y=!1,ie=c=>{B.add(c)},oe=()=>{e.push(Qe,ii),ie("alloc")},fe=()=>{e.push(Qe,fi),ie("draw")},De=(c=L)=>{e.push(O,0),oe(),e.push(Ae,c)},Re=()=>{e.push(G,L),e.push(G,Me),e.push(Qe,Jn),e.push(G,Me),e.push(G,L),e.push(Qe,Jn),ie("save")},Et=()=>{e.push(Qe,li),e.push(Ae,Me),e.push(Ae,L),ie("undo")},ls=()=>{e.push(Qe,ui),e.push(Ae,Me),e.push(Ae,L),ie("undoPenultimate")},Be=()=>{e.push(Qe,$n),ie("merge")},{description:We}=o,{inputs:wt,locals:Ze,statements:Mt}=We,de=new Map,ce=new Map;{let c=0,i=t=>{for(let n of t){let{name:r,data:f}=n;switch(de.set(r,c),ce.set(r,n),f.type){case kt:case qt:{let{name:b,path:C}=f,K=P(b,C);switch(b){case be:{c=c+2|0;break}default:{let S=s.get(K);switch(S.type){case Ie:{c=c+1|0;break}case ct:{c=c+1|0;break}case he:{let{length:Q}=S;c=c+2|0;break}}break}}break}case J:{c=c+2|0;break}case pt:{f.name===be||f.name===J?c=c+2|0:c=c+1|0;break}}}};i(wt),i(Ze)}let Fe=0,st=[];for(let c of Ze){let{data:i}=c,t=()=>{st.push(1,mt),Fe=Fe+1|0},n=()=>{st.push(1,mt),Fe=Fe+1|0,st.push(1,mt),Fe=Fe+1|0},r=()=>{st.push(1,mt),Fe=Fe+1|0},f=b=>{let{identity:C}=b;st.push(1,C),Fe=Fe+1|0};switch(i.type){case J:{n();break}case pt:{i.name===J||i.name===be?n():t();break}case kt:case qt:{let{name:b,path:C}=i;switch(b){case be:{n();break}default:{let K=P(b,C),S=s.get(K);switch(S.type){case Ie:{f(S);break}case ct:{r();break}case he:{n();break}}break}}break}}}((c,i)=>{for(let[t,n]of c)if(n.type==i){st.push(1,mt),Fe=Fe+1|0;break}})(s,he);let us=m(Fe);e.push(...us,...st);let nt=c=>{if(typeof c!==he)return c;switch(c.type){case Pe:return c.name;case es:return nt(c.value);case Ft:return nt(c.link);case Dt:return`${c.type}_${c.trail.join("_")}`;case Qt:return c.array.name;case qe:return nt(c.value)}return null},Le=c=>{switch(c.type){case at:return c;case Pe:return ce.get(c.name)?.data;case Ft:return Le(c.link);case es:return Le(c.value);case Mn:{if(input.value.type===Pe)return{name:"I32",path:"Flogram",type:"data"};break}case Qt:return ce.get(nt(c));case qe:{let{value:i,trail:t}=JSON.parse(JSON.stringify(c)),{name:n}=i,r=ce.get(n||nt(i)),{data:f}=r,b=P(f.name,f.path),C=s.get(b),{indivisibles:K}=C,S=JSON.parse(JSON.stringify(t)),Q=C;for(;S.length>0;){let Te=S.shift();if(S.length>0){let me=Q.members.get(Te),ge=P(me.name,me.path);Q=s.get(ge);continue}Q=Q.members.get(Te)}return Q}}},H=(c,i=tn)=>{let t=0,n=[],r=(U,h)=>{let R={type:"call",key:U,inputs:h};n.unshift(R)},f=U=>{let h={type:"value",value:U};n.unshift(h)},b=U=>{let h={type:Dt,member:U};n.unshift(h)},C=(U,h,R,D)=>{let g={key:null,stop:!1},x;if(U&&St.includes(U.data.name)){let{data:xe}=U,{name:k}=xe;x=P(k.toLowerCase()+"."+Ke(R),h),on=k}else if(U){let{data:xe}=U,{name:k,path:Oe}=xe,_=P(k,Oe),u=s.get(_),{indivisibles:T}=u,{mapTrail:N}=T,I=N.size-1;for(let[V,F]of N){n.unshift({type:"compare",currentIndex:I,name:R}),x=P(F.data.name.toLowerCase()+"."+Ke(R),F.data.path);let d=D.map(j=>({type:qe,value:{type:Pe,name:j.name},trail:[F.trail]}));r(x,d);var $=d.length-1|0;for(let j=$;j>=0;j=j-1|0){let X=d[j];f(X)}I--}g.stop=!0}return g.key=x,g},K=U=>{let{inputs:h}=U,R=h.find(D=>D.type==dt);if(ns.has(U.name))return"Bool";if(R){let D=h.map(x=>{if(x.type===Pe)return ce.get(x.name);if(x.type===at)return{data:x};if(x.type===dt)return{data:{name:K(x)}}}),g=E.find(x=>x.description&&Array.isArray(x.description.inputs)?x.description.inputs.length!==D.length?!1:x.description.inputs.every(($,xe)=>$.data.name===D[xe].data.name):!1);return g?ns.has(g.name)?g.description.inputs[0].data.name:g.description.outputs[0].data.name:"unknown"}else{let D=h.map(x=>({data:Le(x)})),g=E.find(x=>x.description&&Array.isArray(x.description.inputs)?x.description.inputs.length!==D.length?!1:x.description.inputs.every(($,xe)=>$.data.name===D[xe].data.name):!1);return g?ns.has(g.name)?g.description.inputs[0].data.name:g.description.outputs[0].data.name:"unknown"}},S=U=>{let{inputs:h,name:R,path:D}=U,g=P(R,D),x=[D],$;if(typeof R===he){let k=R[0];if($=ce.get(k),$){x.push($.data.name);for(let _=1;_<=R.length-2;_++)k=R[_],$=ce.get(k),$&&x.push($.data.name)}let Oe=R.length-1|0;g=P(R[Oe],x.join("."))}if(D==="Flogram"&&R!==Hr){let k=h.find(u=>u.type===dt),Oe=h.find(u=>u.type===at),_=h.map(u=>ce.get(u.name)).find(Boolean);if(_){let u=C(_,D,R,h);if(g=u.key,u.stop)return}else if(Oe)g=P(`${Oe.name.toLowerCase()}.${Ke(R)}`,D);else if(k)g=P(`${K(k).toLowerCase()}.${Ke(R)}`,D);else{let u=E.find(T=>T.name===U.name&&T.path===U.path&&T.description.inputs.length===U.inputs.length);g=P(`${ns.has(u.name)?u.description.inputs[0]?.data.name.toLowerCase():u.description.outputs[0]?.data.name.toLowerCase()}.${Ke(u.name)}`,D)}}if(r(g,h),typeof R===he){let k=Qn(g,h,a);if(k){let{procedure:Oe}=k,{description:_}=Oe,{self:u}=_,T=ce.get(R[0]),N=P(T.data.name,T.data.path),I=s.get(N);if(I){let V=de.get(R[0]),{indivisibles:F,members:d}=I,{mapTrail:j}=F;for(let X=u.length-1|0;X>=0;X--){let Z=u[X];if(Z.type===Dt){let M=Z.trail.join(".");if(j.get(M)){let{address:te}=j.get(M);b({index:V,address:te})}else{let te=JSON.parse(JSON.stringify(Z.trail)),ee=I;for(;te.length>0;){let je=te.shift();if(te.length>0){let bt=ee.members.get(je),At=P(bt.name,bt.path);ee=s.get(At);continue}ee=ee.members.get(je)}let ne=P(ee.name,ee.path),ye=s.get(ne),{indivisibles:$e}=ye,{mapIndex:re,mapTrail:Ve}=$e,ke=re.get(0),_e=`${M}.${ke.trail}`,{address:ae}=j.get(_e),Ye={index:V,address:ae-8};b(Ye)}}}}}}if(g!==qn){var xe=h.length-1|0;for(let k=xe;k>=0;k=k-1|0){let Oe=h[k];f(Oe)}}},Q=U=>{let{key:h,inputs:R}=U;if(h===qn){for(let x of R){let $=Le(x);x.type===qe?$?.name===be?(e.push(O,...m(Wn)),fe(),H(x),e.push(Ae,L),e.push(gt,Ne,ze),fe(),e.push(G,L),e.push(gt,Ne,ze),fe()):(H(x),fe()):$?.name===be||x.type===kn?(e.push(O,...m(Wn)),fe(),H(x),fe(),fe()):$?.name===J||$?.layout===J?(e.push(O,...m(Ei)),fe(),H(x),fe(),fe()):(H(x),fe()),x.type===qe&&(e.push(Je),($?.name===be||$?.type===J||$?.layout===J)&&e.push(Je))}e.push(O,...m(hi)),fe(),t=t-R.length|0;return}let D=Qn(h,R,a);switch(D.type){case Ie:{let{body:x}=D;e.push(...x);break}case"artificial":{let{index:x}=D;e.push(Qe,x);break}}let{lengths:g}=D;t=t-g.inputs|0,t=t+g.outputs|0},Te=U=>{let{value:h}=U,R=_=>{let u=0;Y=!0;let T=nt(_),N;if(_.type===qe){let{value:I,trail:V}=JSON.parse(JSON.stringify(_)),{name:F}=I,d=ce.get(F),{data:j}=d,X=P(j.name,j.path),Z=s.get(X),{indivisibles:M}=Z,{mapTrail:te}=M,ee=V.join("."),ne=JSON.parse(JSON.stringify(V)),ye=Z;for(;ne.length>0;){let re=ne.shift();if(ne.length>0){let Ve=ye.members.get(re),ke=P(Ve.name,Ve.path);ye=s.get(ke);continue}ye=ye.members.get(re)}let $e=P(ye.name,ye.path);N=s.get($e)}else{let I=ce.get(T),{data:V}=I,{name:F,path:d,segment:j}=V,X=P(F,d);N=s.get(X)}if(N){switch(N.type){case Ie:{Te({value:_});let{link:I}=N,{load:V}=I;e.push(V.opcode,V.align,V.offset),u=u+1|0;break}case he:{let I=0,V=()=>{},F=Z=>{Te({value:_});let{link:M}=Z,{load:te}=M;e.push(te.opcode,te.align,te.offset+I|0),u=u+1|0,I=I+te.size|0},d=()=>{},{indivisibles:j}=N,{mapTrail:X}=j;for(let Z of X.values()){if(Z.type===pt){d();continue}let{data:M}=Z,{name:te,path:ee}=M,ne=P(te,ee),ye=s.get(ne);switch(ye.type){case Ie:{F(ye);break}case ct:{V();break}}}break}}return u}},D=(_,u)=>{let T=0;Y=!0;let{literal:N,name:I,path:V,size:F}=_,d=F||N.length;_.length&&!F&&(d=parseInt(_.length,10));let j=P(I,V),X=s.get(j);function Z(M){let te=0,{literal:ee,name:ne,path:ye,vSize:$e}=M,re=$e||ee.length;M.length&&!$e&&(re=parseInt(M.length,10));let Ve=P(ne,ye),ke=s.get(Ve);De(),(ke.type===he||ne===be&&M.layout===J||M.contains===J)&&(e.push(O,...m(re*4*2|0)),oe(),e.push(vt,L),Re());for(let _e=0;_e<re;_e++){let ae=ee[_e];if(ae)if(ae.name===be&&M.layout===J||ae.layout===J&&ke.type!==he){let Ye=[];if(ae.layout===J){let je=ae.size||ae.literal.length;e.push(G,L),e.push(G,L),e.push(G,L),e.push(O,...m(_e)),e.push(O,...m(8)),e.push(He),e.push(W),Ye.push(ae.literal),Z(ae),e.push(G,L),e.push(we,Ne,ze),e.push(O,...m(4)),e.push(O,...m(_e)),e.push(O,...m(8)),e.push(He),e.push(W),e.push(W),e.push(O,je),e.push(we,Ne,ze),e.push(Ae,L)}else{let je=ae.size||ae.literal.length;for(let At=0;At<je;At++)Ye.push({type:ae.type,path:ae.path,name:"I32",literal:ae.literal[At].charCodeAt().toString()});let bt={type:at,name:"I32",layout:J,path:ae.path,literal:Ye};e.push(G,L),e.push(G,L),e.push(G,L),e.push(O,...m(_e)),e.push(O,...m(8)),e.push(He),e.push(W),Z(bt),e.push(G,L),e.push(we,Ne,ze),e.push(O,...m(4)),e.push(O,...m(_e)),e.push(O,...m(8)),e.push(He),e.push(W),e.push(W),e.push(O,je),e.push(we,Ne,ze),e.push(Ae,L)}}else switch(ke.type){case Ie:{let{link:Ye}=ke,{store:je}=Ye;e.push(O,...m(je.size)),oe(),!ae||ae.type===at?e.push(ke.opcode,...ke.encode(ae?.literal||0)):H(ae),e.push(je.opcode,je.align,je.offset),Be(),te=3;break}case he:{e.push(G,L),e.push(G,L),e.push(O,...m(_e)),e.push(O,...m(8)),e.push(He),e.push(W),H(ae),e.push(Ae,Me),e.push(we,Ne,ze),e.push(Ae,L),e.push(G,L),e.push(O,...m(4)),e.push(O,...m(_e)),e.push(O,...m(8)),e.push(He),e.push(W),e.push(W),e.push(G,Me),e.push(we,Ne,ze);break}}}}return Z(_),u?d:(e.push(G,L),e.push(O,...m(d)),T=1,T)},g=(_,u,T=!0)=>{let N=s.get(u);De();let I=(d,j)=>{Re(),ls(),e.push(G,L),e.push(G,L),e.push(G,L),Et(),e.push(O,...m(j)),e.push(W),e.push(G,L),e.push(we,Ne,ze),e.push(O,...m(j)),e.push(O,...m(4)),e.push(W),e.push(W),e.push(O,...m(d)),e.push(we,Ne,ze),e.push(Ae,L)},V=[];for(let[d,j]of N.members){if(!j)continue;let X=_.find(te=>te.name===d)||{name:d,value:j.value},Z=P(j.name,j.path),M=s.get(Z);if(j.type===J){e.push(O,...m(Vt)),oe(),e.push(Je),V.push({data:{keyName:d,keyData:j},literal:X});continue}switch(M.type){case Ie:{let{link:te}=M,{store:ee}=te;if(j.type===pt)Re(),e.push(O,...m(4)),oe(),H(X.value),e.push(ee.opcode,ee.align,ee.offset),Et();else if(j.name===be)e.push(O,...m(Vt)),oe(),e.push(Je),V.push({data:{keyName:d,keyData:j},literal:X});else{e.push(O,...m(ee.size)),oe();let ne=JSON.parse(JSON.stringify(X.value));ne.literal&&(ne.name!==j.name||ne.path!==j.path)&&(ne={...ne,name:j.name,path:j.path}),H(ne),e.push(ee.opcode,ee.align,ee.offset)}Be();break}case he:{e.push(O,...m(Vt)),oe(),e.push(Je),V.push({data:{keyName:d,keyData:j},literal:X});break}}}if(V.length>0){let d=V[0],{data:j,literal:X}=d,{keyName:Z,keyData:M}=j,{type:te,name:ee,layout:ne,path:ye}=M,re=(_e=>{let ae=N.indivisibles.mapTrail;if(ae.has(_e))return ae.get(_e).address;let Ye=Array.from(ae.entries()).filter(([je])=>je.startsWith(`${_e}.`));return Ye.length?(Ye.sort((je,bt)=>je[1].address-bt[1].address),Ye[0][1].address-8):null})(Z),Ve=P(ee,ye),ke=s.get(Ve);if(ee===be)Re(),H(X.value),e.push(Je,Je),I(X.value.size||X.value.literal.length,re),Be();else if(te===J||ne===J)if(X.value.type===Pe){let _e=de.get(X.value.name);Re();let ae=$(M,_e);I(ae,re),Be()}else{Re();let _e=D(X.value,!0);I(_e,re),Be()}else if(ke.type===he){Re();let _e=g(X.value.literal,Ve,!1);I(_e,re),Be()}else console.log("we failed here.......")}let F=N.indivisibles.mapTrail.size+V.length;return T&&(e.push(G,L),e.push(O,...m(F))),F},x=(_,u)=>{let T=0;Y=!0;let N=ce.get(u),I;if(N){let{data:F}=N,{name:d,path:j,segment:X}=F;I=P(d,j)}else{let F=d=>{if(d.type===at)return P(d.name,d.path);if(d.type===dt)return F(d.inputs[0]);if(d.type===Ft)return F(d.link);if(d.type===es)return F(d.value);if(d.type===Pe){let j=ce.get(d.name),{data:X}=j,{name:Z,path:M,segment:te}=X;return P(Z,M)}else if(d.type===qe){let j=s.get(F(d.value)),{indivisibles:X}=j,{mapTrail:Z}=X,M=d.trail.join("."),{data:te}=Z.get(M),{name:ee,path:ne}=te;return P(ee,ne)}};I=F(_)}let V=s.get(I);switch(V.type){case Ie:{let{link:F}=V,{store:d}=F;e.push(O,...m(d.size)),oe(),e.push(Ae,L),e.push(G,L),H(_),e.push(d.opcode,d.align,d.offset),e.push(G,L),T=T+7|0;break}case he:{let F=0,d=()=>{},j=te=>{H(_);let{link:ee}=te,{load:ne}=ee;e.push(ne.opcode,ne.align,ne.offset+F|0),T=T+1|0,F=F+ne.size|0},X=()=>{},{indivisibles:Z}=V,{mapTrail:M}=Z;for(let te of M.values()){if(te.type===pt){X();continue}let{data:ee}=te,{name:ne,path:ye}=ee,$e=P(ne,ye),re=s.get($e);switch(re.type){case Ie:{j(re);break}case ct:{d();break}}}break}}return T},$=(_,u=0)=>{let{name:T,path:N}=_,I=P(T,"Flogram"),V=s.get(I),{link:F}=V,{store:d,load:j}=F,X=Number(_.length);De();for(let Z=0;Z<X;Z++){e.push(O,...m(d.size)),oe();let M=u;k(M,M+1|0),e.push(O,...m(Z)),e.push(O,j.size),e.push(He),e.push(W),e.push(j.opcode,j.align,j.offset),e.push(d.opcode,d.align,d.offset),Be()}return X},xe=(_,u)=>{let T=s.get(u),{opcode:N}=T,I=T.encode(_);e.push(N,...I)},k=(_,u)=>{for(;_<u;)e.push(Ce,_),_=_+1|0};switch(h.type){case dt:{S(h);break}case"instance":{let{path:_,members:u}=h;var Oe=u.length-1|0;for(let T=Oe;T>=0;T=T-1|0){let N=u[T],{path:I,value:V}=N;f(V)}break}case kt:{let{data:_}=h,{name:u,path:T}=_,N=P(u,T),I=s.get(N);h.layout==="NONE"?e.push(I.opcode,...I.none):H(h.value),t=t+1|0;break}case Ft:{let{link:_}=h,u=R(_);t=t+u|0;break}case es:{let{value:_}=h,u=nt(_);if(ce.get(u)?.data.type===J){H({name:u,type:Pe});return}let N=x(_,u);t=t+N|0;break}case Mn:{let{value:_}=h;switch(_.type){case Pe:{let u=de.get(_.name);k(u+1|0,u+2|0);break}}break}case kn:{let{values:_}=h;De(Me);for(let u of _){let T=Le(u),N=P(T.name,T.path);if(T.name===be||T.type===J||T.layout===J)H(u,"assignment"),e.push(Je),e.push(Je);else{let I=s.get(N),{link:V}=I,{store:F}=V;e.push(O,...m(F.size)),oe(),H(u),e.push(F.opcode,F.align,F.offset)}Be()}De(),e.push(G,Me),e.push(G,L),e.push(G,Me),e.push(ri),e.push(O,4),e.push(ai),t=t+2|0;break}case at:{let{literal:_,name:u,path:T}=h,N=P(u,T),I=s.get(N);if(h.layout===J){D(h),t=t+2|0;return}else if(u===be){let V=[];for(let d of _)V.push({type:at,literal:d.charCodeAt(0).toString(),name:be,path:"Flogram"});let F={...h,literal:V};D(F),t=t+2|0;return}I&&I.type===he?(g(_,N),t=t+2|0):(I||(console.log(h),console.log("NO SHAPE FOUND")),xe(_,N),t=t+1|0);break}case Qt:{let{array:_,index:u}=h,{name:T}=_,N=de.get(T),I=ce.get(T),V=P(I.data.name,I.data.path);Y=!0;let F=s.get(V);switch(F.type){case Ie:if(!(I.data.contains===J||I.data?.type===J&&I.data?.layout===J||I.data?.name===be)){let{link:d}=F,{load:j}=d;k(N,N+1|0),H(u),e.push(O,j.size),e.push(He),e.push(W),e.push(j.opcode,j.align,j.offset),t=t+2|0;break}case he:{k(N,N+1|0),H(u),I.data?.type===J&&I.data?.name!==be&&!I.data?.contains?e.push(O,4):e.push(O,...m(Zn)),e.push(He),e.push(W),e.push(gt,Ne,ze),k(N,N+1|0),e.push(O,...m(4)),H(u),I.data?.type===J&&I.data?.name!==be&&!I.data.contains?e.push(O,4):e.push(O,...m(Zn)),e.push(He),e.push(W),e.push(W),e.push(gt,Ne,ze),t=t+2|0;break}}break}case ei:{H(h.value);break}case Pe:{let{name:_}=h,u=de.get(_),T=ce.get(_),{data:N}=T;switch(N.type){case pt:{N.name===J||N.name===be?(k(u,u+2|0),t=t+2|0):(k(u,u+1|0),t=t+1|0);break}case J:{if(i==="assignment"&&N.length){let I=$(N,u);e.push(G,L),e.push(O,...m(I))}else k(u,u+2|0),t=t+2|0;break}case kt:case qt:{let{name:I,path:V}=N,F=P(I,V),d=s.get(F);switch(N.layout){case J:{k(u,u+2|0),t=t+2|0;break}default:{switch(d.type){case Ie:{if(I===be){i==="assignment"?(e.push(O,0),e.push(Ae,L),e.push(Ut,et),e.push(ts,et),e.push(O,4),oe(),e.push(Ce,u),e.push(G,L),e.push(O,4),e.push(He),e.push(W),e.push(gt,Ne,ze),e.push(we,Ne,ze),e.push(G,L),e.push(O,1),e.push(W),e.push(Ae,L),e.push(Qe,$n),ie("merge"),e.push(G,L),e.push(Ce,u+1),e.push(sn),e.push(Lt,1),e.push(ss,0),e.push(nn),e.push(nn),e.push(G,L),e.push(Ce,u+1)):(k(u,u+2|0),t=t+2|0);break}else k(u,u+1|0);break}case ct:{k(u,u+1|0),t=t+1|0;break}case he:{k(u,u+2|0),t=t+2|0;break}}break}}break}}break}case qe:{let{value:_,trail:u}=h,T=_.name||_.link||_.value,N;Y=!0;let I=ce.get(T);if(I){let{data:re}=I,Ve=P(re.name,re.path);N=s.get(Ve)}else{let re=Le(_);N=s.get(P(re.data?.name,re.data?.path))}let{indivisibles:V}=N,{mapTrail:F}=V,d=JSON.parse(JSON.stringify(u)),j=F.get(u[0]),{address:X}=j,Z=[X],M=N;for(;d.length>0;){let re=d.shift();if(d.length>0){let Ve=M.members.get(re),ke=P(Ve.name,Ve.path);if(M=s.get(ke),M.indivisibles){let{indivisibles:_e}=M,{mapTrail:ae}=_e,Ye=ae.get(d[0]),{address:je}=Ye;Z.push(je)}continue}M=M.members.get(re)}let te=P(M.name,M.path),ee=s.get(te),{link:ne}=ee,{load:ye}=ne,$e=de.get(T);for(e.push(Ce,...m($e));Z.length>1;){let re=Z.shift();e.push(O,...m(re)),e.push(W),e.push(gt,Ne,ze)}e.push(O,...m(Z[0])),e.push(W),M.name===be||M.type===J||M.layout===J?(e.push(Ae,L),e.push(G,L),e.push(O,4),e.push(W),e.push(G,L)):e.push(ye.opcode,ye.align,ye.offset);break}}},me=U=>{let{name:h,currentIndex:R}=U;if(R===0)e.push(vt,de.size+1);else if(e.push(Ce,de.size+1),h==="==")e.push(si);else if(h==="!=")e.push(ni);else throw new Error(`Unknown operator ${h} for objects`)},ge=U=>{let{member:h}=U,{isObject:R,index:D,address:g}=h;if(R){e.push(Ce,...m(D)),e.push(O,...m(g)),e.push(W),e.push(Ce,...m(D)),e.push(O,...m(g+4)),e.push(W);return}e.push(Ce,...m(D)),e.push(O,...m(g)),e.push(W)};for(f(c);n.length>0;){let U=n.shift();switch(U.type){case"call":{Q(U);break}case"value":{Te(U);break}case Dt:{ge(U);break}case"compare":{me(U);break}}}return t},zt=c=>{let i=(n,r)=>{for(;n<r;)r=r-1|0,e.push(vt,r)},t=(n,r)=>{switch(r.type){case pt:{r.name===J||r.name===be?i(n,n+2|0):i(n,n+1|0);break}case be:{i(n,n+2|0);break}case J:{i(n,n+2|0);break}case kt:case qt:{let{name:f,path:b}=r,C=P(f,b),K=s.get(C);switch(f){case be:{i(n,n+2|0);break}case J:{i(n,n+Number(r.length)|0);break}default:{switch(K.type){case Ie:if(f===be){i(n,n+2|0);break}case ct:{i(n,n+1|0);break}case he:{let{length:S}=K;i(n,n+2|0);break}}break}}break}}};switch(c.type){case Pe:{let{name:n}=c,r=de.get(n),f=ce.get(n),{data:b}=f;t(r,b);break}case qe:{let{value:n,trail:r}=c,{name:f}=n,b=ce.get(f),{data:C}=b,K=P(C.name,C.path),S=s.get(K),{indivisibles:Q}=S,{mapTrail:Te}=Q,me=r.join("."),ge=JSON.parse(JSON.stringify(r)),U=Te.get(me),{index:h}=U,R=S;for(;ge.length>0;){let g=ge.shift();R=R.members.get(g)}let D=de.get(f);R.type==J||R.type==be?i(D+h|0,D+h+2|0):i(D+h|0,D+h+1|0);break}}},fs=(c,i)=>{let{array:t,index:n}=c;Y=!0;let r=0,f=de.get(t.name),b=()=>{e.push(Ce,f)},C=ce.get(t.name),{data:K}=C,{name:S,path:Q,segment:Te}=K,me=P(S,Q),ge=s.get(me);switch(ge.type){case Ie:{b(),H(n);let{link:U}=ge,{store:h}=U;e.push(O,h.size),e.push(He),e.push(W),H(i),e.push(h.opcode,h.align,h.offset),r=r+4|0;break}case he:{let U=null,h=0;if(i.type===Pe){let{name:k}=i;U=ce.get(k),h=de.get(k)}let R=0,D=()=>{},g=(k,Oe)=>{b();let{index:_}=Oe;e.push(Ce,h+_|0);let{link:u}=k,{store:T}=u;e.push(T.opcode,T.align,T.offset+R|0),r=r+1|0,R=R+T.size|0},x=()=>{},{indivisibles:$}=ge,{mapTrail:xe}=$;for(let k of xe.values()){if(k.type===pt){x();continue}let{data:Oe}=k,{name:_,path:u}=Oe,T=P(_,u),N=s.get(T);switch(N.type){case Ie:{g(N,k);break}case ct:{D();break}}}break}}return r},Es=(c,i)=>{let{value:t,trail:n}=c,{name:r}=t;Y=!0;let f=ce.get(r),{data:b}=f,C=P(b.name,b.path),K=s.get(C),{indivisibles:S}=K,{mapTrail:Q}=S,Te=n.join("."),me=JSON.parse(JSON.stringify(n)),ge=Q.get(Te),{address:U}=ge,h=K;for(;me.length>0;){let g=me.shift();if(me.length>0){let x=h.members.get(g),$=P(x.name,x.path);h=s.get($);continue}h=h.members.get(g)}let R=P(h.name,h.path),D=s.get(R);switch(D.type){case Ie:{let{link:g}=D,{store:x}=g,$=de.get(r);e.push(Ce,...m($)),e.push(O,...m(U)),e.push(W),H(i),e.push(x.opcode,x.align,x.offset);break}}},hs=(c,i)=>{let{link:t}=c;Y=!0;let n=0,{name:r,path:f,segment:b}=Le(t),C=P(r,f),K=s.get(C);switch(K.type){case Ie:{H(t),H(i);let{link:S}=K,{store:Q}=S;e.push(Q.opcode,Q.align,Q.offset),n=n+1|0;break}case he:{let S=0,Q=(g,x,$="")=>{let xe=$?`${$}.${g.name}`:g.name,k=x.get(xe);if(k){let{data:Oe}=k,_=P(Oe.name,Oe.path),u=s.get(_),{store:T}=u.link;H(t),e.push(O,...m(k.address)),e.push(W),H(g.value),e.push(T.opcode,T.align,T.offset)}else if(g.value&&g.value.literal)for(let Oe of g.value.literal)Q(Oe,x,xe)};if(i.type===Pe){let{name:g}=i;if(S=de.get(g),c.link.name.startsWith(Dt)){let x=de.get(c.link.name),{name:$,path:xe}=ce.get(g),k=P($,xe),Oe=s.get(k),{indivisibles:_}=Oe,{mapTrail:u}=_;for(let T of u){let{data:N}=T,I=P(N.name,N.path),V=s.get(I),{load:F,store:d}=V.link;e.push(O,...m(x)),e.push(O,...m(T.address)),e.push(W),e.push(O,...m(S)),e.push(O,...m(T.address)),e.push(W),e.push(F.opcode,F.align,F.offset),e.push(d.opcode,d.align,d.offset)}return}return H(t),e.push(Ce,...m(S)),e.push(we,Ne,ze),H(t),e.push(O,...m(4)),e.push(W),e.push(Ce,...m(S+1|0)),e.push(we,Ne,ze),n=n+2|0,n}let{literal:Te,name:me,path:ge}=i,U=P(me,ge),h=s.get(U),{indivisibles:R}=h,{mapTrail:D}=R;for(let g of Te)Q(g,D)}}return n},bs=(c,i)=>{let{link:t}=i,n=0,r=S=>{let Q=Array.from(S.members.values()).reduce((h,R)=>R?h+1:h,0);De();let{indivisibles:Te}=S,{mapTrail:me}=Te,ge=(h,R)=>{let{store:D,load:g}=h.link,{address:x}=me.get(R);e.push(O,...m(D.size)),oe(),H(t),e.push(O,...m(x)),e.push(W),e.push(g.opcode,g.align,g.offset),e.push(D.opcode,D.align,D.offset)},U=(h,R)=>{e.push(O,...m(Vt)),oe(),e.push(Ae,Me);for(let[g,x]of h.members){if(!x)continue;let $=P(x.name,x.path),xe=s.get($);if(xe.type===he){Re(),U(xe,`${R}.${g}`);continue}let k=`${R}.${g}`;ge(xe,k)}e.push(G,Me),e.push(G,Me),e.push(O,...m(Vt)),e.push(W),e.push(we,Ne,ze);let D=Array.from(h.members.values()).reduce((g,x)=>x?g+1:g,0);e.push(G,Me),e.push(O,...m(bi)),e.push(W),e.push(O,...m(D)),e.push(we,Ne,ze),Et()};for(let[h,R]of S.members){if(!R)continue;let D=P(R.name,R.path),g=s.get(D);if(g.type===he){U(g,h);continue}ge(g,h)}e.push(G,L),e.push(O,...m(Q))},{name:f,path:b}=Le(t),C=P(f,b),K=s.get(C);switch(K.type){case Ie:case he:{if(c.type===Pe)return r(K),zt(c),n;break}}return n},Os=(c,i,t)=>{let n=s.get(c),r=b=>{switch(b.type){case Pe:{let{name:C}=b,K=de.get(C);e.push(Ce,K);break}case at:{let{literal:C}=b,K=n.type===Ie?C:n.evaluate(C),S=m(K);e.push(O,...S);break}}},f=()=>{switch(n.type){case ct:{e.push(Hn),e.push(Lt,0);break}case Ie:{e.push(Hn),e.push(Lt,0);break}}};switch(n.type){case ct:{r(i),r(t),f();break}case Ie:{r(i),r(t),f();break}}},p=[],l=c=>{let i={type:Yn,statement:c};p.unshift(i)};p.unshift({type:ft});let y=(c,i)=>{if(c.members)for(let[t,n]of c.members.entries()){let r=P(n?.name,n?.path),f=s.get(r);if(f&&f.type===he){let b=y(f,r,i);b&&A.push(b)}}return c.members&&c.members.has(wn)?i:null},A=[];Ze.forEach(c=>{let i=P(c.data.name,c.data.path),t=s.get(i);if(t&&t.type===he){let n=y(t,i);n&&A.push(n)}});let w=A.map(c=>({type:Un,expression:{type:dt,name:wn,path:c,inputs:[]}}));for(let c of w)l(c);var q=Mt.length-1|0;for(let c=q;c>=0;c=c-1|0){let i=Mt[c];l(i)}let se=c=>{let{target:i,source:t}=c;if(i.type===qr){hs(i,t);return}if(i.type===Xr){fs(i,t);return}if(i.type===qe){Es(i,t);return}if(t.type===Ft){let n=ce.get(i.name),{data:r}=n;if(r.path!=="Flogram"){let f=P(r.name,r.path);if(s.get(f).type===he){bs(i,t);return}}}H(t,"assignment"),zt(i)},v=c=>{let{statements:i}=c;e.push(Ut,et),e.push(ts,et);let t={type:ft,layout:Zt};p.unshift(t),p.unshift(t),p.unshift({type:vn});var n=i.length-1|0;for(let r=n;r>=0;r=r-1|0){let f=i[r];l(f)}},pe=c=>{let{statements:i,condition:t}=c;e.push(Ut,et),e.push(ts,et);let n={type:ft,layout:Zt};p.unshift(n),p.unshift(n),p.unshift({type:Bn,condition:t});var r=i.length-1|0;for(let f=r;f>=0;f=f-1|0){let b=i[f];l(b)}},Ee=c=>{let{statements:i,collection:t,index:n,iterator:r}=c;z(c),e.push(O,0),n?e.push(vt,de.get(n)):e.push(Ae,L),e.push(Ut,et),e.push(ts,et);let f={type:ft,layout:Zt};p.unshift(f),p.unshift(f),p.unshift({type:Gn,index:n});var b=i.length-1|0;for(let C=b;C>=0;C=C-1|0){let K=i[C];l(K)}p.unshift({type:Kn,collection:t,iterator:r,index:n})},le=c=>{e.push(ss,2)},ue=c=>{let{branches:i}=c;p.unshift({type:ft});for(let t=i.length-1;t>=0;t--){let n=i[t];switch(n.type){case $r:{let{statements:r}=n,f=r.length;for(let C=f-1;C>=0;C--){let K=r[C];l(K)}let b=r.find(C=>C.type===tn);p.unshift({type:en,stop:b}),H(n.values[0]);break}case Jr:{let{statements:r}=n,f=r.length;for(let b=f-1;b>=0;b--){let C=r[b];l(C)}p.unshift({type:Vn});break}}}},ve=c=>{let i=c,{branches:t,values:n}=i;if(t.length>0&&n.length===0)return ue(c);e.push(Ut,et);let f={type:ft};p.unshift(f);let b=[];for(let K of n)switch(K.type){case Pe:{let{name:S}=K,Q=ce.get(S),{data:Te}=Q,{name:me,path:ge}=Te,U=P(me,ge);b.push(U);break}}var C=t.length-1|0;for(let K=C;K>=0;K=K-1|0){let S=t[K],Q={type:Ln,branch:S,condition:i,commonKeys:b};p.unshift(Q)}},Se=c=>{let{expression:i}=c;var n=H(i)|0;for(let r=0;r<n;r=r+1|0)e.push(Je)},Nt=c=>{let{value:i}=c;H(i),e.push(Qe,pi),ie("dealloc"),e.push(O,0),zt(i)},_s=c=>{let{values:i}=c;for(let t of i)H(t);e.push(oi)},ht=c=>{e.push(nn)},ds=c=>{e.push(12,0)},jt=c=>{e.push(ci)},Pt=c=>{c.stop?(e.push(Xn),e.push(mt)):(e.push(Xn),e.push(et))},ms=c=>{let{branch:i,commonKeys:t,condition:n}=c,{values:r}=i,{values:f}=n;var b=t.length|0;for(let S=0;S<b;S=S+1|0){let Q=t[S],Te=r[S],me=f[S];Os(Q,Te,me)}let{statements:C}=i;var K=C.length-1|0;for(let S=K;S>=0;S=S-1|0){let Q=C[S];l(Q)}},Bt=c=>{let{condition:i}=c;H(i),e.push(O,0),e.push(sn),e.push(Lt,1),e.push(ss,0)},Kt=c=>{let{collection:i,iterator:t,index:n}=c;H(i),Y=!0;let r=de.get(n);n?e.push(Ce,r):e.push(G,L),e.push(sn),e.push(Lt,1),e.push(Je);let f=Object.freeze({type:Qt,array:i,index:{type:Pe,name:n}}),b=Object.freeze({type:Pe,name:t}),C=Object.freeze({type:Gr,target:b,source:f});l(C)},ot=c=>{let{index:i}=c,t=de.get(i);i?e.push(Ce,t):e.push(G,L),e.push(O,1),e.push(W),i?e.push(vt,t):e.push(Ae,L),e.push(ss,0)},gs=c=>{let{statement:i}=c;switch(i.type){case"assign":{se(i);break}case en:{ve(i);break}case Zt:{v(i);break}case Wr:{pe(i);break}case Zr:{Ee(i);break}case Qr:{le(i);break}case Un:{Se(i);break}case ti:{Nt(i);break}case tn:{_s(i);break}}};for(;p.length>0;){let c=p.shift();switch(c.type){case ft:{ht(c);break}case vn:{ds(c);break}case Vn:{jt(c);break}case en:{Pt(c);break}case Ln:{ms(c);break}case Yn:{gs(c);break}case Bn:{Bt(c);break}case Kn:{Kt(c);break}case Gn:{ot(c);break}default:break}}return{totalOctets:e,nativeImports:B,loads:Y}}var{HEX_ENCODE:cn,LEB128_ENCODE:tt}=_t,{TYPES_ASSIGN:Oi,TYPES_ARRAY:lt,TYPES_DATA:cs,TYPES_GENERICS:_i,TYPES_ENUMERATION:Yt,TYPES_EXPRESSION:di,TYPES_LINK:as,TYPES_LOCAL:xt,TYPES_OBJECT:Tt,TYPES_PROCEDURE:an,TYPES_RETURN:mi,TYPES_SELECT:gi,TYPES_MEMBER:xi,TYPES_STORE:rn,TYPES_LITERAL:eo,TYPES_LINK_TO:rs,TYPES_VALUE_AT:is,TYPES_SELF:to,TYPES_NATIVE:yt,TYPES_STRING:It}=Gt,pn="",Ue=(o,s)=>`${s}.${o}`,Ti=o=>[">","<",">=","<=","!=","=="].includes(o),yi=o=>["FP64","I64","U64","FP32","I32","U32","I16","U16","I8","U8","Bool"].includes(o),ln=48,Ii=Object.freeze([0,127]),zi=Object.freeze({}),Ni=Object.freeze([127]),so=0;var ji=2;var Pi=10,Ai=7,Ri=3,Ci=2,Si=1,Di=6,ut=96,ps=127,un=Object.freeze([7,105,109,112,111,114,116,115]),Fi=Object.freeze([6,109,101,109,111,114,121]),ki=0;var Ui=65,Xe=new Uint8Array(8),Li=Object.freeze([0,97,115,109]),vi=Object.freeze([1,0,0,0]),Vi=(o,s)=>{s=s??zi;let a={},{data:E,code:z}=o,e=z.filter(p=>!p.description.generics||p.description.generics.length===0),B=new Map,Y=new Map,ie=p=>{let l=0;for(let y of p){let{data:A}=y;switch(A.type){case"Maybe":case cs:{let{name:w,path:q}=A,se=Ue(w,q),v=B.get(se);if(v)switch(v.type){case yt:if(w===It){l=l+2|0;break}case Yt:{l=l+1|0;break}case Tt:{let{length:pe}=v;l=l+2|0;break}}break}case as:{A.name===lt||A.name===It?l=l+2|0:l=l+1|0;break}case lt:{l=l+2|0;break}}}return l},oe=p=>{let{labels:l}=p,y=new Map;var A=l.length|0;for(let v=0;v<A;v=v+1|0){let{name:pe}=l[v];y.set(pe,v)}return Object.freeze({type:Yt,encode:v=>{let pe=y.get(v);return typeof pe>"u"?Ni:tt(pe)},evaluate:v=>y.get(v),opcode:Ui,link:Object.freeze({load:Object.freeze({opcode:40,align:2,offset:0,size:4}),store:Object.freeze({opcode:54,align:2,offset:0,size:4})})})},fe=p=>{let l=[],y=[],A=0,w=()=>{let t=Object.freeze({type:"back"});l.unshift(t)},q=t=>{let n={type:cs,data:t};l.unshift(n)},se=t=>{let n={type:"name",name:t};l.unshift(n)},v=(t,n)=>{n&&(w(),q(n),se(t))},pe=t=>E.find(n=>n.name===t),Ee=(t,n)=>n.find(r=>r.name===t),le=(t,{inputs:n})=>n.find(r=>r.name===t),ue=(t,n)=>{let r=t;for(let f of n){let b=Ee(f,r.description.members),C=pe(b.data.name);if(C&&C.type===Tt)r=C;else return b}return null},ve=(t,n)=>{let r=t.trail,f=Ee(r[0],n.members);if(!f)return null;if(r.length===1)return f.data;let b=pe(f.data.name);return ue(b,r.slice(1)).data},Se=(t,n,r,f)=>{if(le(n,r.description))return;r.description.self.push(t);let b=Object.seal({name:n,data:{...ve({trail:t.trail||t.value?.trail||t.link?.trail||[]},f),segment:"heap"}});t.type!==rs&&(b.data.type=as),r.description.inputs.push(b)},Nt=(t,n,r)=>{let f=t.inputs.map(b=>ht(b,n,r));return{...t,inputs:f}},_s=(t,n,r)=>{if(!(t.value.link===to||t.value.value===to))return console.log("THIS IS NOT HANDLED; HANGING"),t;let f=`${t.type}_${t.trail.join("_")}`;if(Se(t,f,n,r),t.value.value)return{type:rs,value:f};if(t.value.link)return{type:is,link:f}},ht=(t,n,r,f="")=>{switch(t.type){case xt:case eo:return t;case xi:{let b=`${t.type}_${t.trail.join("_")}`;return Se(t,b,n,r),f==="target"?{type:rn,link:{type:xt,name:b}}:{type:is,link:{type:xt,name:b}}}case rs:{if(t.value.type===eo)return t.value;{let b=`${t.value.type}_${t.value.trail.join("_")}`;return Se(t,b,n,r),{type:rs,value:{type:xt,name:b}}}}case is:{let b=`${t.link.type}_${t.link.trail.join("_")}`;return Se(t,b,n,r),{type:is,link:{type:xt,name:b}}}case rn:{let b=`${t.link.type}_${t.link.trail.join("_")}`;return Se(t,b,n,r),{type:rn,link:{type:xt,name:b}}}case gi:return _s(t,n,r);case di:return Nt(t,n,r);default:return console.log("THIS IS NOT HANDLED; HANGING"),console.log(t),t}},ds=(t,n)=>{let r=JSON.parse(JSON.stringify(t));r.description.self=[];for(let f of r.description.statements)f.type===Oi?(f.target=ht(f.target,r,n,"target"),f.source=ht(f.source,r,n)):f.type===mi&&(f.values=f.values.map(b=>ht(b,r,n)));e.push(r)},{members:jt}=p,Pt=new Map;for(let t of jt){let{name:n,data:r,value:f}=t;Pt.set(n,r),f&&Pt.set(n,{...r,value:f})}var ms=jt.length-1|0;for(let t=ms;t>=0;t=t-1|0){let n=jt[t],{name:r,data:f}=n;if(n.type&&n.type===an){ds(n,p);continue}v(r,f)}let Bt=new Map,Kt=new Map,ot=0;for(;l.length>0;){let t=l.shift();switch(t.type){case"back":{y.pop();break}case cs:{let{data:n}=t,r=()=>{let S=y.join("."),Q=Ue(n.name,n.path),Te=B.get(Q),{link:me}=Te,ge=Object.freeze({data:n,index:ot,address:A,trail:S});n.type===lt||n.layout===lt||n.name===It?A+=8:A+=me?.load.size||8,Bt.set(S,ge),Kt.set(ot,ge),n.type===lt||n.name===It||n.layout===lt?ot=ot+2|0:ot=ot+1|0};if(n.type===as){r();break}let{name:f,path:b}=n,C=Ue(f,b);switch(B.get(C).type){case yt:case Yt:{r();break}case Tt:{r();break}}break}case"name":{let{name:n}=t;y.push(n);break}}}let gs=ot|0,c=Object.freeze({mapTrail:Bt,mapIndex:Kt});return{type:Tt,length:gs,members:Pt,indivisibles:c}},De={};for(let p of E){let{path:l}=p;switch(p.type){case yt:{let{name:y,path:A}=p,w=Ue(y,A);if(Object.hasOwn(it,w)){let q=it[w];B.set(w,q);continue}break}case"import":{if(Object.hasOwn(it,l)){let y=it[l];B.set(l,y);continue}break}case _i:{let{name:y,path:A}=p,w=Ue(y,A),q=it["Flogram.FP32"];B.set(w,q);break}case Yt:{let{name:y,path:A,description:w}=p,q=Ue(y,A),se=oe(w);B.set(q,se);break}case Tt:{let{name:y,path:A,description:w}=p,{generics:q}=w,se=Ue(y,A);if(!q||q.length===0){let v=fe(w);B.set(se,v)}break}}}a.structures=De;let Re=0,Et=(p,l)=>{let y=Y.get(p);if(typeof y>"u"){Y.set(p,[l]);return}(y.length==0||y.length>0&&y[0].body!==l.body)&&Y.set(p,[l,...y])},ls=p=>{let{name:l,path:y}=p,A=Ue(l,y);switch(y==="Flogram"&&(yi(l)?A=Ue(p.description.inputs[0]?.data?.name?.toLowerCase()+"."+Ke(l),y):p.description.outputs&&p.description.outputs.length>=1&&!Ti(p.name)?p.description.outputs[0]?.data?.name&&(A=Ue(p.description.outputs[0]?.data?.name?.toLowerCase()+"."+Ke(l,p.description.inputs?.length),y)):(St.includes(p.description.inputs[1]?.data?.name?.toUpperCase())&&(A=Ue(p.description.inputs[1]?.data?.name?.toUpperCase()+"."+Ke(l),y),pn=p.description.inputs[1]?.data?.name?.toUpperCase()),pn&&(A=Ue(pn.toLowerCase()+"."+Ke(l),y)))),p.type){case yt:{if(Object.hasOwn(Ct,A)){let w=Ct[A];Et(A,w);return}break}case an:{let{description:w}=p,{inputs:q,outputs:se}=w,v=Ue(l,y),pe={type:"artificial",index:"artificial"+Re,procedure:p,lengths:Object.freeze({inputs:ie(q),outputs:ie(se)})};Et(v,pe);break}}Re=Re+1|0},Be=[],We=[];for(let p of e){if(p.description.generics?.length>0)continue;let{description:l}=p,{inputs:y,outputs:A}=l,w=[...y,...A];if(!(p.type===yt&&w.some(q=>!St.includes(q.data.name))))switch(ls(p),p.type){case"import":{let{path:q}=p;if(Object.hasOwn(Ct,q))continue;Be.push(p);break}case an:{We.push(p);break}}}let wt=p=>{let l=0,y=[];for(let A of p){let w=()=>{y.push(ps),l=l+1|0},q=le=>{let{identity:ue}=le;y.push(ue),l=l+1|0},se=()=>{y.push(ps),l=l+1|0},v=()=>{y.push(ps),l=l+1|0,y.push(ps),l=l+1|0},{name:pe,data:Ee}=A;switch(Ee.type){case"Maybe":case cs:{let{name:le,path:ue}=Ee,ve=Ue(le,ue),Se=B.get(ve);if(!Se)q(it["Flogram.FP32"]);else switch(Se.type){case yt:{le===It?v():q(Se);break}case Yt:{w();break}case Tt:{v();break}}break}case as:{Ee.name===lt||Ee.name===It?v():se();break}case lt:{v();break}}}return[l,y]},Ze=(p,l)=>{let y=l.length|0,A=tt(y);l.unshift(p,...A)},Mt=p=>{let l=[],y=0,A=[...Be,...We],w=new Map([["alloc",[ut,1,127,1,127]],["dealloc",[ut,1,127,0]],["merge",[ut,0,0]],["save",[ut,2,127,127,0]],["undo",[ut,0,2,127,127]],["undoPenultimate",[ut,0,2,127,127]],["draw",[ut,1,127,0]]]);for(let v of p)if(w.has(v))l.push(...w.get(v));else throw new Error("Procedure not found:",v);for(let v of A){let{description:pe}=v,{inputs:Ee,outputs:le}=pe,[ue,ve]=wt(Ee),[Se,Nt]=wt(le);l.push(ut,ue,...ve,Se,...Nt)}let q=A.length|0,se=tt(q+p.size);return l.unshift(...se),Ze(Si,l),l},de=p=>{let l=[];return p&&p.size>0&&(l.push(2),l.push(127,1),l.push(65,0,11),l.push(127,1),l.push(65,0,11),Ze(Di,l)),l},ce=0,Fe=(p,l)=>{let y=[],A=0,w={};if(s.memory){let v=le=>{let ue=[...le].map(ve=>ve.charCodeAt(0));return[ue.length,...ue]},pe=[];(l||p.size>0)&&(w.memory={path:"memory",description:{inputs:[],outputs:[]}});for(let le of p)pe.push(v(le)),w[le]={path:le,description:{inputs:[],outputs:[]}};let Ee=Array.from(p);for(let le of p)Xe.fill(ln),cn(A,Xe),y.push(...un,...pe[Ee.indexOf(le)],so,Ee.indexOf(le)),A=A+1|0}for(let v of Be){Xe.fill(ln),cn(A,Xe);let pe=String.fromCodePoint(...Xe);w[pe]={path:v.path,description:v.description};let Ee=A|0;y.push(...un,Xe.length|0,...Xe,so,Ee),A=A+1|0}ce=A|0,(l||p.size>0)&&(y.push(...un,...Fi,ji,...Ii),A=A+1|0);let q=A|0,se=tt(q);return y.unshift(...se),Ze(Ci,y),a.imports=w,y},st=()=>{let p=[];var l=We.length|0;for(let w=0;w<l;w=w+1|0){let q=w|0,se=ce+q|0,v=tt(se);p.push(...v)}let y=We.length|0,A=tt(y);return p.unshift(...A),Ze(Ri,p),p},fn=()=>{let p=[],l=0,y={};var A=We.length|0;for(let se=0;se<A;se=se+1|0){let v=se+ce|0,pe=tt(v);Xe.fill(ln),cn(l,Xe);let{name:Ee,path:le,description:ue}=We[se];ue={inputs:ue.inputs,outputs:ue.outputs};let ve=String.fromCodePoint(...Xe);y[ve]={name:Ee,path:le,description:ue},p.push(Xe.length|0,...Xe,ki,...pe),l=l+1|0}let w=l|0,q=tt(w);return p.unshift(...q),Ze(Ai,p),a.procedures=y,p},us=()=>{let p=[],l=new Set,y=!1;for(let se of We){let{totalOctets:v,nativeImports:pe,loads:Ee}=os(se,B,Y,e);l=new Set([...l,...pe]),Ee&&!y&&(y=Ee);let le=v.length|0,ue=tt(le);p.push(...ue,...v)}let A=We.length|0,w=tt(A);return p.unshift(...w),Ze(Pi,p),p=((se,v,pe)=>{let Ee=Array.from(pe),le="artificial";return se.map(ue=>{if(typeof ue=="string"){if(ue.startsWith(le)){let ve=ue.slice(le.length),Se=parseInt(ve,10);if(!isNaN(Se))return Se+v}if(Ee.includes(ue))return Ee.indexOf(ue)}return ue})})(p,l.size,l),{totalOctets:p,allImports:l,loads:y}},{totalOctets:nt,allImports:Le,loads:H}=us(),zt=Mt(Le),fs=Fe(Le,H),Es=st(),hs=de(Le),bs=fn(),Os=new Uint8Array([...Li,...vi,...zt,...fs,...Es,...hs,...bs,...nt]);return[a,Os]},Yi=Object.freeze({compile:Vi}),Ip=Yi;export{Ip as default};
